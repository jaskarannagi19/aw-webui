{"remainingRequest":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/thread-loader/dist/cjs.js!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/babel-loader/lib/index.js!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/@vue/cli-plugin-typescript/node_modules/ts-loader/index.js??ref--13-3!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/eslint-loader/index.js??ref--12-0!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/src/queries.ts","dependencies":[{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/src/queries.ts","mtime":1622212604093},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/@vue/cli-plugin-typescript/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuam9pbiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5rZXlzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucmVwbGFjZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdCI7CmltcG9ydCBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciBmcm9tICIvaG9tZS9qYXNrYXJhbi9jb2RlL2phc2thcmFuL2FjdGl2aXR5d2F0Y2gvYXctc2VydmVyL2F3LXdlYnVpL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIjsKaW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gIi9ob21lL2phc2thcmFuL2NvZGUvamFza2FyYW4vYWN0aXZpdHl3YXRjaC9hdy1zZXJ2ZXIvYXctd2VidWkvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3NsaWNlZFRvQXJyYXkiOwppbXBvcnQgX2VhY2ggZnJvbSAibG9kYXNoL2VhY2giOwppbXBvcnQgX2ZpbHRlciBmcm9tICJsb2Rhc2gvZmlsdGVyIjsKaW1wb3J0IF9pbmNsdWRlcyBmcm9tICJsb2Rhc2gvaW5jbHVkZXMiOwppbXBvcnQgX2ZpbmQgZnJvbSAibG9kYXNoL2ZpbmQiOwppbXBvcnQgX21hcCBmcm9tICJsb2Rhc2gvbWFwIjsKCmZ1bmN0aW9uIHF1ZXJ5c3RyX3RvX2FycmF5KHF1ZXJ5c3RyKSB7CiAgcmV0dXJuIHF1ZXJ5c3RyLnNwbGl0KCc7JykuZmlsdGVyKGZ1bmN0aW9uIChsKSB7CiAgICByZXR1cm4gbDsKICB9KS5tYXAoZnVuY3Rpb24gKGwpIHsKICAgIHJldHVybiBsICsgJzsnOwogIH0pOwp9CgpmdW5jdGlvbiBlc2NhcGVfZG91YmxlcXVvdGUocykgewogIHJldHVybiBzLnJlcGxhY2UoLyIvZywgJ1xcIicpOwp9CgpmdW5jdGlvbiBpc0Rlc2t0b3BQYXJhbXMob2JqZWN0KSB7CiAgcmV0dXJuICdiaWRfd2luZG93JyBpbiBvYmplY3Q7Cn0KCmZ1bmN0aW9uIGlzQW5kcm9pZFBhcmFtcyhvYmplY3QpIHsKICByZXR1cm4gJ2JpZF9hbmRyb2lkJyBpbiBvYmplY3Q7Cn0KCmV4cG9ydCBmdW5jdGlvbiBjYW5vbmljYWxFdmVudHMocGFyYW1zKSB7CiAgdmFyIGNsYXNzZXNfc3RyID0gSlNPTi5zdHJpbmdpZnkocGFyYW1zLmNsYXNzZXMpLnJlcGxhY2UoL1xcXFwvZywgJ1xcJyk7CiAgdmFyIGNhdF9maWx0ZXJfc3RyID0gSlNPTi5zdHJpbmdpZnkocGFyYW1zLmZpbHRlcl9jbGFzc2VzKTsKICB2YXIgYmlkX3dpbmRvdyA9IGlzRGVza3RvcFBhcmFtcyhwYXJhbXMpID8gcGFyYW1zLmJpZF93aW5kb3cgOiBwYXJhbXMuYmlkX2FuZHJvaWQ7CiAgcmV0dXJuIFsiZXZlbnRzID0gZmxvb2QocXVlcnlfYnVja2V0KFwiIi5jb25jYXQoYmlkX3dpbmRvdywgIlwiKSk7IiksIGlzQW5kcm9pZFBhcmFtcyhwYXJhbXMpID8gJ2V2ZW50cyA9IG1lcmdlX2V2ZW50c19ieV9rZXlzKGV2ZW50cywgWyJhcHAiXSk7JyA6ICcnLCBpc0Rlc2t0b3BQYXJhbXMocGFyYW1zKSA/ICJub3RfYWZrID0gZmxvb2QocXVlcnlfYnVja2V0KFwiIi5jb25jYXQocGFyYW1zLmJpZF9hZmssICJcIikpO1xuICAgICAgICAgbm90X2FmayA9IGZpbHRlcl9rZXl2YWxzKG5vdF9hZmssIFwic3RhdHVzXCIsIFtcIm5vdC1hZmtcIl0pOyIpIDogJycsIHBhcmFtcy5iaWRfYnJvd3NlcnMgPyBpc0Rlc2t0b3BQYXJhbXMocGFyYW1zKSAmJiBicm93c2VyRXZlbnRzKHBhcmFtcykgKyAocGFyYW1zLmluY2x1ZGVfYXVkaWJsZSA/ICJhdWRpYmxlX2V2ZW50cyA9IGZpbHRlcl9rZXl2YWxzKGJyb3dzZXJfZXZlbnRzLCBcImF1ZGlibGVcIiwgW3RydWVdKTtcbiAgICAgICAgICAgICBub3RfYWZrID0gcGVyaW9kX3VuaW9uKG5vdF9hZmssIGF1ZGlibGVfZXZlbnRzKTsiIDogJycpIDogJycsIGlzRGVza3RvcFBhcmFtcyhwYXJhbXMpICYmIHBhcmFtcy5maWx0ZXJfYWZrID8gJ2V2ZW50cyA9IGZpbHRlcl9wZXJpb2RfaW50ZXJzZWN0KGV2ZW50cywgbm90X2Fmayk7JyA6ICcnLCBwYXJhbXMuY2xhc3NlcyA/ICJldmVudHMgPSBjYXRlZ29yaXplKGV2ZW50cywgIi5jb25jYXQoY2xhc3Nlc19zdHIsICIpOyIpIDogJycsIHBhcmFtcy5maWx0ZXJfY2xhc3NlcyA/ICJldmVudHMgPSBmaWx0ZXJfa2V5dmFscyhldmVudHMsIFwiJGNhdGVnb3J5XCIsICIuY29uY2F0KGNhdF9maWx0ZXJfc3RyLCAiKTsiKSA6ICcnXS5qb2luKCdcbicpOwp9CnZhciBkZWZhdWx0X2xpbWl0ID0gMTAwOwpleHBvcnQgZnVuY3Rpb24gYXBwUXVlcnkoYXBwYnVja2V0LCBjbGFzc2VzLCBmaWx0ZXJDYXRlZ29yaWVzKSB7CiAgYXBwYnVja2V0ID0gZXNjYXBlX2RvdWJsZXF1b3RlKGFwcGJ1Y2tldCk7CiAgdmFyIHBhcmFtcyA9IHsKICAgIGJpZF9hbmRyb2lkOiBhcHBidWNrZXQsCiAgICBjbGFzc2VzOiBjbGFzc2VzLAogICAgZmlsdGVyX2NsYXNzZXM6IGZpbHRlckNhdGVnb3JpZXMKICB9OwogIHZhciBjb2RlID0gIlxuICAgICIuY29uY2F0KGNhbm9uaWNhbEV2ZW50cyhwYXJhbXMpLCAiXG5cbiAgICB0aXRsZV9ldmVudHMgPSBzb3J0X2J5X2R1cmF0aW9uKG1lcmdlX2V2ZW50c19ieV9rZXlzKGV2ZW50cywgW1wiYXBwXCIsIFwiY2xhc3NuYW1lXCJdKSk7XG4gICAgYXBwX2V2ZW50cyAgID0gc29ydF9ieV9kdXJhdGlvbihtZXJnZV9ldmVudHNfYnlfa2V5cyh0aXRsZV9ldmVudHMsIFtcImFwcFwiXSkpO1xuICAgIGNhdF9ldmVudHMgICA9IHNvcnRfYnlfZHVyYXRpb24obWVyZ2VfZXZlbnRzX2J5X2tleXMoZXZlbnRzLCBbXCIkY2F0ZWdvcnlcIl0pKTtcblxuICAgIGV2ZW50cyA9IHNvcnRfYnlfdGltZXN0YW1wKGV2ZW50cyk7XG4gICAgYXBwX2V2ZW50cyAgPSBsaW1pdF9ldmVudHMoYXBwX2V2ZW50cywgIikuY29uY2F0KGRlZmF1bHRfbGltaXQsICIpO1xuICAgIHRpdGxlX2V2ZW50cyAgPSBsaW1pdF9ldmVudHModGl0bGVfZXZlbnRzLCAiKS5jb25jYXQoZGVmYXVsdF9saW1pdCwgIik7XG4gICAgZHVyYXRpb24gPSBzdW1fZHVyYXRpb25zKGV2ZW50cyk7XG4gICAgUkVUVVJOICA9IHtcImFwcF9ldmVudHNcIjogYXBwX2V2ZW50cywgXCJ0aXRsZV9ldmVudHNcIjogdGl0bGVfZXZlbnRzLCBcImNhdF9ldmVudHNcIjogY2F0X2V2ZW50cywgXCJkdXJhdGlvblwiOiBkdXJhdGlvbiwgXCJhY3RpdmVfZXZlbnRzXCI6IGFwcF9ldmVudHN9O1xuICAiKTsKICByZXR1cm4gcXVlcnlzdHJfdG9fYXJyYXkoY29kZSk7Cn0KdmFyIGJyb3dzZXJfYXBwbmFtZXMgPSB7CiAgY2hyb21lOiBbJ0dvb2dsZSBDaHJvbWUnLCAnR29vZ2xlLWNocm9tZScsICdjaHJvbWUuZXhlJywgJ2dvb2dsZS1jaHJvbWUtc3RhYmxlJywgJ0Nocm9taXVtJywgJ0Nocm9taXVtLWJyb3dzZXInLCAnQ2hyb21pdW0tYnJvd3Nlci1jaHJvbWl1bScsICdjaHJvbWl1bS5leGUnLCAnR29vZ2xlLWNocm9tZS1iZXRhJywgJ0dvb2dsZS1jaHJvbWUtdW5zdGFibGUnLCAnQnJhdmUtYnJvd3NlciddLAogIGZpcmVmb3g6IFsnRmlyZWZveCcsICdGaXJlZm94LmV4ZScsICdmaXJlZm94JywgJ2ZpcmVmb3guZXhlJywgJ0ZpcmVmb3ggRGV2ZWxvcGVyIEVkaXRpb24nLCAnZmlyZWZveGRldmVsb3BlcmVkaXRpb24nLCAnRmlyZWZveC1lc3InLCAnRmlyZWZveCBCZXRhJywgJ05pZ2h0bHknXSwKICBvcGVyYTogWydvcGVyYS5leGUnLCAnT3BlcmEnXSwKICBicmF2ZTogWydicmF2ZS5leGUnXSwKICBlZGdlOiBbJ21zZWRnZS5leGUnLCAnTWljcm9zb2Z0IEVkZ2UnXSwKICB2aXZhbGRpOiBbJ1ZpdmFsZGktc3RhYmxlJywgJ1ZpdmFsZGktc25hcHNob3QnLCAndml2YWxkaS5leGUnXQp9OwoKZnVuY3Rpb24gYnJvd3NlcnNXaXRoQnVja2V0cyhicm93c2VyYnVja2V0cykgewogIHZhciBicm93c2VybmFtZV90b19idWNrZXRpZCA9IF9tYXAoT2JqZWN0LmtleXMoYnJvd3Nlcl9hcHBuYW1lcyksIGZ1bmN0aW9uIChicm93c2VyTmFtZSkgewogICAgdmFyIGJ1Y2tldElkID0gX2ZpbmQoYnJvd3NlcmJ1Y2tldHMsIGZ1bmN0aW9uIChidWNrZXRfaWQpIHsKICAgICAgcmV0dXJuIF9pbmNsdWRlcyhidWNrZXRfaWQsIGJyb3dzZXJOYW1lKTsKICAgIH0pOwoKICAgIHJldHVybiBbYnJvd3Nlck5hbWUsIGJ1Y2tldElkXTsKICB9KTsKCiAgcmV0dXJuIF9maWx0ZXIoYnJvd3Nlcm5hbWVfdG9fYnVja2V0aWQsIGZ1bmN0aW9uIChfcmVmKSB7CiAgICB2YXIgX3JlZjIgPSBfc2xpY2VkVG9BcnJheShfcmVmLCAyKSwKICAgICAgICBidWNrZXRJZCA9IF9yZWYyWzFdOwoKICAgIHJldHVybiBidWNrZXRJZCAhPT0gdW5kZWZpbmVkOwogIH0pOwp9CgpmdW5jdGlvbiBicm93c2VyRXZlbnRzKHBhcmFtcykgewogIHZhciBjb2RlID0gIlxuICAgIGJyb3dzZXJfZXZlbnRzID0gW107XG4gICI7CgogIF9lYWNoKGJyb3dzZXJzV2l0aEJ1Y2tldHMocGFyYW1zLmJpZF9icm93c2VycyksIGZ1bmN0aW9uIChfcmVmMykgewogICAgdmFyIF9yZWY0ID0gX3NsaWNlZFRvQXJyYXkoX3JlZjMsIDIpLAogICAgICAgIGJyb3dzZXJOYW1lID0gX3JlZjRbMF0sCiAgICAgICAgYnVja2V0SWQgPSBfcmVmNFsxXTsKCiAgICB2YXIgYnJvd3Nlcl9hcHBuYW1lc19zdHIgPSBKU09OLnN0cmluZ2lmeShicm93c2VyX2FwcG5hbWVzW2Jyb3dzZXJOYW1lXSk7CiAgICBjb2RlICs9ICJldmVudHNfIi5jb25jYXQoYnJvd3Nlck5hbWUsICIgPSBmbG9vZChxdWVyeV9idWNrZXQoXCIiKS5jb25jYXQoYnVja2V0SWQsICJcIikpO1xuICAgICAgIHdpbmRvd18iKS5jb25jYXQoYnJvd3Nlck5hbWUsICIgPSBmaWx0ZXJfa2V5dmFscyhldmVudHMsIFwiYXBwXCIsICIpLmNvbmNhdChicm93c2VyX2FwcG5hbWVzX3N0ciwgIik7XG4gICAgICAgZXZlbnRzXyIpLmNvbmNhdChicm93c2VyTmFtZSwgIiA9IGZpbHRlcl9wZXJpb2RfaW50ZXJzZWN0KGV2ZW50c18iKS5jb25jYXQoYnJvd3Nlck5hbWUsICIsIHdpbmRvd18iKS5jb25jYXQoYnJvd3Nlck5hbWUsICIpO1xuICAgICAgIGV2ZW50c18iKS5jb25jYXQoYnJvd3Nlck5hbWUsICIgPSBzcGxpdF91cmxfZXZlbnRzKGV2ZW50c18iKS5jb25jYXQoYnJvd3Nlck5hbWUsICIpO1xuICAgICAgIGJyb3dzZXJfZXZlbnRzID0gY29uY2F0KGJyb3dzZXJfZXZlbnRzLCBldmVudHNfIikuY29uY2F0KGJyb3dzZXJOYW1lLCAiKTtcbiAgICAgICBicm93c2VyX2V2ZW50cyA9IHNvcnRfYnlfdGltZXN0YW1wKGJyb3dzZXJfZXZlbnRzKTsiKTsKICB9KTsKCiAgcmV0dXJuIGNvZGU7Cn0KCmV4cG9ydCBmdW5jdGlvbiBmdWxsRGVza3RvcFF1ZXJ5KGJyb3dzZXJidWNrZXRzLCB3aW5kb3didWNrZXQsIGFma2J1Y2tldCkgewogIHZhciBmaWx0ZXJBRksgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IHRydWU7CiAgdmFyIGNsYXNzZXMgPSBhcmd1bWVudHMubGVuZ3RoID4gNCA/IGFyZ3VtZW50c1s0XSA6IHVuZGVmaW5lZDsKICB2YXIgZmlsdGVyQ2F0ZWdvcmllcyA9IGFyZ3VtZW50cy5sZW5ndGggPiA1ID8gYXJndW1lbnRzWzVdIDogdW5kZWZpbmVkOwogIHZhciBpbmNsdWRlX2F1ZGlibGUgPSBhcmd1bWVudHMubGVuZ3RoID4gNiA/IGFyZ3VtZW50c1s2XSA6IHVuZGVmaW5lZDsKICBicm93c2VyYnVja2V0cyA9IF9tYXAoYnJvd3NlcmJ1Y2tldHMsIGVzY2FwZV9kb3VibGVxdW90ZSk7CiAgd2luZG93YnVja2V0ID0gZXNjYXBlX2RvdWJsZXF1b3RlKHdpbmRvd2J1Y2tldCk7CiAgYWZrYnVja2V0ID0gZXNjYXBlX2RvdWJsZXF1b3RlKGFma2J1Y2tldCk7CiAgdmFyIHBhcmFtcyA9IHsKICAgIGJpZF93aW5kb3c6IHdpbmRvd2J1Y2tldCwKICAgIGJpZF9hZms6IGFma2J1Y2tldCwKICAgIGJpZF9icm93c2VyczogYnJvd3NlcmJ1Y2tldHMsCiAgICBjbGFzc2VzOiBjbGFzc2VzLAogICAgZmlsdGVyX2NsYXNzZXM6IGZpbHRlckNhdGVnb3JpZXMsCiAgICBmaWx0ZXJfYWZrOiBmaWx0ZXJBRkssCiAgICBpbmNsdWRlX2F1ZGlibGU6IGluY2x1ZGVfYXVkaWJsZQogIH07CiAgcmV0dXJuIHF1ZXJ5c3RyX3RvX2FycmF5KCJcbiAgICAiLmNvbmNhdChjYW5vbmljYWxFdmVudHMocGFyYW1zKSwgIlxuICAgIHRpdGxlX2V2ZW50cyA9IHNvcnRfYnlfZHVyYXRpb24obWVyZ2VfZXZlbnRzX2J5X2tleXMoZXZlbnRzLCBbXCJhcHBcIiwgXCJ0aXRsZVwiXSkpO1xuICAgIGFwcF9ldmVudHMgICA9IHNvcnRfYnlfZHVyYXRpb24obWVyZ2VfZXZlbnRzX2J5X2tleXModGl0bGVfZXZlbnRzLCBbXCJhcHBcIl0pKTtcbiAgICBjYXRfZXZlbnRzICAgPSBzb3J0X2J5X2R1cmF0aW9uKG1lcmdlX2V2ZW50c19ieV9rZXlzKGV2ZW50cywgW1wiJGNhdGVnb3J5XCJdKSk7XG5cbiAgICBhcHBfZXZlbnRzICA9IGxpbWl0X2V2ZW50cyhhcHBfZXZlbnRzLCAiKS5jb25jYXQoZGVmYXVsdF9saW1pdCwgIik7XG4gICAgdGl0bGVfZXZlbnRzICA9IGxpbWl0X2V2ZW50cyh0aXRsZV9ldmVudHMsICIpLmNvbmNhdChkZWZhdWx0X2xpbWl0LCAiKTtcbiAgICBkdXJhdGlvbiA9IHN1bV9kdXJhdGlvbnMoZXZlbnRzKTtcbiAgICAiKSArICJcbiAgICBicm93c2VyX2V2ZW50cyA9IHNwbGl0X3VybF9ldmVudHMoYnJvd3Nlcl9ldmVudHMpO1xuICAgIGJyb3dzZXJfdXJscyA9IG1lcmdlX2V2ZW50c19ieV9rZXlzKGJyb3dzZXJfZXZlbnRzLCBbXCJ1cmxcIl0pO1xuICAgIGJyb3dzZXJfdXJscyA9IHNvcnRfYnlfZHVyYXRpb24oYnJvd3Nlcl91cmxzKTtcbiAgICBicm93c2VyX3VybHMgPSBsaW1pdF9ldmVudHMoYnJvd3Nlcl91cmxzLCAiLmNvbmNhdChkZWZhdWx0X2xpbWl0LCAiKTtcbiAgICBicm93c2VyX2RvbWFpbnMgPSBtZXJnZV9ldmVudHNfYnlfa2V5cyhicm93c2VyX2V2ZW50cywgW1wiJGRvbWFpblwiXSk7XG4gICAgYnJvd3Nlcl9kb21haW5zID0gc29ydF9ieV9kdXJhdGlvbihicm93c2VyX2RvbWFpbnMpO1xuICAgIGJyb3dzZXJfZG9tYWlucyA9IGxpbWl0X2V2ZW50cyhicm93c2VyX2RvbWFpbnMsICIpLmNvbmNhdChkZWZhdWx0X2xpbWl0LCAiKTtcbiAgICBicm93c2VyX2R1cmF0aW9uID0gc3VtX2R1cmF0aW9ucyhicm93c2VyX2V2ZW50cyk7XG5cbiAgICBSRVRVUk4gPSB7XG4gICAgICAgIFwid2luZG93XCI6IHtcbiAgICAgICAgICAgIFwiYXBwX2V2ZW50c1wiOiBhcHBfZXZlbnRzLFxuICAgICAgICAgICAgXCJ0aXRsZV9ldmVudHNcIjogdGl0bGVfZXZlbnRzLFxuICAgICAgICAgICAgXCJjYXRfZXZlbnRzXCI6IGNhdF9ldmVudHMsXG4gICAgICAgICAgICBcImFjdGl2ZV9ldmVudHNcIjogbm90X2FmayxcbiAgICAgICAgICAgIFwiZHVyYXRpb25cIjogZHVyYXRpb25cbiAgICAgICAgfSxcbiAgICAgICAgXCJicm93c2VyXCI6IHtcbiAgICAgICAgICAgIFwiZG9tYWluc1wiOiBicm93c2VyX2RvbWFpbnMsXG4gICAgICAgICAgICBcInVybHNcIjogYnJvd3Nlcl91cmxzLFxuICAgICAgICAgICAgXCJkdXJhdGlvblwiOiBicm93c2VyX2R1cmF0aW9uXG4gICAgICAgIH1cbiAgICB9OyIpKTsKfQpleHBvcnQgZnVuY3Rpb24gZWRpdG9yQWN0aXZpdHlRdWVyeShlZGl0b3JidWNrZXRzKSB7CiAgdmFyIHEgPSBbJ2V2ZW50cyA9IFtdOyddOwoKICB2YXIgX2l0ZXJhdG9yID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoZWRpdG9yYnVja2V0cyksCiAgICAgIF9zdGVwOwoKICB0cnkgewogICAgZm9yIChfaXRlcmF0b3IucygpOyAhKF9zdGVwID0gX2l0ZXJhdG9yLm4oKSkuZG9uZTspIHsKICAgICAgdmFyIGVkaXRvcmJ1Y2tldCA9IF9zdGVwLnZhbHVlOwogICAgICBlZGl0b3JidWNrZXQgPSBlc2NhcGVfZG91YmxlcXVvdGUoZWRpdG9yYnVja2V0KTsKICAgICAgcS5wdXNoKCdldmVudHMgPSBjb25jYXQoZXZlbnRzLCBmbG9vZChxdWVyeV9idWNrZXQoIicgKyBlZGl0b3JidWNrZXQgKyAnIikpKTsnKTsKICAgIH0KICB9IGNhdGNoIChlcnIpIHsKICAgIF9pdGVyYXRvci5lKGVycik7CiAgfSBmaW5hbGx5IHsKICAgIF9pdGVyYXRvci5mKCk7CiAgfQoKICBxID0gcS5jb25jYXQoWydmaWxlcyA9IHNvcnRfYnlfZHVyYXRpb24obWVyZ2VfZXZlbnRzX2J5X2tleXMoZXZlbnRzLCBbImZpbGUiLCAibGFuZ3VhZ2UiXSkpOycsICJmaWxlcyA9IGxpbWl0X2V2ZW50cyhmaWxlcywgIi5jb25jYXQoZGVmYXVsdF9saW1pdCwgIik7IiksICdsYW5ndWFnZXMgPSBzb3J0X2J5X2R1cmF0aW9uKG1lcmdlX2V2ZW50c19ieV9rZXlzKGV2ZW50cywgWyJsYW5ndWFnZSJdKSk7JywgImxhbmd1YWdlcyA9IGxpbWl0X2V2ZW50cyhsYW5ndWFnZXMsICIuY29uY2F0KGRlZmF1bHRfbGltaXQsICIpOyIpLCAncHJvamVjdHMgPSBzb3J0X2J5X2R1cmF0aW9uKG1lcmdlX2V2ZW50c19ieV9rZXlzKGV2ZW50cywgWyJwcm9qZWN0Il0pKTsnLCAicHJvamVjdHMgPSBsaW1pdF9ldmVudHMocHJvamVjdHMsICIuY29uY2F0KGRlZmF1bHRfbGltaXQsICIpOyIpLCAnZHVyYXRpb24gPSBzdW1fZHVyYXRpb25zKGV2ZW50cyk7JywgJ1JFVFVSTiA9IHsiZmlsZXMiOiBmaWxlcywgImxhbmd1YWdlcyI6IGxhbmd1YWdlcywgInByb2plY3RzIjogcHJvamVjdHMsICJkdXJhdGlvbiI6IGR1cmF0aW9ufTsnXSk7CiAgcmV0dXJuIHE7Cn0KZXhwb3J0IGZ1bmN0aW9uIGhvdXJseUNhdGVnb3J5UXVlcnkocGFyYW1zKSB7CiAgdmFyIHEgPSAiXG4gICAgIi5jb25jYXQoY2Fub25pY2FsRXZlbnRzKHBhcmFtcyksICJcbiAgICBjYXRfZXZlbnRzICAgPSBzb3J0X2J5X2R1cmF0aW9uKG1lcmdlX2V2ZW50c19ieV9rZXlzKGV2ZW50cywgW1wiJGNhdGVnb3J5XCJdKSk7XG4gICAgUkVUVVJOID0geyBcImNhdF9ldmVudHNcIjogY2F0X2V2ZW50cyB9O1xuICAiKTsKICByZXR1cm4gcXVlcnlzdHJfdG9fYXJyYXkocSk7Cn0KZXhwb3J0IGZ1bmN0aW9uIGRhaWx5QWN0aXZpdHlRdWVyeShhZmtidWNrZXQpIHsKICBhZmtidWNrZXQgPSBlc2NhcGVfZG91YmxlcXVvdGUoYWZrYnVja2V0KTsKICByZXR1cm4gWydhZmtidWNrZXQgPSAiJyArIGFma2J1Y2tldCArICciOycsICdub3RfYWZrID0gZmxvb2QocXVlcnlfYnVja2V0KGFma2J1Y2tldCkpOycsICdub3RfYWZrID0gZmlsdGVyX2tleXZhbHMobm90X2FmaywgInN0YXR1cyIsIFsibm90LWFmayJdKTsnLCAnbm90X2FmayA9IG1lcmdlX2V2ZW50c19ieV9rZXlzKG5vdF9hZmssIFsic3RhdHVzIl0pOycsICdSRVRVUk4gPSBub3RfYWZrOyddOwp9CmV4cG9ydCBmdW5jdGlvbiBkYWlseUFjdGl2aXR5UXVlcnlBbmRyb2lkKGFuZHJvaWRidWNrZXQpIHsKICBhbmRyb2lkYnVja2V0ID0gZXNjYXBlX2RvdWJsZXF1b3RlKGFuZHJvaWRidWNrZXQpOwogIHJldHVybiBbImV2ZW50cyA9IHF1ZXJ5X2J1Y2tldChcIiIuY29uY2F0KGFuZHJvaWRidWNrZXQsICJcIik7IiksICdSRVRVUk4gPSBzdW1fZHVyYXRpb25zKGV2ZW50cyk7J107Cn0KZXhwb3J0IGRlZmF1bHQgewogIGZ1bGxEZXNrdG9wUXVlcnk6IGZ1bGxEZXNrdG9wUXVlcnksCiAgYXBwUXVlcnk6IGFwcFF1ZXJ5LAogIGRhaWx5QWN0aXZpdHlRdWVyeTogZGFpbHlBY3Rpdml0eVF1ZXJ5LAogIGhvdXJseUNhdGVnb3J5UXVlcnk6IGhvdXJseUNhdGVnb3J5UXVlcnksCiAgZGFpbHlBY3Rpdml0eVF1ZXJ5QW5kcm9pZDogZGFpbHlBY3Rpdml0eVF1ZXJ5QW5kcm9pZCwKICBlZGl0b3JBY3Rpdml0eVF1ZXJ5OiBlZGl0b3JBY3Rpdml0eVF1ZXJ5Cn07"},{"version":3,"sources":["/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/eslint-loader/index.js??ref--12-0!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/src/queries.ts"],"names":[],"mappings":"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","sourcesContent":["import _ from 'lodash';\n\n// TODO: Sanitize string input of buckets\n\nfunction querystr_to_array(querystr: string): string[] {\n  return querystr\n    .split(';')\n    .filter(l => l)\n    .map(l => l + ';');\n}\n\nfunction escape_doublequote(s: string) {\n  return s.replace(/\"/g, '\\\\\"');\n}\n\ninterface Rule {\n  type: string;\n  regex?: string;\n}\n\ninterface BaseQueryParams {\n  include_audible?: boolean;\n  classes: [string[], Rule][];\n  filter_classes: string[][];\n  bid_browsers?: string[];\n}\n\ninterface DesktopQueryParams extends BaseQueryParams {\n  bid_window: string;\n  bid_afk: string;\n  filter_afk: boolean;\n}\n\ninterface AndroidQueryParams extends BaseQueryParams {\n  bid_android: string;\n}\n\nfunction isDesktopParams(object: any): object is DesktopQueryParams {\n  return 'bid_window' in object;\n}\n\nfunction isAndroidParams(object: any): object is AndroidQueryParams {\n  return 'bid_android' in object;\n}\n\n// Constructs a query that returns a fully-detailed list of events from the merging of several sources (window, afk, web).\n// Performs:\n//  - AFK filtering (if filter_afk is true)\n//  - Categorization (if classes specified)\n//  - Filters by category (if filter_classes set)\n// Puts it's results in `events` and `not_afk` (if not_afk available for platform).\nexport function canonicalEvents(params: DesktopQueryParams | AndroidQueryParams): string {\n  // Needs escaping for regex patterns like '\\w' to work (JSON.stringify adds extra unecessary escaping)\n  const classes_str = JSON.stringify(params.classes).replace(/\\\\\\\\/g, '\\\\');\n  const cat_filter_str = JSON.stringify(params.filter_classes);\n\n  // For simplicity, we assume that bid_window and bid_android are exchangeable (note however it needs special treatment)\n  const bid_window = isDesktopParams(params) ? params.bid_window : params.bid_android;\n\n  return [\n    // Fetch window/app events\n    `events = flood(query_bucket(\"${bid_window}\"));`,\n    // On Android, merge events to avoid overload of events\n    isAndroidParams(params) ? 'events = merge_events_by_keys(events, [\"app\"]);' : '',\n    // Fetch not-afk events\n    isDesktopParams(params)\n      ? `not_afk = flood(query_bucket(\"${params.bid_afk}\"));\n         not_afk = filter_keyvals(not_afk, \"status\", [\"not-afk\"]);`\n      : '',\n    // Fetch browser events\n    params.bid_browsers\n      ? isDesktopParams(params) &&\n        browserEvents(params) +\n          // Include focused and audible browser events as indications of not-afk\n          (params.include_audible\n            ? `audible_events = filter_keyvals(browser_events, \"audible\", [true]);\n             not_afk = period_union(not_afk, audible_events);`\n            : '')\n      : '',\n    // Filter out window events when the user was afk\n    isDesktopParams(params) && params.filter_afk\n      ? 'events = filter_period_intersect(events, not_afk);'\n      : '',\n    // Categorize\n    params.classes ? `events = categorize(events, ${classes_str});` : '',\n    // Filter out selected categories\n    params.filter_classes ? `events = filter_keyvals(events, \"$category\", ${cat_filter_str});` : '',\n  ].join('\\n');\n}\n\nconst default_limit = 100; // Hardcoded limit per group\n\nexport function appQuery(appbucket: string, classes, filterCategories: string[][]): string[] {\n  appbucket = escape_doublequote(appbucket);\n  const params: AndroidQueryParams = {\n    bid_android: appbucket,\n    classes: classes,\n    filter_classes: filterCategories,\n  };\n\n  const code = `\n    ${canonicalEvents(params)}\n\n    title_events = sort_by_duration(merge_events_by_keys(events, [\"app\", \"classname\"]));\n    app_events   = sort_by_duration(merge_events_by_keys(title_events, [\"app\"]));\n    cat_events   = sort_by_duration(merge_events_by_keys(events, [\"$category\"]));\n\n    events = sort_by_timestamp(events);\n    app_events  = limit_events(app_events, ${default_limit});\n    title_events  = limit_events(title_events, ${default_limit});\n    duration = sum_durations(events);\n    RETURN  = {\"app_events\": app_events, \"title_events\": title_events, \"cat_events\": cat_events, \"duration\": duration, \"active_events\": app_events};\n  `;\n  return querystr_to_array(code);\n}\n\nconst browser_appnames = {\n  chrome: [\n    // Chrome\n    'Google Chrome',\n    'Google-chrome',\n    'chrome.exe',\n    'google-chrome-stable',\n\n    // Chromium\n    'Chromium',\n    'Chromium-browser',\n    'Chromium-browser-chromium',\n    'chromium.exe',\n\n    // Pre-releases\n    'Google-chrome-beta',\n    'Google-chrome-unstable',\n\n    // Brave (should this be merged with the brave entry?)\n    'Brave-browser',\n  ],\n  firefox: [\n    'Firefox',\n    'Firefox.exe',\n    'firefox',\n    'firefox.exe',\n    'Firefox Developer Edition',\n    'firefoxdeveloperedition',\n    'Firefox-esr',\n    'Firefox Beta',\n    'Nightly',\n  ],\n  opera: ['opera.exe', 'Opera'],\n  brave: ['brave.exe'],\n  edge: [\n    'msedge.exe', // Windows\n    'Microsoft Edge', // macOS\n  ],\n  vivaldi: ['Vivaldi-stable', 'Vivaldi-snapshot', 'vivaldi.exe'],\n};\n\n// Returns a list of (browserName, bucketId) pairs for found browser buckets\nfunction browsersWithBuckets(browserbuckets: string[]): [string, string][] {\n  const browsername_to_bucketid: [string, string | undefined][] = _.map(\n    Object.keys(browser_appnames),\n    browserName => {\n      const bucketId = _.find(browserbuckets, bucket_id => _.includes(bucket_id, browserName));\n      return [browserName, bucketId];\n    }\n  );\n  // Skip browsers for which a bucket couldn't be found\n  return _.filter(browsername_to_bucketid, ([, bucketId]) => bucketId !== undefined);\n}\n\n// Returns a list of active browser events (where the browser was the active window) from all browser buckets\nfunction browserEvents(params: DesktopQueryParams): string {\n  let code = `\n    browser_events = [];\n  `;\n\n  _.each(browsersWithBuckets(params.bid_browsers), ([browserName, bucketId]) => {\n    const browser_appnames_str = JSON.stringify(browser_appnames[browserName]);\n    code += `events_${browserName} = flood(query_bucket(\"${bucketId}\"));\n       window_${browserName} = filter_keyvals(events, \"app\", ${browser_appnames_str});\n       events_${browserName} = filter_period_intersect(events_${browserName}, window_${browserName});\n       events_${browserName} = split_url_events(events_${browserName});\n       browser_events = concat(browser_events, events_${browserName});\n       browser_events = sort_by_timestamp(browser_events);`;\n  });\n  return code;\n}\n\nexport function fullDesktopQuery(\n  browserbuckets: string[],\n  windowbucket: string,\n  afkbucket: string,\n  filterAFK = true,\n  classes,\n  filterCategories: string[][],\n  include_audible: boolean\n): string[] {\n  // Escape `\"`\n  browserbuckets = _.map(browserbuckets, escape_doublequote);\n  windowbucket = escape_doublequote(windowbucket);\n  afkbucket = escape_doublequote(afkbucket);\n\n  // TODO: Get classes\n  const params: DesktopQueryParams = {\n    bid_window: windowbucket,\n    bid_afk: afkbucket,\n    bid_browsers: browserbuckets,\n    classes: classes,\n    filter_classes: filterCategories,\n    filter_afk: filterAFK,\n    include_audible,\n  };\n\n  return querystr_to_array(\n    `\n    ${canonicalEvents(params)}\n    title_events = sort_by_duration(merge_events_by_keys(events, [\"app\", \"title\"]));\n    app_events   = sort_by_duration(merge_events_by_keys(title_events, [\"app\"]));\n    cat_events   = sort_by_duration(merge_events_by_keys(events, [\"$category\"]));\n\n    app_events  = limit_events(app_events, ${default_limit});\n    title_events  = limit_events(title_events, ${default_limit});\n    duration = sum_durations(events);\n    ` + // Browser events are retrieved in canonicalQuery\n      `\n    browser_events = split_url_events(browser_events);\n    browser_urls = merge_events_by_keys(browser_events, [\"url\"]);\n    browser_urls = sort_by_duration(browser_urls);\n    browser_urls = limit_events(browser_urls, ${default_limit});\n    browser_domains = merge_events_by_keys(browser_events, [\"$domain\"]);\n    browser_domains = sort_by_duration(browser_domains);\n    browser_domains = limit_events(browser_domains, ${default_limit});\n    browser_duration = sum_durations(browser_events);\n\n    RETURN = {\n        \"window\": {\n            \"app_events\": app_events,\n            \"title_events\": title_events,\n            \"cat_events\": cat_events,\n            \"active_events\": not_afk,\n            \"duration\": duration\n        },\n        \"browser\": {\n            \"domains\": browser_domains,\n            \"urls\": browser_urls,\n            \"duration\": browser_duration\n        }\n    };`\n  );\n}\n\nexport function editorActivityQuery(editorbuckets: string[]): string[] {\n  let q = ['events = [];'];\n  for (let editorbucket of editorbuckets) {\n    editorbucket = escape_doublequote(editorbucket);\n    q.push('events = concat(events, flood(query_bucket(\"' + editorbucket + '\")));');\n  }\n  q = q.concat([\n    'files = sort_by_duration(merge_events_by_keys(events, [\"file\", \"language\"]));',\n    `files = limit_events(files, ${default_limit});`,\n    'languages = sort_by_duration(merge_events_by_keys(events, [\"language\"]));',\n    `languages = limit_events(languages, ${default_limit});`,\n    'projects = sort_by_duration(merge_events_by_keys(events, [\"project\"]));',\n    `projects = limit_events(projects, ${default_limit});`,\n    'duration = sum_durations(events);',\n    'RETURN = {\"files\": files, \"languages\": languages, \"projects\": projects, \"duration\": duration};',\n  ]);\n  return q;\n}\n\nexport function hourlyCategoryQuery(params: DesktopQueryParams) {\n  const q = `\n    ${canonicalEvents(params)}\n    cat_events   = sort_by_duration(merge_events_by_keys(events, [\"$category\"]));\n    RETURN = { \"cat_events\": cat_events };\n  `;\n  return querystr_to_array(q);\n}\n\nexport function dailyActivityQuery(afkbucket: string): string[] {\n  afkbucket = escape_doublequote(afkbucket);\n  return [\n    'afkbucket = \"' + afkbucket + '\";',\n    'not_afk = flood(query_bucket(afkbucket));',\n    'not_afk = filter_keyvals(not_afk, \"status\", [\"not-afk\"]);',\n    'not_afk = merge_events_by_keys(not_afk, [\"status\"]);',\n    'RETURN = not_afk;',\n  ];\n}\n\nexport function dailyActivityQueryAndroid(androidbucket: string): string[] {\n  androidbucket = escape_doublequote(androidbucket);\n  return [`events = query_bucket(\"${androidbucket}\");`, 'RETURN = sum_durations(events);'];\n}\n\nexport default {\n  fullDesktopQuery,\n  appQuery,\n  dailyActivityQuery,\n  hourlyCategoryQuery,\n  dailyActivityQueryAndroid,\n  editorActivityQuery,\n};\n"],"sourceRoot":""}]}