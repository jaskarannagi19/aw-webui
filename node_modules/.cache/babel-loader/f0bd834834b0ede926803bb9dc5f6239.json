{"remainingRequest":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/thread-loader/dist/cjs.js!/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/babel-loader/lib/index.js!/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/src/visualizations/CategoryTree.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/src/visualizations/CategoryTree.vue","mtime":1622830085274},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4iOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc2V0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvciI7CmltcG9ydCAndnVlLWF3ZXNvbWUvaWNvbnMvY2lyY2xlJzsKaW1wb3J0ICd2dWUtYXdlc29tZS9pY29ucy9yZWd1bGFyL3BsdXMtc3F1YXJlJzsKaW1wb3J0ICd2dWUtYXdlc29tZS9pY29ucy9yZWd1bGFyL21pbnVzLXNxdWFyZSc7Cgp2YXIgXyA9IHJlcXVpcmUoJ2xvZGFzaCcpOwoKdmFyIGNsYXNzZXMgPSByZXF1aXJlKCd+L3V0aWwvY2xhc3Nlcy50cycpOwoKZnVuY3Rpb24gX2dldF9jaGlsZF9jYXRzKGNhdCwgYWxsX2NhdHMpIHsKICByZXR1cm4gXy5maWx0ZXIoYWxsX2NhdHMsIGZ1bmN0aW9uIChjKSB7CiAgICByZXR1cm4gXy5pc0VxdWFsKGMucGFyZW50LCBjYXQubmFtZSk7CiAgfSk7Cn0KCmZ1bmN0aW9uIF9hc3NpZ25fY2hpbGRyZW4ocGFyZW50LCBhbGxfY2F0cykgewogIHZhciBjaGlsZF9jYXRzID0gX2dldF9jaGlsZF9jYXRzKHBhcmVudCwgYWxsX2NhdHMpOwoKICBfLm1hcChjaGlsZF9jYXRzLCBmdW5jdGlvbiAoYykgewogICAgcmV0dXJuIF9hc3NpZ25fY2hpbGRyZW4oYywgYWxsX2NhdHMpOwogIH0pOwoKICBwYXJlbnQuY2hpbGRyZW4gPSBfLnNvcnRCeShjaGlsZF9jYXRzLCBmdW5jdGlvbiAoY2MpIHsKICAgIHJldHVybiAtY2MuZHVyYXRpb247CiAgfSk7Cn0KCmZ1bmN0aW9uIF9mbGF0dGVuX2hpZXJhcmNoeShjKSB7CiAgaWYgKCFjLmNoaWxkcmVuKSByZXR1cm4gW107CiAgcmV0dXJuIF8uZmxhdHRlbkRlZXAoW2MsIF8ubWFwKGMuY2hpbGRyZW4sIGZ1bmN0aW9uIChjYykgewogICAgcmV0dXJuIF9mbGF0dGVuX2hpZXJhcmNoeShjYyk7CiAgfSldKTsKfQoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdhdy1jYXRlZ29yeXRyZWUnLAogIHByb3BzOiB7CiAgICBldmVudHM6IHsKICAgICAgdHlwZTogQXJyYXkKICAgIH0KICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBleHBhbmRlZDogbmV3IFNldCgpLAogICAgICBzaG93X3BlcmM6IGZhbHNlCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIHRvdGFsX2R1cmF0aW9uOiBmdW5jdGlvbiB0b3RhbF9kdXJhdGlvbigpIHsKICAgICAgdmFyIHRvcF9jID0gXy5maWx0ZXIodGhpcy5jYXRlZ29yeV9oaWVyYXJjaHksIGZ1bmN0aW9uIChjKSB7CiAgICAgICAgcmV0dXJuIGMuZGVwdGggPT0gMDsKICAgICAgfSk7CgogICAgICByZXR1cm4gXy5zdW1CeSh0b3BfYywgZnVuY3Rpb24gKGMpIHsKICAgICAgICByZXR1cm4gYy5kdXJhdGlvbjsKICAgICAgfSk7CiAgICB9LAogICAgY2F0ZWdvcnlfaGllcmFyY2h5OiBmdW5jdGlvbiBjYXRlZ29yeV9oaWVyYXJjaHkoKSB7CiAgICAgIHZhciBldmVudHMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuZXZlbnRzKSk7CiAgICAgIHZhciBoaWVyID0gY2xhc3Nlcy5idWlsZF9jYXRlZ29yeV9oaWVyYXJjaHkoXy5tYXAoZXZlbnRzLCBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBuYW1lOiBlLmRhdGFbJyRjYXRlZ29yeSddCiAgICAgICAgfTsKICAgICAgfSkpOwogICAgICB2YXIgY2F0cyA9IGNsYXNzZXMuZmxhdHRlbl9jYXRlZ29yeV9oaWVyYXJjaHkoaGllcikubWFwKGZ1bmN0aW9uIChjKSB7CiAgICAgICAgYy5kdXJhdGlvbiA9IF8uc3VtQnkoZXZlbnRzLmZpbHRlcihmdW5jdGlvbiAoZSkgewogICAgICAgICAgdmFyIHBjYXQgPSBlLmRhdGFbJyRjYXRlZ29yeSddLnNsaWNlKDAsIGMubmFtZS5sZW5ndGgpOwogICAgICAgICAgcmV0dXJuIF8uaXNFcXVhbChjLm5hbWUsIHBjYXQpOwogICAgICAgIH0pLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgcmV0dXJuIGUuZHVyYXRpb247CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIGM7CiAgICAgIH0pOwoKICAgICAgdmFyIGNhdHNfd2l0aF9kZXB0aDAgPSBfLnNvcnRCeShfLmZpbHRlcihjYXRzLCBmdW5jdGlvbiAoYykgewogICAgICAgIHJldHVybiBjLmRlcHRoID09IDA7CiAgICAgIH0pLCBmdW5jdGlvbiAoYykgewogICAgICAgIHJldHVybiAtYy5kdXJhdGlvbjsKICAgICAgfSk7CgogICAgICBfLm1hcChjYXRzX3dpdGhfZGVwdGgwLCBmdW5jdGlvbiAoYykgewogICAgICAgIHJldHVybiBfYXNzaWduX2NoaWxkcmVuKGMsIGNhdHMpOwogICAgICB9KTsKCiAgICAgIGNhdHMgPSBfLmZsYXR0ZW4oXy5tYXAoY2F0c193aXRoX2RlcHRoMCwgZnVuY3Rpb24gKGMpIHsKICAgICAgICByZXR1cm4gX2ZsYXR0ZW5faGllcmFyY2h5KGMpOwogICAgICB9KSk7CiAgICAgIHJldHVybiBjYXRzOwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgZ2V0X2NhdGVnb3J5OiBmdW5jdGlvbiBnZXRfY2F0ZWdvcnkoY2F0X2FycikgewogICAgICByZXR1cm4gXy5maW5kKHRoaXMuY2F0ZWdvcnlfaGllcmFyY2h5LCBmdW5jdGlvbiAoYykgewogICAgICAgIHJldHVybiBfLmlzRXF1YWwoYy5uYW1lLCBjYXRfYXJyKTsKICAgICAgfSk7CiAgICB9LAogICAgdG9nZ2xlOiBmdW5jdGlvbiB0b2dnbGUoY2F0KSB7CiAgICAgIGlmICh0aGlzLmV4cGFuZGVkLmhhcyhjYXQubmFtZV9wcmV0dHkpKSB7CiAgICAgICAgdGhpcy5leHBhbmRlZFsiZGVsZXRlIl0oY2F0Lm5hbWVfcHJldHR5KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmV4cGFuZGVkLmFkZChjYXQubmFtZV9wcmV0dHkpOwogICAgICB9CgogICAgICB0aGlzLmV4cGFuZGVkID0gbmV3IFNldCh0aGlzLmV4cGFuZGVkKTsKICAgIH0sCiAgICBwYXJlbnRzX2V4cGFuZGVkOiBmdW5jdGlvbiBwYXJlbnRzX2V4cGFuZGVkKGNhdCkgewogICAgICBpZiAoY2F0ID09PSB1bmRlZmluZWQgfHwgIWNhdC5wYXJlbnQpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMucGFyZW50c19leHBhbmRlZCh0aGlzLmdldF9jYXRlZ29yeShjYXQucGFyZW50KSkgJiYgdGhpcy5leHBhbmRlZC5oYXMoY2F0LnBhcmVudC5qb2luKCc+JykpOwogICAgfQogIH0KfTs="},{"version":3,"sources":["CategoryTree.vue"],"names":[],"mappings":"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","sourcesContent":["<template lang=\"pug\">\ndiv(style=\"font-size: 0.9em\")\n  div(v-for=\"cat in category_hierarchy\", style=\"padding: 0.1em 0 0.1em 0\" @click=\"toggle(cat)\" v-if=\"parents_expanded(cat)\")\n    span(:style=\"'padding-left: ' + (1.4 * cat.depth) + 'em'\")\n\n      // icon\n      span(v-if=\"cat.children.length > 0\", style=\"opacity: 0.8\")\n        b(v-if=\"!expanded.has(cat.name_pretty)\")\n          icon.mr-1(name=\"regular/plus-square\", scale=\"0.8\")\n        b(v-else)\n          icon.mr-1(name=\"regular/minus-square\", scale=\"0.8\")\n      span(v-else, style=\"opacity: 0.6\")\n        icon(name=\"circle\", scale=\"0.4\", style=\"margin-left: 1em; margin-right: 1.22em;\")\n\n      // title\n      | {{cat.subname}}\n\n    // time\n    span(style=\"float: right\")\n      span(v-if=\"show_perc\")\n        | {{Math.round(100 * cat.duration / total_duration, 1)}}%\n      span(v-else)\n        | {{cat.duration | friendlyduration}}\n  hr\n  // TODO: Make configurable in a cleaner way (figure out a way to configure visualizations generally)\n  b-checkbox(v-model=\"show_perc\" size=\"sm\") Show percent\n</template>\n\n<script>\nimport 'vue-awesome/icons/circle';\nimport 'vue-awesome/icons/regular/plus-square';\nimport 'vue-awesome/icons/regular/minus-square';\nconst _ = require('lodash');\nconst classes = require('~/util/classes.ts');\n\nfunction _get_child_cats(cat, all_cats) {\n  return _.filter(all_cats, c => _.isEqual(c.parent, cat.name));\n}\n\nfunction _assign_children(parent, all_cats) {\n  const child_cats = _get_child_cats(parent, all_cats);\n  // Recurse\n  _.map(child_cats, c => _assign_children(c, all_cats));\n  parent.children = _.sortBy(child_cats, cc => -cc.duration);\n}\n\n// Flattens the category hierarchy\nfunction _flatten_hierarchy(c) {\n  if (!c.children) return [];\n  return _.flattenDeep([c, _.map(c.children, cc => _flatten_hierarchy(cc))]);\n}\n\nexport default {\n  name: 'aw-categorytree',\n  props: {\n    events: { type: Array },\n  },\n  data: function () {\n    return {\n      expanded: new Set(),\n      show_perc: false,\n    };\n  },\n  computed: {\n    total_duration: function () {\n      // sum top-level categories\n      const top_c = _.filter(this.category_hierarchy, c => c.depth == 0);\n      return _.sumBy(top_c, c => c.duration);\n    },\n    category_hierarchy: function () {\n      const events = JSON.parse(JSON.stringify(this.events));\n\n      const hier = classes.build_category_hierarchy(\n        _.map(events, e => {\n          return { name: e.data['$category'] };\n        })\n      );\n\n      let cats = classes.flatten_category_hierarchy(hier).map(c => {\n        c.duration = _.sumBy(\n          events.filter(e => {\n            const pcat = e.data['$category'].slice(0, c.name.length);\n            return _.isEqual(c.name, pcat);\n          }),\n          e => e.duration\n        );\n        return c;\n      });\n\n      const cats_with_depth0 = _.sortBy(\n        _.filter(cats, c => c.depth == 0),\n        c => -c.duration\n      );\n      _.map(cats_with_depth0, c => _assign_children(c, cats));\n\n      cats = _.flatten(_.map(cats_with_depth0, c => _flatten_hierarchy(c)));\n      //console.log(cats);\n      // TODO: If a category has children, but also activity attributed directly to the parent that does not belong to a child, then create a \"Other\" child containing the activity.\n      return cats;\n    },\n  },\n  methods: {\n    get_category: function (cat_arr) {\n      return _.find(this.category_hierarchy, c => _.isEqual(c.name, cat_arr));\n    },\n    toggle: function (cat) {\n      if (this.expanded.has(cat.name_pretty)) {\n        this.expanded.delete(cat.name_pretty);\n      } else {\n        this.expanded.add(cat.name_pretty);\n      }\n      // needed to trigger update, since Set isn't reactive in Vue 2\n      this.expanded = new Set(this.expanded);\n    },\n    parents_expanded: function (cat) {\n      if (cat === undefined || !cat.parent) {\n        // top-level category\n        return true;\n      }\n      return (\n        // Check grandparents recursively\n        this.parents_expanded(this.get_category(cat.parent)) &&\n        // Check parent\n        this.expanded.has(cat.parent.join('>'))\n      );\n    },\n  },\n};\n</script>\n"],"sourceRoot":"src/visualizations"}]}