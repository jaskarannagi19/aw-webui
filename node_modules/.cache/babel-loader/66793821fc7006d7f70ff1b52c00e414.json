{"remainingRequest":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/thread-loader/dist/cjs.js!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/babel-loader/lib/index.js!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/src/components/UserSatisfactionPoll.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/src/components/UserSatisfactionPoll.vue","mtime":1622212604093},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucGFyc2UtaW50IjsKaW1wb3J0IF9yYW5nZSBmcm9tICJsb2Rhc2gvZnAvcmFuZ2UiOwppbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7CnZhciBOVU1fT1BUSU9OUyA9IDEwOwp2YXIgSU5JVElBTF9XQUlUX1BFUklPRCA9IDcgKiAyNCAqIDYwICogNjA7CnZhciBCQUNLT0ZGX1BFUklPRCA9IDcgKiAyNCAqIDYwICogNjA7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAndXNlci1zYXRpc2ZhY3Rpb24tcG9sbCcsCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGlzUG9sbFZpc2libGU6IGZhbHNlLAogICAgICBpc1Bvc0ZvbGxvd1VwVmlzaWJsZTogZmFsc2UsCiAgICAgIGlzTmVnRm9sbG93VXBWaXNpYmxlOiBmYWxzZSwKICAgICAgb3B0aW9uczogX3JhbmdlKDEsIE5VTV9PUFRJT05TICsgMSksCiAgICAgIHJhdGluZzogbnVsbCwKICAgICAgZGF0YTogbnVsbAogICAgfTsKICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICB2YXIgaW5pdGlhbFRpbWVzdGFtcCA9IG1vbWVudCgpOwoKICAgIGlmIChsb2NhbFN0b3JhZ2UuaW5pdGlhbFRpbWVzdGFtcCkgewogICAgICBpbml0aWFsVGltZXN0YW1wID0gbW9tZW50KGxvY2FsU3RvcmFnZS5pbml0aWFsVGltZXN0YW1wKTsKICAgIH0gZWxzZSB7CiAgICAgIGxvY2FsU3RvcmFnZS5pbml0aWFsVGltZXN0YW1wID0gaW5pdGlhbFRpbWVzdGFtcDsKICAgIH0KCiAgICB0aGlzLnJldHJpZXZlRGF0YSgpOwoKICAgIGlmICghdGhpcy5kYXRhKSB7CiAgICAgIHRoaXMuZGF0YSA9IHsKICAgICAgICBpc0VuYWJsZWQ6IHRydWUsCiAgICAgICAgbmV4dFBvbGxUaW1lOiBpbml0aWFsVGltZXN0YW1wLmFkZChJTklUSUFMX1dBSVRfUEVSSU9ELCAnc2Vjb25kcycpLAogICAgICAgIHRpbWVzUG9sbElzU2hvd246IDAKICAgICAgfTsKICAgICAgdGhpcy5zYXZlRGF0YSgpOwogICAgfQoKICAgIGlmICghdGhpcy5kYXRhLmlzRW5hYmxlZCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKG1vbWVudCgpID49IG1vbWVudCh0aGlzLmRhdGEubmV4dFBvbGxUaW1lKSkgewogICAgICB0aGlzLmRhdGEudGltZXNQb2xsSXNTaG93biA9IHRoaXMuZGF0YS50aW1lc1BvbGxJc1Nob3duICsgMTsKICAgICAgdGhpcy5pc1BvbGxWaXNpYmxlID0gdHJ1ZTsKICAgICAgdGhpcy5kYXRhLm5leHRQb2xsVGltZSA9IG1vbWVudCgpLmFkZChCQUNLT0ZGX1BFUklPRCwgJ3NlY29uZHMnKTsKICAgIH0KCiAgICBpZiAodGhpcy5kYXRhLnRpbWVzUG9sbElzU2hvd24gPiAyKSB7CiAgICAgIHRoaXMuZGF0YS5pc0VuYWJsZWQgPSBmYWxzZTsKICAgIH0KCiAgICB0aGlzLnNhdmVEYXRhKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICByZXRyaWV2ZURhdGE6IGZ1bmN0aW9uIHJldHJpZXZlRGF0YSgpIHsKICAgICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyU2F0aXNmYWN0aW9uUG9sbERhdGEnKSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICB0aGlzLmRhdGEgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyU2F0aXNmYWN0aW9uUG9sbERhdGEnKSk7CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCd1c2VyU2F0aXNmYWN0aW9uUG9sbERhdGEgbm90IGZvdW5kIGluIGxvY2FsU3RvcmFnZTogJywgZXJyKTsKICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCd1c2VyU2F0aXNmYWN0aW9uUG9sbERhdGEnKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBzYXZlRGF0YTogZnVuY3Rpb24gc2F2ZURhdGEoKSB7CiAgICAgIHZhciBwYXJzZWQgPSBKU09OLnN0cmluZ2lmeSh0aGlzLmRhdGEpOwogICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndXNlclNhdGlzZmFjdGlvblBvbGxEYXRhJywgcGFyc2VkKTsKICAgIH0sCiAgICBzdWJtaXQ6IGZ1bmN0aW9uIHN1Ym1pdCgpIHsKICAgICAgdGhpcy5pc1BvbGxWaXNpYmxlID0gZmFsc2U7CiAgICAgIHRoaXMuZGF0YS5pc0VuYWJsZWQgPSBmYWxzZTsKICAgICAgdGhpcy5zYXZlRGF0YSgpOwoKICAgICAgaWYgKHBhcnNlSW50KHRoaXMucmF0aW5nKSA+PSA2KSB7CiAgICAgICAgdGhpcy5pc1Bvc0ZvbGxvd1VwVmlzaWJsZSA9IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5pc05lZ0ZvbGxvd1VwVmlzaWJsZSA9IHRydWU7CiAgICAgIH0KICAgIH0sCiAgICBkb250U2hvd0FnYWluOiBmdW5jdGlvbiBkb250U2hvd0FnYWluKCkgewogICAgICB0aGlzLmlzUG9sbFZpc2libGUgPSBmYWxzZTsKICAgICAgdGhpcy5kYXRhLmlzRW5hYmxlZCA9IGZhbHNlOwogICAgICB0aGlzLnNhdmVEYXRhKCk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["UserSatisfactionPoll.vue"],"names":[],"mappings":";;AAkEA,OAAA,MAAA,MAAA,QAAA;AAEA,IAAA,WAAA,GAAA,EAAA;AAEA,IAAA,mBAAA,GAAA,IAAA,EAAA,GAAA,EAAA,GAAA,EAAA;AAEA,IAAA,cAAA,GAAA,IAAA,EAAA,GAAA,EAAA,GAAA,EAAA;AAKA,eAAA;AACA,EAAA,IAAA,EAAA,wBADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,aAAA,EAAA,KADA;AAEA,MAAA,oBAAA,EAAA,KAFA;AAGA,MAAA,oBAAA,EAAA,KAHA;AAKA,MAAA,OAAA,EAAA,OAAA,CAAA,EAAA,WAAA,GAAA,CAAA,CALA;AAMA,MAAA,MAAA,EAAA,IANA;AAOA,MAAA,IAAA,EAAA;AAPA,KAAA;AASA,GAZA;AAaA,EAAA,OAbA,qBAaA;AAEA,QAAA,gBAAA,GAAA,MAAA,EAAA;;AACA,QAAA,YAAA,CAAA,gBAAA,EAAA;AACA,MAAA,gBAAA,GAAA,MAAA,CAAA,YAAA,CAAA,gBAAA,CAAA;AACA,KAFA,MAEA;AACA,MAAA,YAAA,CAAA,gBAAA,GAAA,gBAAA;AACA;;AAGA,SAAA,YAAA;;AACA,QAAA,CAAA,KAAA,IAAA,EAAA;AACA,WAAA,IAAA,GAAA;AACA,QAAA,SAAA,EAAA,IADA;AAEA,QAAA,YAAA,EAAA,gBAAA,CAAA,GAAA,CAAA,mBAAA,EAAA,SAAA,CAFA;AAGA,QAAA,gBAAA,EAAA;AAHA,OAAA;AAKA,WAAA,QAAA;AACA;;AAEA,QAAA,CAAA,KAAA,IAAA,CAAA,SAAA,EAAA;AACA;AACA;;AAGA,QAAA,MAAA,MAAA,MAAA,CAAA,KAAA,IAAA,CAAA,YAAA,CAAA,EAAA;AACA,WAAA,IAAA,CAAA,gBAAA,GAAA,KAAA,IAAA,CAAA,gBAAA,GAAA,CAAA;AACA,WAAA,aAAA,GAAA,IAAA;AACA,WAAA,IAAA,CAAA,YAAA,GAAA,MAAA,GAAA,GAAA,CAAA,cAAA,EAAA,SAAA,CAAA;AACA;;AAGA,QAAA,KAAA,IAAA,CAAA,gBAAA,GAAA,CAAA,EAAA;AACA,WAAA,IAAA,CAAA,SAAA,GAAA,KAAA;AACA;;AAEA,SAAA,QAAA;AACA,GAlDA;AAmDA,EAAA,OAAA,EAAA;AACA,IAAA,YADA,0BACA;AACA,UAAA,YAAA,CAAA,OAAA,CAAA,0BAAA,CAAA,EAAA;AACA,YAAA;AACA,eAAA,IAAA,GAAA,IAAA,CAAA,KAAA,CAAA,YAAA,CAAA,OAAA,CAAA,0BAAA,CAAA,CAAA;AACA,SAFA,CAEA,OAAA,GAAA,EAAA;AACA,UAAA,OAAA,CAAA,KAAA,CAAA,sDAAA,EAAA,GAAA;AACA,UAAA,YAAA,CAAA,UAAA,CAAA,0BAAA;AACA;AACA;AACA,KAVA;AAWA,IAAA,QAXA,sBAWA;AACA,UAAA,MAAA,GAAA,IAAA,CAAA,SAAA,CAAA,KAAA,IAAA,CAAA;AACA,MAAA,YAAA,CAAA,OAAA,CAAA,0BAAA,EAAA,MAAA;AACA,KAdA;AAeA,IAAA,MAfA,oBAeA;AACA,WAAA,aAAA,GAAA,KAAA;AACA,WAAA,IAAA,CAAA,SAAA,GAAA,KAAA;AACA,WAAA,QAAA;;AACA,UAAA,QAAA,CAAA,KAAA,MAAA,CAAA,IAAA,CAAA,EAAA;AACA,aAAA,oBAAA,GAAA,IAAA;AACA,OAFA,MAEA;AACA,aAAA,oBAAA,GAAA,IAAA;AACA;AACA,KAxBA;AAyBA,IAAA,aAzBA,2BAyBA;AACA,WAAA,aAAA,GAAA,KAAA;AACA,WAAA,IAAA,CAAA,SAAA,GAAA,KAAA;AACA,WAAA,QAAA;AACA;AA7BA;AAnDA,CAAA","sourcesContent":["<template lang=\"pug\">\n  div\n    b-alert(v-if=\"isPollVisible\", variant=\"info\", show)\n      button(type=\"button\", class=\"close\", @click=\"isPollVisible=false\") &times;\n      form\n        p\n          | Hey there! You've been using ActivityWatch for a while. How likely are you to recommend it to a friend/colleague on a scale 1-10? (with 10 being the most likely)\n        div(class=\"radio-options\")\n          div(v-for=\"i in options\", class=\"option-group\")\n            input(type=\"radio\", :id=\"'option' + i\", name=\"rating\", :value=\"i\", v-model=\"rating\")\n            br\n            label(:for=\"'option' + i\", style=\"display: block\")\n              | {{ i }}\n      div(style=\"display: flex; justify-content: space-between\")\n        a(@click=\"dontShowAgain\" href=\"#\")\n          | Don't show again\n        input(type=\"submit\" value=\"Submit\" @click=\"submit\")\n\n    b-alert(v-if=\"isPosFollowUpVisible\", variant=\"info\" show)\n      button(type=\"button\", class=\"close\", @click=\"isPosFollowUpVisible=false\") &times;\n      | We're really happy to hear you are enjoying ActivityWatch, but we think we can do even better! To help us help you, here are a few things you can do:\n      ul\n        li\n          | Support us on #[a(href=\"https://www.patreon.com/erikbjare\") Patreon] or #[a(href=\"https://opencollective.com/activitywatch\") Open Collective] (or by #[a(href=\"https://activitywatch.net/donate/\") other donation methods]).\n        li\n          | Using ActivityWatch at work? Consider asking your employer to support us!\n        li\n          | Post about it on social media and tell your friends and colleagues! We are on #[a(href=\"https://twitter.com/ActivityWatchIt\") Twitter] and #[a(href=\"https://www.facebook.com/ActivityWatch\") Facebook].\n        //li\n          | Sign up for the newsletter.\n        li\n          | Vote for new features on the #[a(href=\"https://forum.activitywatch.net/c/features\") forum].\n        //li\n          | Fill out the #[a(href=\"https://forms.gle/q2N9K5RoERBV8kqPA\") feedback form].\n        li\n          | Rate us on #[a(href=\"https://alternativeto.net/software/activitywatch/\") AlternativeTo] and #[a(href=\"https://play.google.com/store/apps/details?id=net.activitywatch.android\") Google Play Store].\n        li\n          | Join our #[a(href=\"https://discord.gg/vDskV9q\") Discord server].\n\n    b-alert(v-if=\"isNegFollowUpVisible\", variant=\"info\" show)\n      button(type=\"button\", class=\"close\", @click=\"isNegFollowUpVisible=false\") &times;\n      | We are sorry to hear that you did not like ActivityWatch, but we want to improve! We would be very thankful if you helped us by:\n      ul\n        li\n          | Fill out the #[a(href=\"https://forms.gle/q2N9K5RoERBV8kqPA\") feedback form].\n        li\n          | Vote for new features on the #[a(href=\"https://forum.activitywatch.net/c/features\") forum].\n</template>\n\n<style scoped>\n.radio-options {\n  display: flex;\n  justify-content: space-around;\n}\n\n.option-group {\n  text-align: center;\n}\n\nul {\n  margin: 0;\n}\n</style>\n\n<script>\nimport { range } from 'lodash/fp';\nimport moment from 'moment';\n\nconst NUM_OPTIONS = 10;\n// INITIAL_WAIT_PERIOD is how long to wait from initialTimestamp to the first time that the poll shows up\nconst INITIAL_WAIT_PERIOD = 7 * 24 * 60 * 60;\n// BACKOFF_PERIOD is how many seconds to wait to show the poll again if the user closed it\nconst BACKOFF_PERIOD = 7 * 24 * 60 * 60;\n// The following may be used for testing\n// const INITIAL_WAIT_PERIOD = 1;\n// const BACKOFF_PERIOD = 1;\n\nexport default {\n  name: 'user-satisfaction-poll',\n  data() {\n    return {\n      isPollVisible: false,\n      isPosFollowUpVisible: false,\n      isNegFollowUpVisible: false,\n      // options is an array of [1, ..., NUM_OPTIONS]\n      options: range(1, NUM_OPTIONS + 1),\n      rating: null,\n      data: null,\n    };\n  },\n  mounted() {\n    // Check if initialTimestamp (first time that the user runs the web app) exists\n    let initialTimestamp = moment();\n    if (localStorage.initialTimestamp) {\n      initialTimestamp = moment(localStorage.initialTimestamp);\n    } else {\n      localStorage.initialTimestamp = initialTimestamp;\n    }\n\n    // Get the rest of the data\n    this.retrieveData();\n    if (!this.data) {\n      this.data = {\n        isEnabled: true,\n        nextPollTime: initialTimestamp.add(INITIAL_WAIT_PERIOD, 'seconds'),\n        timesPollIsShown: 0,\n      };\n      this.saveData();\n    }\n\n    if (!this.data.isEnabled) {\n      return;\n    }\n\n    // Show poll if enough time has passed\n    if (moment() >= moment(this.data.nextPollTime)) {\n      this.data.timesPollIsShown = this.data.timesPollIsShown + 1;\n      this.isPollVisible = true;\n      this.data.nextPollTime = moment().add(BACKOFF_PERIOD, 'seconds');\n    }\n\n    // Show the poll a maximum of 3 times\n    if (this.data.timesPollIsShown > 2) {\n      this.data.isEnabled = false;\n    }\n\n    this.saveData();\n  },\n  methods: {\n    retrieveData() {\n      if (localStorage.getItem('userSatisfactionPollData')) {\n        try {\n          this.data = JSON.parse(localStorage.getItem('userSatisfactionPollData'));\n        } catch (err) {\n          console.error('userSatisfactionPollData not found in localStorage: ', err);\n          localStorage.removeItem('userSatisfactionPollData');\n        }\n      }\n    },\n    saveData() {\n      const parsed = JSON.stringify(this.data);\n      localStorage.setItem('userSatisfactionPollData', parsed);\n    },\n    submit() {\n      this.isPollVisible = false;\n      this.data.isEnabled = false;\n      this.saveData();\n      if (parseInt(this.rating) >= 6) {\n        this.isPosFollowUpVisible = true;\n      } else {\n        this.isNegFollowUpVisible = true;\n      }\n    },\n    dontShowAgain() {\n      this.isPollVisible = false;\n      this.data.isEnabled = false;\n      this.saveData();\n    },\n  },\n};\n</script>\n"],"sourceRoot":"src/components"}]}