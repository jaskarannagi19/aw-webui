{"remainingRequest":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/thread-loader/dist/cjs.js!/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/babel-loader/lib/index.js!/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/src/visualizations/Calendar.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/src/visualizations/Calendar.vue","mtime":1622830085274},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UiOwppbXBvcnQgX21hcCBmcm9tICJsb2Rhc2gvbWFwIjsKaW1wb3J0IF9maWx0ZXIgZnJvbSAibG9kYXNoL2ZpbHRlciI7CmltcG9ydCBfZmluZCBmcm9tICJsb2Rhc2gvZmluZCI7CmltcG9ydCBfbWF4QnkgZnJvbSAibG9kYXNoL21heEJ5IjsKaW1wb3J0IF9taW5CeSBmcm9tICJsb2Rhc2gvbWluQnkiOwppbXBvcnQgeyBnZXRUaXRsZUF0dHIsIGdldENvbG9yRnJvbVN0cmluZyB9IGZyb20gJy4uL3V0aWwvY29sb3InOwppbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7CmltcG9ydCBGdWxsQ2FsZW5kYXIgZnJvbSAnQGZ1bGxjYWxlbmRhci92dWUnOwppbXBvcnQgdGltZUdyaWRQbHVnaW4gZnJvbSAnQGZ1bGxjYWxlbmRhci90aW1lZ3JpZCc7CmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICBGdWxsQ2FsZW5kYXI6IEZ1bGxDYWxlbmRhcgogIH0sCiAgcHJvcHM6IHsKICAgIGJ1Y2tldHM6IHsKICAgICAgdHlwZTogQXJyYXkKICAgIH0KICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBmaXRUb0FjdGl2ZTogZmFsc2UsCiAgICAgIHNlbGVjdGVkQnVja2V0OiBudWxsLAogICAgICB2aWV3OiAndGltZUdyaWREYXknCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGNhbGVuZGFyT3B0aW9uczogZnVuY3Rpb24gY2FsZW5kYXJPcHRpb25zKCkgewogICAgICB2YXIgZXZlbnRzID0gdGhpcy5ldmVudHM7CgogICAgICB2YXIgZmlyc3QgPSBfbWluQnkoZXZlbnRzLCBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBlLnN0YXJ0OwogICAgICB9KTsKCiAgICAgIHZhciBsYXN0ID0gX21heEJ5KGV2ZW50cywgZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gZS5lbmQ7CiAgICAgIH0pOwoKICAgICAgdmFyIHN0YXJ0LCBlbmQ7CgogICAgICBpZiAodGhpcy5maXRUb0FjdGl2ZSAmJiBldmVudHMubGVuZ3RoID4gMCkgewogICAgICAgIGNvbnNvbGUubG9nKGZpcnN0LnN0YXJ0KTsKICAgICAgICBzdGFydCA9IG1vbWVudChmaXJzdC5zdGFydCkuc3RhcnRPZignaG91cicpLmZvcm1hdCgpLnNsaWNlKDExLCAxNik7CiAgICAgICAgZW5kID0gbW9tZW50KGxhc3QuZW5kKS5lbmRPZignaG91cicpLmZvcm1hdCgpLnNsaWNlKDExLCAxNik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc3RhcnQgPSAnMDA6MDA6MDAnOwogICAgICAgIGVuZCA9ICcyNDowMDowMCc7CiAgICAgIH0KCiAgICAgIHJldHVybiB7CiAgICAgICAgcGx1Z2luczogW3RpbWVHcmlkUGx1Z2luXSwKICAgICAgICBpbml0aWFsVmlldzogdGhpcy52aWV3LAogICAgICAgIGV2ZW50Q2xpY2s6IHRoaXMub25FdmVudENsaWNrLAogICAgICAgIGV2ZW50czogZXZlbnRzLAogICAgICAgIGFsbERheVNsb3Q6IGZhbHNlLAogICAgICAgIHNsb3RNaW5UaW1lOiBzdGFydCwKICAgICAgICBzbG90TWF4VGltZTogZW5kLAogICAgICAgIG5vd0luZGljYXRvcjogdHJ1ZSwKICAgICAgICBleHBhbmRSb3dzOiB0cnVlLAogICAgICAgIHNsb3RMYWJlbEZvcm1hdDogewogICAgICAgICAgaG91cjogJzItZGlnaXQnLAogICAgICAgICAgbWludXRlOiAnMi1kaWdpdCcsCiAgICAgICAgICBob3VyMTI6IGZhbHNlCiAgICAgICAgfQogICAgICB9OwogICAgfSwKICAgIGV2ZW50czogZnVuY3Rpb24gZXZlbnRzKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgaWYgKHRoaXMuYnVja2V0cyA9PSBudWxsKSByZXR1cm4gW107CgogICAgICB2YXIgYnVja2V0ID0gX2ZpbmQodGhpcy5idWNrZXRzLCBmdW5jdGlvbiAoYikgewogICAgICAgIHJldHVybiBiLmlkID09IF90aGlzLnNlbGVjdGVkQnVja2V0OwogICAgICB9KTsKCiAgICAgIGlmIChidWNrZXQgPT0gbnVsbCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGV2ZW50cyA9IGJ1Y2tldC5ldmVudHM7CiAgICAgIGV2ZW50cyA9IF9maWx0ZXIoZXZlbnRzLCBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBlLmR1cmF0aW9uID4gMTA7CiAgICAgIH0pOwogICAgICBldmVudHMgPSBfbWFwKGV2ZW50cywgZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgdGl0bGU6IGdldFRpdGxlQXR0cihidWNrZXQsIGUpLAogICAgICAgICAgc3RhcnQ6IG1vbWVudChlLnRpbWVzdGFtcCkuZm9ybWF0KCksCiAgICAgICAgICBlbmQ6IG1vbWVudChlLnRpbWVzdGFtcCkuYWRkKGUuZHVyYXRpb24sICdzZWNvbmRzJykuZm9ybWF0KCksCiAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IGdldENvbG9yRnJvbVN0cmluZyhnZXRUaXRsZUF0dHIoYnVja2V0LCBlKSkKICAgICAgICB9OwogICAgICB9KTsKICAgICAgcmV0dXJuIGV2ZW50czsKICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICB2aWV3OiBmdW5jdGlvbiB2aWV3KHRvKSB7CiAgICAgIHZhciBjYWxlbmRhciA9IHRoaXMuJHJlZnMuZnVsbENhbGVuZGFyLmdldEFwaSgpOwogICAgICBjYWxlbmRhci5jaGFuZ2VWaWV3KHRvKTsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIG9uRXZlbnRDbGljazogZnVuY3Rpb24gb25FdmVudENsaWNrKGFyZykgewogICAgICBhbGVydCgnZXZlbnQgY2xpY2shICcgKyBKU09OLnN0cmluZ2lmeShhcmcuZXZlbnQpKTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["Calendar.vue"],"names":[],"mappings":"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","sourcesContent":["<template lang=\"pug\">\ndiv.mx-3\n  b-form\n    b-form-group(label=\"Bucket:\")\n      select(v-model=\"selectedBucket\")\n        option(v-for=\"bucket in buckets\", :value=\"bucket.id\") {{ bucket.id }}\n    b-form-group(label=\"Show:\")\n      select(v-model=\"view\")\n        option(value=\"timeGridDay\") Day\n        option(value=\"timeGridWeek\") Week\n    b-form-group\n      b-checkbox(v-model=\"fitToActive\")\n        | Fit to active\n  FullCalendar(ref=\"fullCalendar\", :options=\"calendarOptions\")\n</template>\n\n<script>\nimport { getTitleAttr, getColorFromString } from '../util/color';\nimport moment from 'moment';\nimport _ from 'lodash';\nimport FullCalendar from '@fullcalendar/vue';\nimport timeGridPlugin from '@fullcalendar/timegrid';\n\n// TODO: Use canonical timeline query, with flooding and categorization\n// TODO: Checkbox for toggling category-view, where adjacent events with same category are merged and the events are labeled by category\n// TODO: Use the recommended way of dynamically getting events: https://fullcalendar.io/docs/events-function\nexport default {\n  components: {\n    FullCalendar, // make the <FullCalendar> tag available\n  },\n  props: {\n    buckets: { type: Array },\n  },\n  data() {\n    return { fitToActive: false, selectedBucket: null, view: 'timeGridDay' };\n  },\n  computed: {\n    calendarOptions: function () {\n      const events = this.events;\n      const first = _.minBy(events, e => e.start);\n      const last = _.maxBy(events, e => e.end);\n      // FIXME: end must be at least one slot (1 hour) after start, otherwise it fails hard\n      let start, end;\n      if (this.fitToActive && events.length > 0) {\n        console.log(first.start);\n        start = moment(first.start).startOf('hour').format().slice(11, 16);\n        end = moment(last.end).endOf('hour').format().slice(11, 16);\n      } else {\n        start = '00:00:00';\n        end = '24:00:00';\n      }\n      return {\n        plugins: [timeGridPlugin],\n        initialView: this.view,\n        eventClick: this.onEventClick,\n        events: events,\n        allDaySlot: false,\n        slotMinTime: start,\n        slotMaxTime: end,\n        nowIndicator: true,\n        expandRows: true,\n        slotLabelFormat: {\n          hour: '2-digit',\n          minute: '2-digit',\n          //second: '2-digit',\n          hour12: false,\n        },\n      };\n    },\n    events: function () {\n      // NOTE: This returns FullCalendar events, not ActivityWatch events.\n      if (this.buckets == null) return [];\n\n      const bucket = _.find(this.buckets, b => b.id == this.selectedBucket);\n      if (bucket == null) {\n        return;\n      }\n      let events = bucket.events;\n      events = _.filter(events, e => e.duration > 10);\n      events = _.map(events, e => {\n        return {\n          title: getTitleAttr(bucket, e),\n          start: moment(e.timestamp).format(),\n          end: moment(e.timestamp).add(e.duration, 'seconds').format(),\n          backgroundColor: getColorFromString(getTitleAttr(bucket, e)),\n        };\n      });\n      return events;\n    },\n  },\n  watch: {\n    view: function (to) {\n      const calendar = this.$refs.fullCalendar.getApi();\n      calendar.changeView(to);\n    },\n  },\n  methods: {\n    onEventClick: function (arg) {\n      // TODO: Open event inspector/editor here\n      alert('event click! ' + JSON.stringify(arg.event));\n    },\n  },\n};\n</script>\n"],"sourceRoot":"src/visualizations"}]}