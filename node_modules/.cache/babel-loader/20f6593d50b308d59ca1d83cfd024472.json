{"remainingRequest":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/thread-loader/dist/cjs.js!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/babel-loader/lib/index.js!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/src/views/Search.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/src/views/Search.vue","mtime":1622212604097},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy50cmltIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiL2hvbWUvamFza2FyYW4vY29kZS9qYXNrYXJhbi9hY3Rpdml0eXdhdGNoL2F3LXNlcnZlci9hdy13ZWJ1aS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfb3JkZXJCeSBmcm9tICJsb2Rhc2gvb3JkZXJCeSI7CmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JzsKaW1wb3J0IHsgY2Fub25pY2FsRXZlbnRzIH0gZnJvbSAnfi9xdWVyaWVzJzsKaW1wb3J0ICd2dWUtYXdlc29tZS9pY29ucy9zZWFyY2gnOwppbXBvcnQgJ3Z1ZS1hd2Vzb21lL2ljb25zL3NwaW5uZXInOwppbXBvcnQgJ3Z1ZS1hd2Vzb21lL2ljb25zL2FuZ2xlLWRvdWJsZS1kb3duJzsKaW1wb3J0ICd2dWUtYXdlc29tZS9pY29ucy9hbmdsZS1kb3VibGUtdXAnOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ1NlYXJjaCcsCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHBhdHRlcm46ICcnLAogICAgICB2aXNfbWV0aG9kOiAnZXZlbnRsaXN0JywKICAgICAgZXZlbnRfdHlwZTogJ2N1cnJlbnR3aW5kb3cnLAogICAgICBldmVudHM6IG51bGwsCiAgICAgIGVycm9yOiAnJywKICAgICAgc3RhdHVzOiBudWxsLAogICAgICBob3N0bmFtZTogJycsCiAgICAgIHNob3dfb3B0aW9uczogZmFsc2UsCiAgICAgIHVzZV9yZWdleDogdHJ1ZSwKICAgICAgZmlsdGVyX2FmazogdHJ1ZSwKICAgICAgc3RhcnQ6IG1vbWVudCgpLnN1YnRyYWN0KDEsICdkYXknKSwKICAgICAgc3RvcDogbW9tZW50KCkuYWRkKDEsICdkYXknKQogICAgfTsKICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uICgpIHsKICAgIHZhciBfbW91bnRlZCA9IF9hc3luY1RvR2VuZXJhdG9yKHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2J1Y2tldHMvZW5zdXJlQnVja2V0cycpOwoKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIHRoaXMuaG9zdG5hbWUgPSBPYmplY3Qua2V5cyh0aGlzLiRzdG9yZS5nZXR0ZXJzWydidWNrZXRzL2J1Y2tldHNCeUhvc3RuYW1lJ10pWzBdOwoKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlLCB0aGlzKTsKICAgIH0pKTsKCiAgICBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgICByZXR1cm4gX21vdW50ZWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0KCiAgICByZXR1cm4gbW91bnRlZDsKICB9KCksCiAgbWV0aG9kczogewogICAgc2VhcmNoOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfc2VhcmNoID0gX2FzeW5jVG9HZW5lcmF0b3IocmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgdmFyIHF1ZXJ5LCBxdWVyeV9hcnJheSwgdGltZXBlcmlvZHMsIGRhdGE7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHF1ZXJ5ID0gY2Fub25pY2FsRXZlbnRzKHsKICAgICAgICAgICAgICAgICAgYmlkX3dpbmRvdzogJ2F3LXdhdGNoZXItd2luZG93XycgKyB0aGlzLmhvc3RuYW1lLAogICAgICAgICAgICAgICAgICBiaWRfYWZrOiAnYXctd2F0Y2hlci1hZmtfJyArIHRoaXMuaG9zdG5hbWUsCiAgICAgICAgICAgICAgICAgIGZpbHRlcl9hZms6IHRoaXMuZmlsdGVyX2FmaywKICAgICAgICAgICAgICAgICAgY2xhc3NlczogW1tbJ3NlYXJjaGVkJ10sIHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiAncmVnZXgnLAogICAgICAgICAgICAgICAgICAgIHJlZ2V4OiB0aGlzLnBhdHRlcm4KICAgICAgICAgICAgICAgICAgfV1dLAogICAgICAgICAgICAgICAgICBmaWx0ZXJfY2xhc3NlczogW1snc2VhcmNoZWQnXV0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcXVlcnkgKz0gJzsgUkVUVVJOID0gZXZlbnRzOyc7CiAgICAgICAgICAgICAgICBxdWVyeV9hcnJheSA9IHF1ZXJ5LnNwbGl0KCc7JykubWFwKGZ1bmN0aW9uIChzKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBzLnRyaW0oKSArICc7JzsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgdGltZXBlcmlvZHMgPSBbdGhpcy5zdGFydC5mb3JtYXQoKSArICcvJyArIHRoaXMuc3RvcC5mb3JtYXQoKV07CiAgICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDQ7CiAgICAgICAgICAgICAgICB0aGlzLnN0YXR1cyA9ICdzZWFyY2hpbmcnOwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA4OwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGF3LnF1ZXJ5KHRpbWVwZXJpb2RzLCBxdWVyeV9hcnJheSk7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIGRhdGEgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgICAgIHRoaXMuZXZlbnRzID0gX29yZGVyQnkoZGF0YVswXSwgWyd0aW1lc3RhbXAnXSwgWydkZXNjJ10pOwogICAgICAgICAgICAgICAgdGhpcy5lcnJvciA9ICcnOwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxNzsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSAxMzsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi50MCA9IF9jb250ZXh0MlsiY2F0Y2giXSg0KTsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoX2NvbnRleHQyLnQwKTsKICAgICAgICAgICAgICAgIHRoaXMuZXJyb3IgPSBfY29udGV4dDIudDAucmVzcG9uc2UuZGF0YS5tZXNzYWdlOwoKICAgICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSAxNzsKICAgICAgICAgICAgICAgIHRoaXMuc3RhdHVzID0gbnVsbDsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuZmluaXNoKDE3KTsKCiAgICAgICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMiwgdGhpcywgW1s0LCAxMywgMTcsIDIwXV0pOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBzZWFyY2goKSB7CiAgICAgICAgcmV0dXJuIF9zZWFyY2guYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHNlYXJjaDsKICAgIH0oKQogIH0KfTs="},{"version":3,"sources":["Search.vue"],"names":[],"mappings":";;;;;;;;AAoEA,OAAA,MAAA,MAAA,QAAA;AACA,SAAA,eAAA,QAAA,WAAA;AAEA,OAAA,0BAAA;AACA,OAAA,2BAAA;AACA,OAAA,qCAAA;AACA,OAAA,mCAAA;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,QADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,OAAA,EAAA,EADA;AAEA,MAAA,UAAA,EAAA,WAFA;AAGA,MAAA,UAAA,EAAA,eAHA;AAIA,MAAA,MAAA,EAAA,IAJA;AAKA,MAAA,KAAA,EAAA,EALA;AAMA,MAAA,MAAA,EAAA,IANA;AAOA,MAAA,QAAA,EAAA,EAPA;AAUA,MAAA,YAAA,EAAA,KAVA;AAWA,MAAA,SAAA,EAAA,IAXA;AAYA,MAAA,UAAA,EAAA,IAZA;AAaA,MAAA,KAAA,EAAA,MAAA,GAAA,QAAA,CAAA,CAAA,EAAA,KAAA,CAbA;AAcA,MAAA,IAAA,EAAA,MAAA,GAAA,GAAA,CAAA,CAAA,EAAA,KAAA;AAdA,KAAA;AAgBA,GAnBA;AAoBA,EAAA,OAAA;AAAA,6DAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACA,KAAA,MAAA,CAAA,QAAA,CAAA,uBAAA,CADA;;AAAA;AAEA,mBAAA,QAAA,GAAA,MAAA,CAAA,IAAA,CAAA,KAAA,MAAA,CAAA,OAAA,CAAA,2BAAA,CAAA,EAAA,CAAA,CAAA;;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA,KApBA;AAwBA,EAAA,OAAA,EAAA;AACA,IAAA,MAAA;AAAA,8DAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,gBAAA,KADA,GACA,eAAA,CAAA;AACA,kBAAA,UAAA,EAAA,uBAAA,KAAA,QADA;AAEA,kBAAA,OAAA,EAAA,oBAAA,KAAA,QAFA;AAGA,kBAAA,UAAA,EAAA,KAAA,UAHA;AAIA,kBAAA,OAAA,EAAA,CAAA,CAAA,CAAA,UAAA,CAAA,EAAA;AAAA,oBAAA,IAAA,EAAA,OAAA;AAAA,oBAAA,KAAA,EAAA,KAAA;AAAA,mBAAA,CAAA,CAJA;AAKA,kBAAA,cAAA,EAAA,CAAA,CAAA,UAAA,CAAA;AALA,iBAAA,CADA;AAQA,gBAAA,KAAA,IAAA,oBAAA;AAEA,gBAAA,WAVA,GAUA,KAAA,CAAA,KAAA,CAAA,GAAA,EAAA,GAAA,CAAA,UAAA,CAAA;AAAA,yBAAA,CAAA,CAAA,IAAA,KAAA,GAAA;AAAA,iBAAA,CAVA;AAWA,gBAAA,WAXA,GAWA,CAAA,KAAA,KAAA,CAAA,MAAA,KAAA,GAAA,GAAA,KAAA,IAAA,CAAA,MAAA,EAAA,CAXA;AAAA;AAaA,qBAAA,MAAA,GAAA,WAAA;AAbA;AAAA,uBAcA,KAAA,GAAA,CAAA,KAAA,CAAA,WAAA,EAAA,WAAA,CAdA;;AAAA;AAcA,gBAAA,IAdA;AAeA,qBAAA,MAAA,GAAA,SAAA,IAAA,CAAA,CAAA,CAAA,EAAA,CAAA,WAAA,CAAA,EAAA,CAAA,MAAA,CAAA,CAAA;AACA,qBAAA,KAAA,GAAA,EAAA;AAhBA;AAAA;;AAAA;AAAA;AAAA;AAkBA,gBAAA,OAAA,CAAA,KAAA;AACA,qBAAA,KAAA,GAAA,aAAA,QAAA,CAAA,IAAA,CAAA,OAAA;;AAnBA;AAAA;AAqBA,qBAAA,MAAA,GAAA,IAAA;AArBA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AADA;AAxBA,CAAA","sourcesContent":["<template lang=\"pug\">\ndiv\n  h3 Search\n\n  b-alert(style=\"warning\" show)\n    | This feature is still in early development.\n\n  b-alert(v-if=\"error\" show variant=\"danger\")\n    | {{error}}\n\n  b-input-group(size=\"lg\")\n    b-input(v-model=\"pattern\" v-on:keyup.enter=\"search()\" placeholder=\"Regex pattern to search for\")\n    b-input-group-append\n      b-button(type=\"button\", @click=\"search()\" variant=\"success\")\n        icon(name=\"search\")\n        | Search\n\n  div.d-flex.mt-1\n    span.mr-auto.small(style=\"color: #666\") Hostname: {{hostname}}\n    b-button(size=\"sm\", variant=\"outline-dark\" style=\"border: 0\" @click=\"show_options = !show_options\")\n      span(v-if=\"!show_options\")\n        | #[icon(name=\"angle-double-down\")] Show options\n      span(v-else)\n        | #[icon(name=\"angle-double-up\")] Hide options\n\n  div(v-if=\"show_options\")\n    h4 Options\n    div Hostname\n      select(v-model=\"hostname\")\n        option(v-for=\"hostname in Object.keys($store.getters['buckets/bucketsByHostname'])\")\n          | {{hostname}}\n    div Start: {{start.format()}}\n    div End: {{stop.format()}}\n    //div\n      label Use regex\n      input(type=\"checkbox\" v-model=\"use_regex\")\n    div\n      label Filter AFK\n      input(type=\"checkbox\" v-model=\"filter_afk\")\n    //div.form-row\n      div.form-group.col-md-6\n        | Start\n        input.form-control(type=\"date\", :max=\"today\", v-model=\"startdate\")\n      div.form-group.col-md-6\n        | End\n        input.form-control(type=\"date\", :max=\"tomorrow\", v-model=\"enddate\")\n\n    div.form-inline\n\n  div(v-if=\"status == 'searching'\")\n    div #[icon(name=\"spinner\" pulse)] Searching...\n\n  div(v-if=\"events != null\")\n    hr\n\n    aw-selectable-eventview(:events=\"events\")\n\n    div\n      | Didn't find what you were looking for?\n      br\n      | Add a week to the search: #[b-button(size=\"sm\" variant=\"outline-dark\" @click=\"start = start.subtract(1, 'week'); search()\") +1 week]\n\n</template>\n\n<style scoped lang=\"scss\"></style>\n\n<script>\nimport _ from 'lodash';\nimport moment from 'moment';\nimport { canonicalEvents } from '~/queries';\n\nimport 'vue-awesome/icons/search';\nimport 'vue-awesome/icons/spinner';\nimport 'vue-awesome/icons/angle-double-down';\nimport 'vue-awesome/icons/angle-double-up';\n\nexport default {\n  name: 'Search',\n  data() {\n    return {\n      pattern: '',\n      vis_method: 'eventlist',\n      event_type: 'currentwindow',\n      events: null,\n      error: '',\n      status: null,\n      hostname: '',\n\n      // Options\n      show_options: false,\n      use_regex: true,\n      filter_afk: true,\n      start: moment().subtract(1, 'day'),\n      stop: moment().add(1, 'day'),\n    };\n  },\n  mounted: async function () {\n    await this.$store.dispatch('buckets/ensureBuckets');\n    this.hostname = Object.keys(this.$store.getters['buckets/bucketsByHostname'])[0];\n  },\n  methods: {\n    search: async function () {\n      let query = canonicalEvents({\n        bid_window: 'aw-watcher-window_' + this.hostname,\n        bid_afk: 'aw-watcher-afk_' + this.hostname,\n        filter_afk: this.filter_afk,\n        classes: [[['searched'], { type: 'regex', regex: this.pattern }]],\n        filter_classes: [['searched']],\n      });\n      query += '; RETURN = events;';\n\n      const query_array = query.split(';').map(s => s.trim() + ';');\n      const timeperiods = [this.start.format() + '/' + this.stop.format()];\n      try {\n        this.status = 'searching';\n        const data = await this.$aw.query(timeperiods, query_array);\n        this.events = _.orderBy(data[0], ['timestamp'], ['desc']);\n        this.error = '';\n      } catch (e) {\n        console.error(e);\n        this.error = e.response.data.message;\n      } finally {\n        this.status = null;\n      }\n    },\n  },\n};\n</script>\n"],"sourceRoot":"src/views"}]}