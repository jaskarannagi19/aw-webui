{"remainingRequest":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/thread-loader/dist/cjs.js!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/babel-loader/lib/index.js!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/src/views/Buckets.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/src/views/Buckets.vue","mtime":1622212604097},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiL2hvbWUvamFza2FyYW4vY29kZS9qYXNrYXJhbi9hY3Rpdml0eXdhdGNoL2F3LXNlcnZlci9hdy13ZWJ1aS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfb3JkZXJCeSBmcm9tICJsb2Rhc2gvb3JkZXJCeSI7CmltcG9ydCAndnVlLWF3ZXNvbWUvaWNvbnMvdHJhc2gnOwppbXBvcnQgJ3Z1ZS1hd2Vzb21lL2ljb25zL2Rvd25sb2FkJzsKaW1wb3J0ICd2dWUtYXdlc29tZS9pY29ucy9mb2xkZXItb3Blbic7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQnVja2V0cycsCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGltcG9ydF9maWxlOiBudWxsLAogICAgICBpbXBvcnRfZXJyb3I6IG51bGwsCiAgICAgIGRlbGV0ZV9idWNrZXRfc2VsZWN0ZWQ6IG51bGwsCiAgICAgIGZpZWxkczogW3sKICAgICAgICBrZXk6ICdpZCcsCiAgICAgICAgbGFiZWw6ICdCdWNrZXQgSUQnLAogICAgICAgIHNvcnRhYmxlOiB0cnVlCiAgICAgIH0sIHsKICAgICAgICBrZXk6ICdob3N0bmFtZScsCiAgICAgICAgc29ydGFibGU6IHRydWUKICAgICAgfSwgewogICAgICAgIGtleTogJ2xhc3RfdXBkYXRlZCcsCiAgICAgICAgbGFiZWw6ICdVcGRhdGVkJywKICAgICAgICBzb3J0YWJsZTogdHJ1ZQogICAgICB9LCB7CiAgICAgICAga2V5OiAnYWN0aW9ucycsCiAgICAgICAgbGFiZWw6ICcnCiAgICAgIH1dCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGJ1Y2tldHM6IGZ1bmN0aW9uIGJ1Y2tldHMoKSB7CiAgICAgIHJldHVybiBfb3JkZXJCeSh0aGlzLiRzdG9yZS5zdGF0ZS5idWNrZXRzLmJ1Y2tldHMsIFtmdW5jdGlvbiAoYikgewogICAgICAgIHJldHVybiBiLmlkOwogICAgICB9XSwgWydhc2MnXSk7CiAgICB9CiAgfSwKICB3YXRjaDogewogICAgaW1wb3J0X2ZpbGU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9pbXBvcnRfZmlsZSA9IF9hc3luY1RvR2VuZXJhdG9yKHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoX25ld192YWx1ZSwgX29sZF92YWx1ZSkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGlmICghKHRoaXMuaW1wb3J0X2ZpbGUgIT0gbnVsbCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnSW1wb3J0aW5nIGZpbGUnKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAyOwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDU7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pbXBvcnRCdWNrZXRzKHRoaXMuaW1wb3J0X2ZpbGUpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnSW1wb3J0IHN1Y2Nlc3NmdWwnKTsKICAgICAgICAgICAgICAgIHRoaXMuaW1wb3J0X2Vycm9yID0gbnVsbDsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMzsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gOTsKICAgICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbImNhdGNoIl0oMik7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnSW1wb3J0IGZhaWxlZCcpOwogICAgICAgICAgICAgICAgdGhpcy5pbXBvcnRfZXJyb3IgPSAnSW1wb3J0IGZhaWxlZCwgc2VlIGF3LXNlcnZlciBsb2dzIGZvciBtb3JlIGluZm8nOwoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE1OwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdidWNrZXRzL2xvYWRCdWNrZXRzJyk7CgogICAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgICB0aGlzLmltcG9ydF9maWxlID0gbnVsbDsKCiAgICAgICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUsIHRoaXMsIFtbMiwgOV1dKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gaW1wb3J0X2ZpbGUoX3gsIF94MikgewogICAgICAgIHJldHVybiBfaW1wb3J0X2ZpbGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGltcG9ydF9maWxlOwogICAgfSgpCiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgX21vdW50ZWQgPSBfYXN5bmNUb0dlbmVyYXRvcihyZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI7CiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdidWNrZXRzL2Vuc3VyZUJ1Y2tldHMnKTsKCiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUyLCB0aGlzKTsKICAgIH0pKTsKCiAgICBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgICByZXR1cm4gX21vdW50ZWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0KCiAgICByZXR1cm4gbW91bnRlZDsKICB9KCksCiAgbWV0aG9kczogewogICAgb3BlbkRlbGV0ZUJ1Y2tldE1vZGFsOiBmdW5jdGlvbiBvcGVuRGVsZXRlQnVja2V0TW9kYWwoYnVja2V0SWQpIHsKICAgICAgdGhpcy5kZWxldGVfYnVja2V0X3NlbGVjdGVkID0gYnVja2V0SWQ7CiAgICAgIHRoaXMuJHJvb3QuJGVtaXQoJ2J2OjpzaG93Ojptb2RhbCcsICdkZWxldGUtbW9kYWwnKTsKICAgIH0sCiAgICBkZWxldGVCdWNrZXQ6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9kZWxldGVCdWNrZXQgPSBfYXN5bmNUb0dlbmVyYXRvcihyZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMyhidWNrZXRJZCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2J1Y2tldHMvZGVsZXRlQnVja2V0JywgewogICAgICAgICAgICAgICAgICBidWNrZXRJZDogYnVja2V0SWQKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCdidjo6aGlkZTo6bW9kYWwnLCAnZGVsZXRlLW1vZGFsJyk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMywgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGRlbGV0ZUJ1Y2tldChfeDMpIHsKICAgICAgICByZXR1cm4gX2RlbGV0ZUJ1Y2tldC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gZGVsZXRlQnVja2V0OwogICAgfSgpLAogICAgaW1wb3J0QnVja2V0czogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2ltcG9ydEJ1Y2tldHMgPSBfYXN5bmNUb0dlbmVyYXRvcihyZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNChpbXBvcnRGaWxlKSB7CiAgICAgICAgdmFyIGZvcm1EYXRhLCBoZWFkZXJzOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOwogICAgICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdidWNrZXRzLmpzb24nLCBpbXBvcnRGaWxlKTsKICAgICAgICAgICAgICAgIGhlYWRlcnMgPSB7CiAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnbXVsdGlwYXJ0L2Zvcm0tZGF0YScKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgicmV0dXJuIiwgdGhpcy4kYXcucmVxLnBvc3QoJy8wL2ltcG9ydCcsIGZvcm1EYXRhLCB7CiAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnMKICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU0LCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gaW1wb3J0QnVja2V0cyhfeDQpIHsKICAgICAgICByZXR1cm4gX2ltcG9ydEJ1Y2tldHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGltcG9ydEJ1Y2tldHM7CiAgICB9KCkKICB9Cn07"},{"version":3,"sources":["Buckets.vue"],"names":[],"mappings":";;;AAsGA,OAAA,yBAAA;AACA,OAAA,4BAAA;AACA,OAAA,+BAAA;AAGA,eAAA;AACA,EAAA,IAAA,EAAA,SADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,WAAA,EAAA,IADA;AAEA,MAAA,YAAA,EAAA,IAFA;AAGA,MAAA,sBAAA,EAAA,IAHA;AAIA,MAAA,MAAA,EAAA,CACA;AAAA,QAAA,GAAA,EAAA,IAAA;AAAA,QAAA,KAAA,EAAA,WAAA;AAAA,QAAA,QAAA,EAAA;AAAA,OADA,EAEA;AAAA,QAAA,GAAA,EAAA,UAAA;AAAA,QAAA,QAAA,EAAA;AAAA,OAFA,EAGA;AAAA,QAAA,GAAA,EAAA,cAAA;AAAA,QAAA,KAAA,EAAA,SAAA;AAAA,QAAA,QAAA,EAAA;AAAA,OAHA,EAIA;AAAA,QAAA,GAAA,EAAA,SAAA;AAAA,QAAA,KAAA,EAAA;AAAA,OAJA;AAJA,KAAA;AAWA,GAdA;AAeA,EAAA,QAAA,EAAA;AACA,IAAA,OAAA,EAAA,mBAAA;AACA,aAAA,SAAA,KAAA,MAAA,CAAA,KAAA,CAAA,OAAA,CAAA,OAAA,EAAA,CAAA,UAAA,CAAA;AAAA,eAAA,CAAA,CAAA,EAAA;AAAA,OAAA,CAAA,EAAA,CAAA,KAAA,CAAA,CAAA;AACA;AAHA,GAfA;AAoBA,EAAA,KAAA,EAAA;AACA,IAAA,WAAA;AAAA,mEAAA,iBAAA,UAAA,EAAA,UAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACA,KAAA,WAAA,IAAA,IADA;AAAA;AAAA;AAAA;;AAEA,gBAAA,OAAA,CAAA,GAAA,CAAA,gBAAA;AAFA;AAAA;AAAA,uBAIA,KAAA,aAAA,CAAA,KAAA,WAAA,CAJA;;AAAA;AAKA,gBAAA,OAAA,CAAA,GAAA,CAAA,mBAAA;AACA,qBAAA,YAAA,GAAA,IAAA;AANA;AAAA;;AAAA;AAAA;AAAA;AAQA,gBAAA,OAAA,CAAA,GAAA,CAAA,eAAA;AAEA,qBAAA,YAAA,GAAA,iDAAA;;AAVA;AAAA;AAAA,uBAcA,KAAA,MAAA,CAAA,QAAA,CAAA,qBAAA,CAdA;;AAAA;AAeA,qBAAA,WAAA,GAAA,IAAA;;AAfA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AADA,GApBA;AAwCA,EAAA,OAAA;AAAA,6DAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACA,KAAA,MAAA,CAAA,QAAA,CAAA,uBAAA,CADA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA,KAxCA;AA2CA,EAAA,OAAA,EAAA;AACA,IAAA,qBAAA,EAAA,+BAAA,QAAA,EAAA;AACA,WAAA,sBAAA,GAAA,QAAA;AACA,WAAA,KAAA,CAAA,KAAA,CAAA,iBAAA,EAAA,cAAA;AACA,KAJA;AAKA,IAAA,YAAA;AAAA,oEAAA,kBAAA,QAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACA,KAAA,MAAA,CAAA,QAAA,CAAA,sBAAA,EAAA;AAAA,kBAAA,QAAA,EAAA;AAAA,iBAAA,CADA;;AAAA;AAEA,qBAAA,KAAA,CAAA,KAAA,CAAA,iBAAA,EAAA,cAAA;;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA,OALA;AASA,IAAA,aAAA;AAAA,qEAAA,kBAAA,UAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,gBAAA,QADA,GACA,IAAA,QAAA,EADA;AAEA,gBAAA,QAAA,CAAA,MAAA,CAAA,cAAA,EAAA,UAAA;AACA,gBAAA,OAHA,GAGA;AAAA,kCAAA;AAAA,iBAHA;AAAA,kDAIA,KAAA,GAAA,CAAA,GAAA,CAAA,IAAA,CAAA,WAAA,EAAA,QAAA,EAAA;AAAA,kBAAA,OAAA,EAAA;AAAA,iBAAA,CAJA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AATA;AA3CA,CAAA","sourcesContent":["<template lang=\"pug\">\ndiv\n  h2 Buckets\n\n  b-alert(show)\n    | Are you looking to collect more data? Check out #[a(href=\"https://activitywatch.readthedocs.io/en/latest/watchers.html\") the docs] for more watchers.\n\n  b-table(hover, small, :items=\"buckets\", :fields=\"fields\", responsive=\"md\", sort-by=\"last_updated\", :sort-desc=\"true\")\n    template(v-slot:cell(id)=\"data\")\n      small\n        | {{ data.item.id }}\n    template(v-slot:cell(hostname)=\"data\")\n      small\n        | {{ data.item.hostname }}\n    template(v-slot:cell(last_updated)=\"data\")\n      // aw-server-python\n      small(v-if=\"data.item.last_updated\")\n        | {{ data.item.last_updated | friendlytime }}\n      // aw-server-rust\n      small(v-if=\"data.item.metadata && data.item.metadata.end\")\n        | {{ data.item.metadata.end | friendlytime }}\n    template(v-slot:cell(actions)=\"data\")\n      b-button-toolbar.float-right\n        b-button-group(size=\"sm\", class=\"mx-1\")\n          b-button(variant=\"primary\", :to=\"'/buckets/' + data.item.id\")\n            icon(name=\"folder-open\").d-none.d-md-inline-block\n            | Open\n          b-dropdown(variant=\"outline-secondary\", size=\"sm\", text=\"More\")\n            b-dropdown-item(\n                       :href=\"$aw.baseURL + '/api/0/buckets/' + data.item.id + '/export'\",\n                       :download=\"'aw-bucket-export-' + data.item.id + '.json'\",\n                       title=\"Export bucket to JSON\",\n                       variant=\"secondary\")\n                icon(name=\"download\")\n                | Export as JSON\n            b-dropdown-divider\n            b-dropdown-item-button(@click=\"openDeleteBucketModal(data.item.id)\",\n                     title=\"Delete this bucket permanently\",\n                     variant=\"danger\")\n              | #[icon(name=\"trash\")] Delete bucket\n\n  b-modal(id=\"delete-modal\", title=\"Danger!\", centered, hide-footer)\n    | Are you sure you want to delete bucket \"{{delete_bucket_selected}}\"?\n    br\n    br\n    b This is permanent and cannot be undone!\n    hr\n    div.float-right\n      b-button.mx-2(@click=\"$root.$emit('bv::hide::modal','delete-modal')\")\n        | Cancel\n      b-button(@click=\"deleteBucket(delete_bucket_selected)\", variant=\"danger\")\n        | Confirm\n\n  h3 Import and export buckets\n\n  b-card-group.deck\n    b-card(header=\"Import buckets\")\n      b-alert(v-if=\"import_error\" show variant=\"danger\" dismissable)\n        | {{ import_error }}\n      b-form-file(v-model=\"import_file\"\n                  placeholder=\"Choose a file or drop file here...\"\n                  drop-placeholder=\"Drop file here...\")\n      // TODO: This spinner could be placed in a more suitable place\n      div(v-if=\"import_file\" class=\"spinner-border\" role=\"status\")\n      span\n        | A valid file to import is a JSON file from either an export of a single bucket or an export from multiple buckets.\n        | If there are buckets with the same name the import will fail\n    b-card(header=\"Export buckets\")\n      b-button(:href=\"$aw.baseURL + '/api/0/export'\",\n               :download=\"'aw-bucket-export.json'\",\n               title=\"Export bucket to JSON\",\n               variant=\"outline-secondary\")\n        icon(name=\"download\")\n        | Export all buckets as JSON\n\n</template>\n\n<style lang=\"scss\">\n// This won't work if scoped\n.bucket-card {\n  .card-header,\n  .card-footer {\n    padding: 0.5em 0.75em 0.5em 0.75em;\n  }\n\n  .card-body {\n    padding: 0.5em;\n  }\n}\n</style>\n\n<style scoped lang=\"scss\">\n.bucket-card {\n  margin-bottom: 1em;\n}\n\n.bucket-last-updated {\n  color: #666;\n}\n</style>\n\n<script>\nimport 'vue-awesome/icons/trash';\nimport 'vue-awesome/icons/download';\nimport 'vue-awesome/icons/folder-open';\nimport _ from 'lodash';\n\nexport default {\n  name: 'Buckets',\n  data() {\n    return {\n      import_file: null,\n      import_error: null,\n      delete_bucket_selected: null,\n      fields: [\n        { key: 'id', label: 'Bucket ID', sortable: true },\n        { key: 'hostname', sortable: true },\n        { key: 'last_updated', label: 'Updated', sortable: true },\n        { key: 'actions', label: '' },\n      ],\n    };\n  },\n  computed: {\n    buckets: function () {\n      return _.orderBy(this.$store.state.buckets.buckets, [b => b.id], ['asc']);\n    },\n  },\n  watch: {\n    import_file: async function (_new_value, _old_value) {\n      if (this.import_file != null) {\n        console.log('Importing file');\n        try {\n          await this.importBuckets(this.import_file);\n          console.log('Import successful');\n          this.import_error = null;\n        } catch (err) {\n          console.log('Import failed');\n          // TODO: Make aw-server report error message so it can be shown in the web-ui\n          this.import_error = 'Import failed, see aw-server logs for more info';\n        }\n        // We need to reload buckets even if we fail because imports can be partial\n        // (first bucket succeeds, second fails for example when importing multiple)\n        await this.$store.dispatch('buckets/loadBuckets');\n        this.import_file = null;\n      }\n    },\n  },\n  mounted: async function () {\n    await this.$store.dispatch('buckets/ensureBuckets');\n  },\n  methods: {\n    openDeleteBucketModal: function (bucketId) {\n      this.delete_bucket_selected = bucketId;\n      this.$root.$emit('bv::show::modal', 'delete-modal');\n    },\n    deleteBucket: async function (bucketId) {\n      await this.$store.dispatch('buckets/deleteBucket', { bucketId });\n      this.$root.$emit('bv::hide::modal', 'delete-modal');\n    },\n    importBuckets: async function (importFile) {\n      const formData = new FormData();\n      formData.append('buckets.json', importFile);\n      const headers = { 'Content-Type': 'multipart/form-data' };\n      return this.$aw.req.post('/0/import', formData, { headers });\n    },\n  },\n};\n</script>\n"],"sourceRoot":"src/views"}]}