{"remainingRequest":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/thread-loader/dist/cjs.js!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/babel-loader/lib/index.js!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/eslint-loader/index.js??ref--12-0!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/src/visualizations/sunburst-clock.js","dependencies":[{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/src/visualizations/sunburst-clock.js","mtime":1622212604101},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5yZXZlcnNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc29ydCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yIjsKCnZhciBkMyA9IHJlcXVpcmUoJ2QzJyk7Cgp2YXIgbW9tZW50ID0gcmVxdWlyZSgnbW9tZW50Jyk7CgppbXBvcnQgeyBzZWNvbmRzX3RvX2R1cmF0aW9uIH0gZnJvbSAnLi4vdXRpbC90aW1lLmpzJzsKCnZhciBjb2xvciA9IHJlcXVpcmUoJy4uL3V0aWwvY29sb3InKTsKCnZhciB3aWR0aCA9IDc1MDsKdmFyIGhlaWdodCA9IDYwMDsKdmFyIHJhZGl1cyA9IE1hdGgubWluKHdpZHRoLCBoZWlnaHQpIC8gMjsKdmFyIGxlZ2VuZERhdGEgPSB7CiAgYWZrOiBjb2xvci5nZXRDb2xvckZyb21TdHJpbmcoJ2FmaycpLAogICdub3QtYWZrJzogY29sb3IuZ2V0Q29sb3JGcm9tU3RyaW5nKCdub3QtYWZrJyksCiAgaGliZXJuYXRpbmc6IGNvbG9yLmdldENvbG9yRnJvbVN0cmluZygnaGliZXJuYXRpbmcnKQp9Owp2YXIgcm9vdEVsOwp2YXIgdmlzOwp2YXIgcGFydGl0aW9uOwp2YXIgYXJjOwoKZnVuY3Rpb24gZHJhd0xlZ2VuZCgpIHsKICB2YXIgbGkgPSB7CiAgICB3OiA3NSwKICAgIGg6IDMwLAogICAgczogMywKICAgIHI6IDMKICB9OwogIHZhciBsZWdlbmQgPSBkMy5zZWxlY3QoJy5sZWdlbmQnKS5hcHBlbmQoJ3N2ZzpzdmcnKS5hdHRyKCd3aWR0aCcsIGxpLncpLmF0dHIoJ2hlaWdodCcsIGQzLmtleXMobGVnZW5kRGF0YSkubGVuZ3RoICogKGxpLmggKyBsaS5zKSk7CiAgdmFyIGcgPSBsZWdlbmQuc2VsZWN0QWxsKCdnJykuZGF0YShkMy5lbnRyaWVzKGxlZ2VuZERhdGEpKS5lbnRlcigpLmFwcGVuZCgnc3ZnOmcnKS5hdHRyKCd0cmFuc2Zvcm0nLCBmdW5jdGlvbiAoZCwgaSkgewogICAgcmV0dXJuICd0cmFuc2xhdGUoMCwnICsgaSAqIChsaS5oICsgbGkucykgKyAnKSc7CiAgfSk7CiAgZy5hcHBlbmQoJ3N2ZzpyZWN0JykuYXR0cigncngnLCBsaS5yKS5hdHRyKCdyeScsIGxpLnIpLmF0dHIoJ3dpZHRoJywgbGkudykuYXR0cignaGVpZ2h0JywgbGkuaCkuc3R5bGUoJ2ZpbGwnLCBmdW5jdGlvbiAoZCkgewogICAgcmV0dXJuIGQudmFsdWU7CiAgfSk7CiAgZy5hcHBlbmQoJ3N2Zzp0ZXh0JykuYXR0cigneCcsIGxpLncgLyAyKS5hdHRyKCd5JywgbGkuaCAvIDIpLmF0dHIoJ2R5JywgJzAuMzVlbScpLmF0dHIoJ3RleHQtYW5jaG9yJywgJ21pZGRsZScpLnRleHQoZnVuY3Rpb24gKGQpIHsKICAgIHJldHVybiBkLmtleTsKICB9KTsKfQoKZnVuY3Rpb24gZHJhd0Nsb2NrVGljayhhKSB7CiAgdmFyIHhuID0gTWF0aC5jb3MoYSk7CiAgdmFyIHluID0gTWF0aC5zaW4oYSk7CiAgdmlzLmFwcGVuZCgnbGluZScpLmF0dHIoJ3gxJywgMTcwICogeG4pLmF0dHIoJ3kxJywgMTcwICogeW4pLmF0dHIoJ3gyJywgMTU1ICogeG4pLmF0dHIoJ3kyJywgMTU1ICogeW4pLnN0eWxlKCdzdHJva2UnLCAnI0NDQycpLnN0eWxlKCdzdHJva2Utd2lkdGgnLCAxKTsKfQoKZnVuY3Rpb24gZHJhd0Nsb2NrKGgsIG0sIHRleHQpIHsKICB2YXIgYSA9IDIgKiBNYXRoLlBJICogKGggLyAyNCArIG0gLyAyNCAvIDYwKSAtIDEgLyAyICogTWF0aC5QSTsKICBkcmF3Q2xvY2tUaWNrKGEpOwogIHZhciB4biA9IE1hdGguY29zKGEpOwogIHZhciB5biA9IE1hdGguc2luKGEpOwogIHZpcy5hcHBlbmQoJ3RleHQnKS50ZXh0KHRleHQgfHwgbW9tZW50KHsKICAgIGhvdXJzOiBoCiAgfSkuZm9ybWF0KCdISDptbScpKS5hdHRyKCd0ZXh0LWFuY2hvcicsICdtaWRkbGUnKS5hdHRyKCdmb250LXNpemUnLCAnMS4yZW0nKS5zdHlsZSgnZmlsbCcsICcjOTk5JykuYXR0cigneCcsIDEzMCAqIHhuKS5hdHRyKCd5JywgNSArIDE0MCAqIHluKTsKfQoKZnVuY3Rpb24gbW91c2VjbGljayhkKSB7CiAgY29uc29sZS5sb2coJ0NsaWNrZWQnKTsKICBjb25zb2xlLmxvZyhkKTsKfQoKZnVuY3Rpb24gc2hvd0luZm8oZCkgewogIHZhciBob3ZlckVsID0gZDMuc2VsZWN0KCcuZXhwbGFuYXRpb24gPiAuaG92ZXInKTsKICB2YXIgbSA9IG1vbWVudChkLmRhdGEudGltZXN0YW1wKTsKICBob3ZlckVsLnNlbGVjdCgnLmRhdGUnKS50ZXh0KG0uZm9ybWF0KCdZWVlZLU1NLUREJykpOwogIGhvdmVyRWwuc2VsZWN0KCcudGltZScpLnRleHQobS5mb3JtYXQoJ0hIOm1tOnNzJykpOwogIHZhciBkdXJhdGlvblN0cmluZyA9IHNlY29uZHNfdG9fZHVyYXRpb24oZC5kYXRhLmR1cmF0aW9uKTsKICBob3ZlckVsLnNlbGVjdCgnLmR1cmF0aW9uJykudGV4dChkdXJhdGlvblN0cmluZyk7CiAgaG92ZXJFbC5zZWxlY3QoJy50aXRsZScpLnRleHQoZC5kYXRhLmRhdGEuYXBwIHx8IGQuZGF0YS5kYXRhLnN0YXR1cyk7CiAgaG92ZXJFbC5zZWxlY3QoJy5kYXRhJykudGV4dChkLmRhdGEuZGF0YS50aXRsZSB8fCAnJyk7CiAgZDMuc2VsZWN0KCcuZXhwbGFuYXRpb24gPiAuYmFzZScpLnN0eWxlKCdkaXNwbGF5JywgJ25vbmUnKTsKICBob3ZlckVsLnN0eWxlKCd2aXNpYmlsaXR5JywgJycpOwp9CgpmdW5jdGlvbiBtb3VzZW92ZXIoZCkgewogIHNob3dJbmZvKGQpOwogIHZhciBzZXF1ZW5jZUFycmF5ID0gZC5hbmNlc3RvcnMoKS5yZXZlcnNlKCk7CiAgc2VxdWVuY2VBcnJheS5zaGlmdCgpOwogIHJvb3RFbC5zZWxlY3RBbGwoJ3BhdGgnKS5zdHlsZSgnb3BhY2l0eScsIDAuNSk7CiAgcm9vdEVsLnNlbGVjdEFsbCgncGF0aCcpLmZpbHRlcihmdW5jdGlvbiAobm9kZSkgewogICAgcmV0dXJuIHNlcXVlbmNlQXJyYXkuaW5kZXhPZihub2RlKSA+PSAwOwogIH0pLnN0eWxlKCdvcGFjaXR5JywgMSk7Cn0KCmZ1bmN0aW9uIG1vdXNlbGVhdmUoKSB7CiAgcm9vdEVsLnNlbGVjdEFsbCgncGF0aCcpLm9uKCdtb3VzZW92ZXInLCBudWxsKTsKICByb290RWwuc2VsZWN0QWxsKCdwYXRoJykudHJhbnNpdGlvbigpLmR1cmF0aW9uKDEwMCkuc3R5bGUoJ29wYWNpdHknLCAxKS5vbignZW5kJywgZnVuY3Rpb24gKCkgewogICAgZDMuc2VsZWN0KHRoaXMpLm9uKCdtb3VzZW92ZXInLCBtb3VzZW92ZXIpOwogIH0pOwogIHJvb3RFbC5zZWxlY3QoJy5leHBsYW5hdGlvbiA+IC5iYXNlJykuc3R5bGUoJ2Rpc3BsYXknLCAnJyk7CiAgcm9vdEVsLnNlbGVjdCgnLmV4cGxhbmF0aW9uID4gLmhvdmVyJykuc3R5bGUoJ3Zpc2liaWxpdHknLCAnaGlkZGVuJyk7Cn0KCmZ1bmN0aW9uIGluaXRpYWxpemVCcmVhZGNydW1iVHJhaWwoKSB7CiAgdmFyIHRyYWlsID0gZDMuc2VsZWN0KCcuc2VxdWVuY2UnKS5hcHBlbmQoJ3N2ZzpzdmcnKS5hdHRyKCd3aWR0aCcsIHdpZHRoKS5hdHRyKCdoZWlnaHQnLCA1MCkuYXR0cignaWQnLCAndHJhaWwnKTsKICB0cmFpbC5hcHBlbmQoJ3N2Zzp0ZXh0JykuYXR0cignaWQnLCAnZW5kbGFiZWwnKS5zdHlsZSgnZmlsbCcsICcjMDAwJyk7Cn0KCmZ1bmN0aW9uIGNyZWF0ZShlbCkgewogIHJvb3RFbCA9IGQzLnNlbGVjdCgnLmNoYXJ0Jyk7CiAgcm9vdEVsLnNlbGVjdEFsbCgnc3ZnJykucmVtb3ZlKCk7CiAgdmlzID0gcm9vdEVsLmFwcGVuZCgnc3ZnOnN2ZycpLmF0dHIoJ3dpZHRoJywgd2lkdGgpLmF0dHIoJ2hlaWdodCcsIGhlaWdodCkuYXBwZW5kKCdzdmc6ZycpLmF0dHIoJ2lkJywgJ2NvbnRhaW5lcicpLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoJyArIHdpZHRoIC8gMiArICcsJyArIGhlaWdodCAvIDIgKyAnKScpOwogIGRyYXdMZWdlbmQoZWwpOwogIHBhcnRpdGlvbiA9IGQzLnBhcnRpdGlvbigpLnNpemUoWzIgKiBNYXRoLlBJLCByYWRpdXMgKiByYWRpdXNdKTsKICBhcmMgPSBkMy5hcmMoKS5zdGFydEFuZ2xlKGZ1bmN0aW9uIChkKSB7CiAgICByZXR1cm4gZC54MDsKICB9KS5lbmRBbmdsZShmdW5jdGlvbiAoZCkgewogICAgcmV0dXJuIGQueDE7CiAgfSkuaW5uZXJSYWRpdXMoZnVuY3Rpb24gKGQpIHsKICAgIHJldHVybiBNYXRoLnNxcnQoZC55MCk7CiAgfSkub3V0ZXJSYWRpdXMoZnVuY3Rpb24gKGQpIHsKICAgIHJldHVybiBNYXRoLnNxcnQoZC55MSk7CiAgfSk7Cn0KCmZ1bmN0aW9uIHVwZGF0ZShlbCwganNvbikgewogIGluaXRpYWxpemVCcmVhZGNydW1iVHJhaWwoKTsKICBlbC5xdWVyeVNlbGVjdG9yKCcjY29udGFpbmVyJykuaW5uZXJIVE1MID0gJyc7CiAgdmlzLmFwcGVuZCgnc3ZnOmNpcmNsZScpLmF0dHIoJ3InLCByYWRpdXMpLnN0eWxlKCdvcGFjaXR5JywgMCk7CiAgdmFyIHJvb3QgPSBkMy5oaWVyYXJjaHkoanNvbik7CiAgdmFyIG5vZGVzID0gcGFydGl0aW9uKHJvb3QpOwogIHZhciBtb2RlX2Nsb2NrID0gdHJ1ZTsKCiAgaWYgKG1vZGVfY2xvY2spIHsKICAgIHZhciBzaG93X3dob2xlX2RheSA9IHRydWU7CiAgICB2YXIgcm9vdF9zdGFydCA9IG1vbWVudChqc29uLnRpbWVzdGFtcCk7CiAgICB2YXIgcm9vdF9lbmQgPSBtb21lbnQoanNvbi50aW1lc3RhbXApLmFkZChqc29uLmR1cmF0aW9uLCAnc2Vjb25kcycpOwoKICAgIGlmIChzaG93X3dob2xlX2RheSkgewogICAgICByb290X3N0YXJ0ID0gcm9vdF9zdGFydC5zdGFydE9mKCdkYXknKTsKICAgICAgcm9vdF9lbmQgPSByb290X3N0YXJ0LmNsb25lKCkuZW5kT2YoJ2RheScpOwogICAgICBkcmF3Q2xvY2soMCwgMCk7CiAgICAgIGRyYXdDbG9jayg2LCAwKTsKICAgICAgZHJhd0Nsb2NrKDEyLCAwKTsKICAgICAgZHJhd0Nsb2NrKDE4LCAwKTsKICAgICAgdmFyIG5vdyA9IG1vbWVudCgpOwogICAgICBkcmF3Q2xvY2sobm93LmhvdXIoKSwgbm93Lm1pbnV0ZSgpLCAnTm93Jyk7CiAgICB9CgogICAgbm9kZXMgPSBub2Rlcy5lYWNoKGZ1bmN0aW9uIChkKSB7CiAgICAgIHZhciBsb2Nfc3RhcnRfc2VjID0gbW9tZW50KGQuZGF0YS50aW1lc3RhbXApLmRpZmYocm9vdF9zdGFydCwgJ3NlY29uZHMnLCB0cnVlKTsKICAgICAgdmFyIGxvY19lbmRfc2VjID0gbW9tZW50KGQuZGF0YS50aW1lc3RhbXApLmFkZChkLmRhdGEuZHVyYXRpb24sICdzZWNvbmRzJykuZGlmZihyb290X3N0YXJ0LCAnc2Vjb25kcycsIHRydWUpOwogICAgICB2YXIgbG9jX3N0YXJ0ID0gTWF0aC5tYXgoMCwgbG9jX3N0YXJ0X3NlYyAvICgocm9vdF9lbmQgLSByb290X3N0YXJ0KSAvIDEwMDApKTsKICAgICAgdmFyIGxvY19lbmQgPSBNYXRoLm1pbigxLCBsb2NfZW5kX3NlYyAvICgocm9vdF9lbmQgLSByb290X3N0YXJ0KSAvIDEwMDApKTsKICAgICAgZC54MCA9IDIgKiBNYXRoLlBJICogbG9jX3N0YXJ0OwogICAgICBkLngxID0gMiAqIE1hdGguUEkgKiBsb2NfZW5kOwogICAgfSkuZGVzY2VuZGFudHMoKTsKICB9IGVsc2UgewogICAgcm9vdCA9IHJvb3Quc3VtKGZ1bmN0aW9uIChkKSB7CiAgICAgIHJldHVybiBkLmR1cmF0aW9uOwogICAgfSkuc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoYS5kYXRhLmRhdGEpLmxvY2FsZUNvbXBhcmUoSlNPTi5zdHJpbmdpZnkoYi5kYXRhLmRhdGEpKTsKICAgIH0pOwogICAgbm9kZXMgPSBub2Rlcy5kZXNjZW5kYW50cygpOwogIH0KCiAgbm9kZXMgPSBub2Rlcy5maWx0ZXIoZnVuY3Rpb24gKGQpIHsKICAgIHZhciB0aHJlc2hvbGQgPSAwLjAwMTsKICAgIHJldHVybiBkLngxIC0gZC54MCA+IHRocmVzaG9sZDsKICB9KTsKICB2aXMuZGF0YShbanNvbl0pLnNlbGVjdEFsbCgncGF0aCcpLmRhdGEobm9kZXMpLmVudGVyKCkuYXBwZW5kKCdzdmc6cGF0aCcpLmF0dHIoJ2Rpc3BsYXknLCBmdW5jdGlvbiAoZCkgewogICAgcmV0dXJuIGQuZGVwdGggPyBudWxsIDogJ25vbmUnOwogIH0pLmF0dHIoJ2QnLCBhcmMpLmF0dHIoJ2ZpbGwtcnVsZScsICdldmVub2RkJykuc3R5bGUoJ2ZpbGwnLCBmdW5jdGlvbiAoZCkgewogICAgcmV0dXJuIGNvbG9yLmdldENvbG9yRnJvbVN0cmluZyhkLmRhdGEuZGF0YS5zdGF0dXMgfHwgZC5kYXRhLmRhdGEuYXBwKTsKICB9KS5zdHlsZSgnb3BhY2l0eScsIDEpLm9uKCdtb3VzZW92ZXInLCBtb3VzZW92ZXIpLm9uKCdjbGljaycsIG1vdXNlY2xpY2spOwogIGQzLnNlbGVjdCgnI2NvbnRhaW5lcicpLm9uKCdtb3VzZWxlYXZlJywgbW91c2VsZWF2ZSk7Cn0KCmV4cG9ydCBkZWZhdWx0IHsKICBjcmVhdGU6IGNyZWF0ZSwKICB1cGRhdGU6IHVwZGF0ZQp9Ow=="},{"version":3,"sources":["/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/src/visualizations/sunburst-clock.js"],"names":["d3","require","moment","seconds_to_duration","color","width","height","radius","Math","min","legendData","afk","getColorFromString","hibernating","rootEl","vis","partition","arc","drawLegend","li","w","h","s","r","legend","select","append","attr","keys","length","g","selectAll","data","entries","enter","d","i","style","value","text","key","drawClockTick","a","xn","cos","yn","sin","drawClock","m","PI","hours","format","mouseclick","console","log","showInfo","hoverEl","timestamp","durationString","duration","app","status","title","mouseover","sequenceArray","ancestors","reverse","shift","filter","node","indexOf","mouseleave","on","transition","initializeBreadcrumbTrail","trail","create","el","remove","size","startAngle","x0","endAngle","x1","innerRadius","sqrt","y0","outerRadius","y1","update","json","querySelector","innerHTML","root","hierarchy","nodes","mode_clock","show_whole_day","root_start","root_end","add","startOf","clone","endOf","now","hour","minute","each","loc_start_sec","diff","loc_end_sec","loc_start","max","loc_end","descendants","sum","sort","b","JSON","stringify","localeCompare","threshold","depth"],"mappings":"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","sourcesContent":["// Original source: https://bl.ocks.org/kerryrodden/7090426\n//\n// Copyright 2013 Google Inc. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nconst d3 = require('d3');\nconst moment = require('moment');\n\nimport { seconds_to_duration } from '../util/time.js';\nconst color = require('../util/color');\n\n// Dimensions of sunburst.\nconst width = 750;\nconst height = 600;\nconst radius = Math.min(width, height) / 2;\n\nconst legendData = {\n  afk: color.getColorFromString('afk'),\n  'not-afk': color.getColorFromString('not-afk'),\n  hibernating: color.getColorFromString('hibernating'),\n};\n\nlet rootEl; // The root DOM node of the graph as a d3 object\nlet vis; // The root SVG node of the graph as a d3 object\nlet partition;\nlet arc;\n\nfunction drawLegend() {\n  // Dimensions of legend item: width, height, spacing, radius of rounded rect.\n  const li = {\n    w: 75,\n    h: 30,\n    s: 3,\n    r: 3,\n  };\n\n  const legend = d3\n    .select('.legend')\n    .append('svg:svg')\n    .attr('width', li.w)\n    .attr('height', d3.keys(legendData).length * (li.h + li.s));\n\n  const g = legend\n    .selectAll('g')\n    .data(d3.entries(legendData))\n    .enter()\n    .append('svg:g')\n    .attr('transform', function (d, i) {\n      return 'translate(0,' + i * (li.h + li.s) + ')';\n    });\n\n  g.append('svg:rect')\n    .attr('rx', li.r)\n    .attr('ry', li.r)\n    .attr('width', li.w)\n    .attr('height', li.h)\n    .style('fill', function (d) {\n      return d.value;\n    });\n\n  g.append('svg:text')\n    .attr('x', li.w / 2)\n    .attr('y', li.h / 2)\n    .attr('dy', '0.35em')\n    .attr('text-anchor', 'middle')\n    .text(function (d) {\n      return d.key;\n    });\n}\n\nfunction drawClockTick(a) {\n  const xn = Math.cos(a);\n  const yn = Math.sin(a);\n\n  vis\n    .append('line')\n    .attr('x1', 170 * xn)\n    .attr('y1', 170 * yn)\n    .attr('x2', 155 * xn)\n    .attr('y2', 155 * yn)\n    .style('stroke', '#CCC')\n    .style('stroke-width', 1);\n}\n\nfunction drawClock(h, m, text) {\n  const a = 2 * Math.PI * (h / 24 + m / 24 / 60) - (1 / 2) * Math.PI;\n  drawClockTick(a);\n\n  const xn = Math.cos(a);\n  const yn = Math.sin(a);\n\n  vis\n    .append('text')\n    .text(text || moment({ hours: h }).format('HH:mm'))\n    .attr('text-anchor', 'middle')\n    .attr('font-size', '1.2em')\n    //.attr(\"font-weight\", \"bold\")\n    .style('fill', '#999')\n    .attr('x', 130 * xn)\n    .attr('y', 5 + 140 * yn);\n}\n\nfunction mouseclick(d) {\n  console.log('Clicked');\n  console.log(d);\n}\n\nfunction showInfo(d) {\n  const hoverEl = d3.select('.explanation > .hover');\n\n  const m = moment(d.data.timestamp);\n  hoverEl.select('.date').text(m.format('YYYY-MM-DD'));\n  hoverEl.select('.time').text(m.format('HH:mm:ss'));\n\n  const durationString = seconds_to_duration(d.data.duration);\n  hoverEl.select('.duration').text(durationString);\n\n  hoverEl.select('.title').text(d.data.data.app || d.data.data.status);\n\n  hoverEl.select('.data').text(d.data.data.title || '');\n\n  d3.select('.explanation > .base').style('display', 'none');\n  hoverEl.style('visibility', '');\n}\n\n// Fade all but the current sequence, and show it in the breadcrumb trail.\nfunction mouseover(d) {\n  showInfo(d);\n\n  const sequenceArray = d.ancestors().reverse();\n  sequenceArray.shift(); // remove root node from the array\n\n  // Fade all the segments.\n  rootEl.selectAll('path').style('opacity', 0.5);\n\n  // Then highlight only those that are an ancestor of the current segment.\n  // FIXME: This currently makes all other svg paths on the page faded as well\n  rootEl\n    .selectAll('path')\n    .filter(function (node) {\n      return sequenceArray.indexOf(node) >= 0;\n    })\n    .style('opacity', 1);\n}\n\n// Restore everything to full opacity when moving off the visualization.\nfunction mouseleave() {\n  // Deactivate all segments during transition.\n  rootEl.selectAll('path').on('mouseover', null);\n\n  // Transition each segment to full opacity and then reactivate it.\n  rootEl\n    .selectAll('path')\n    .transition()\n    .duration(100)\n    .style('opacity', 1)\n    .on('end', function () {\n      d3.select(this).on('mouseover', mouseover);\n    });\n\n  rootEl.select('.explanation > .base').style('display', '');\n  rootEl.select('.explanation > .hover').style('visibility', 'hidden');\n}\n\nfunction initializeBreadcrumbTrail() {\n  // Add the svg area.\n  const trail = d3\n    .select('.sequence')\n    .append('svg:svg')\n    .attr('width', width)\n    .attr('height', 50)\n    .attr('id', 'trail');\n  // Add the label at the end, for the percentage.\n  trail.append('svg:text').attr('id', 'endlabel').style('fill', '#000');\n}\n\nfunction create(el) {\n  // Clear the svg in case we are redrawing\n  rootEl = d3.select('.chart');\n  rootEl.selectAll('svg').remove();\n\n  vis = rootEl\n    .append('svg:svg')\n    .attr('width', width)\n    .attr('height', height)\n    .append('svg:g')\n    .attr('id', 'container')\n    .attr('transform', 'translate(' + width / 2 + ',' + height / 2 + ')');\n\n  drawLegend(el);\n\n  partition = d3.partition().size([2 * Math.PI, radius * radius]);\n\n  arc = d3\n    .arc()\n    .startAngle(function (d) {\n      return d.x0;\n    })\n    .endAngle(function (d) {\n      return d.x1;\n    })\n    .innerRadius(function (d) {\n      return Math.sqrt(d.y0);\n    })\n    .outerRadius(function (d) {\n      return Math.sqrt(d.y1);\n    });\n}\n\n// Main function to draw and set up the visualization, once we have the data.\nfunction update(el, json) {\n  // Basic setup of page elements.\n  initializeBreadcrumbTrail();\n\n  el.querySelector('#container').innerHTML = '';\n\n  // Bounding circle underneath the sunburst, to make it easier to detect\n  // when the mouse leaves the parent g.\n  vis.append('svg:circle').attr('r', radius).style('opacity', 0);\n\n  // Turn the data into a d3 hierarchy and calculate the sums.\n  let root = d3.hierarchy(json);\n  let nodes = partition(root);\n\n  const mode_clock = true;\n  if (mode_clock) {\n    // TODO: Make this a checkbox in the UI\n    const show_whole_day = true;\n\n    let root_start = moment(json.timestamp);\n    let root_end = moment(json.timestamp).add(json.duration, 'seconds');\n    if (show_whole_day) {\n      root_start = root_start.startOf('day');\n      root_end = root_start.clone().endOf('day');\n\n      drawClock(0, 0);\n      drawClock(6, 0);\n      drawClock(12, 0);\n      drawClock(18, 0);\n\n      // TODO: Draw only if showing today\n      const now = moment();\n      drawClock(now.hour(), now.minute(), 'Now');\n    }\n\n    nodes = nodes\n      .each(function (d) {\n        const loc_start_sec = moment(d.data.timestamp).diff(root_start, 'seconds', true);\n        const loc_end_sec = moment(d.data.timestamp)\n          .add(d.data.duration, 'seconds')\n          .diff(root_start, 'seconds', true);\n\n        const loc_start = Math.max(0, loc_start_sec / ((root_end - root_start) / 1000));\n        const loc_end = Math.min(1, loc_end_sec / ((root_end - root_start) / 1000));\n\n        d.x0 = 2 * Math.PI * loc_start;\n        d.x1 = 2 * Math.PI * loc_end;\n      })\n      .descendants();\n  } else {\n    root = root\n      .sum(d => d.duration)\n      .sort((a, b) => JSON.stringify(a.data.data).localeCompare(JSON.stringify(b.data.data)));\n    nodes = nodes.descendants();\n  }\n\n  // For efficiency, filter nodes to keep only those large enough to see.\n  nodes = nodes.filter(function (d) {\n    // 0.005 radians = 0.29 degrees\n    // If show_whole_day:\n    //   0.0044 rad = 1min\n    //   0.0011 rad = 15s\n    const threshold = 0.001;\n    return d.x1 - d.x0 > threshold;\n  });\n\n  vis\n    .data([json])\n    .selectAll('path')\n    .data(nodes)\n    .enter()\n    .append('svg:path')\n    .attr('display', function (d) {\n      return d.depth ? null : 'none';\n    })\n    .attr('d', arc)\n    .attr('fill-rule', 'evenodd')\n    .style('fill', function (d) {\n      return color.getColorFromString(d.data.data.status || d.data.data.app);\n    })\n    .style('opacity', 1)\n    .on('mouseover', mouseover)\n    .on('click', mouseclick);\n\n  // Add the mouseleave handler to the bounding circle.\n  d3.select('#container').on('mouseleave', mouseleave);\n}\n\n// NOTE: The original version of this sunburst contained a buildHierarchy\n//       function that's not used in our version.\n\nexport default {\n  create: create,\n  update: update,\n};\n"]}]}