{"remainingRequest":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/thread-loader/dist/cjs.js!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/babel-loader/lib/index.js!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/eslint-loader/index.js??ref--12-0!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/src/visualizations/timeline-simple.js","dependencies":[{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/src/visualizations/timeline-simple.js","mtime":1622212604101},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:J3VzZSBzdHJpY3QnOwoKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsbCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnJldmVyc2UiOwoKdmFyIGQzID0gcmVxdWlyZSgnZDMnKTsKCnZhciBDb2xvciA9IHJlcXVpcmUoJ2NvbG9yJyk7Cgp2YXIgXyA9IHJlcXVpcmUoJ2xvZGFzaCcpOwoKdmFyIG1vbWVudCA9IHJlcXVpcmUoJ21vbWVudCcpOwoKaW1wb3J0IHsgZ2V0VGl0bGVBdHRyLCBnZXRDb2xvckZyb21TdHJpbmcgfSBmcm9tICcuLi91dGlsL2NvbG9yJzsKCnZhciB0aW1lID0gcmVxdWlyZSgnLi4vdXRpbC90aW1lLmpzJyk7CgpmdW5jdGlvbiBjcmVhdGUoc3ZnX2VsKSB7CiAgc3ZnX2VsLmlubmVySFRNTCA9ICcnOwogIGQzLnNlbGVjdChzdmdfZWwpLmF0dHIoJ3ZpZXdCb3gnLCAnMCAwIDEwMCA0JykuYXR0cignd2lkdGgnLCAnMTAwJScpOwp9CgpmdW5jdGlvbiBzZXRfc3RhdHVzKHN2Z19lbCwgdGV4dCkgewogIHZhciB0aW1lbGluZSA9IGQzLnNlbGVjdChzdmdfZWwpOwogIHRpbWVsaW5lLnNlbGVjdEFsbCgnKicpLnJlbW92ZSgpOwogIHRpbWVsaW5lLmFwcGVuZCgndGV4dCcpLmF0dHIoJ3gnLCAnMCcpLmF0dHIoJ3knLCAnMycpLnRleHQodGV4dCkuYXR0cignZm9udC1mYW1pbHknLCAnc2Fucy1zZXJpZicpLmF0dHIoJ2ZvbnQtc2l6ZScsICcyJykuYXR0cignZmlsbCcsICdibGFjaycpOwp9CgpmdW5jdGlvbiB1cGRhdGUoc3ZnX2VsLCBldmVudHMsIGV2ZW50X3R5cGUpIHsKICB2YXIgdGltZWxpbmUgPSBkMy5zZWxlY3Qoc3ZnX2VsKTsKICB0aW1lbGluZS5zZWxlY3RBbGwoJyonKS5yZW1vdmUoKTsKCiAgaWYgKGV2ZW50cy5sZW5ndGggPD0gMCkgewogICAgc2V0X3N0YXR1cyhzdmdfZWwsICdObyBkYXRhJyk7CiAgICByZXR1cm47CiAgfQoKICBldmVudHMgPSBfLmNsb25lKGV2ZW50cyk7CgogIF8ucmV2ZXJzZShldmVudHMpOwoKICB2YXIgZV9maXJzdCA9IF8uZmlyc3QoZXZlbnRzKTsKCiAgdmFyIGVfbGFzdCA9IF8ubGFzdChldmVudHMpOwoKICB2YXIgbV9maXJzdCA9IG1vbWVudChlX2ZpcnN0LnRpbWVzdGFtcCk7CiAgdmFyIG1fbGFzdCA9IG1vbWVudChlX2xhc3QudGltZXN0YW1wKTsKICB2YXIgdG90YWxfZHVyYXRpb24gPSAobV9sYXN0IC0gbV9maXJzdCkgLyAxMDAwICsgZV9sYXN0LmR1cmF0aW9uOwogIGNvbnNvbGUubG9nKCdGaXJzdDogJyArIG1fZmlyc3QuZm9ybWF0KCkpOwogIGNvbnNvbGUubG9nKCdMYXN0OiAnICsgbV9sYXN0LmZvcm1hdCgpKTsKICBjb25zb2xlLmxvZygnRHVyYXRpb246ICcgKyB0b3RhbF9kdXJhdGlvbik7CgogIF8uZWFjaChldmVudHMsIGZ1bmN0aW9uIChlLCBpKSB7CiAgICB2YXIgaWQgPSAndGltZWxpbmVfZXZlbnRfJyArIGk7CiAgICB2YXIgdGltZXN0YW1wID0gbW9tZW50KGUudGltZXN0YW1wKTsKICAgIHZhciBjb2xvcl9iYXNlID0gZ2V0Q29sb3JGcm9tU3RyaW5nKGdldFRpdGxlQXR0cih7CiAgICAgIHR5cGU6IGV2ZW50X3R5cGUKICAgIH0sIGUpKTsKICAgIHZhciBjb2xvcl9ob3ZlciA9IENvbG9yKGNvbG9yX2Jhc2UpLmRhcmtlbigwLjQpLmhleCgpOwogICAgdmFyIHggPSAodGltZXN0YW1wIC0gbV9maXJzdCkgLyAxMDAwIC8gdG90YWxfZHVyYXRpb247CiAgICB2YXIgd2lkdGggPSAxMDAgKiBlLmR1cmF0aW9uIC8gdG90YWxfZHVyYXRpb247CiAgICB2YXIgZWcgPSB0aW1lbGluZS5hcHBlbmQoJ2cnKS5hdHRyKCdpZCcsIGlkKS5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKCcgKyAxMDAgKiB4ICsgJywnICsgMCArICcpJyk7CiAgICB2YXIgcmVjdCA9IGVnLmFwcGVuZCgncmVjdCcpLmF0dHIoJ3dpZHRoJywgd2lkdGgpLmF0dHIoJ2hlaWdodCcsIDQpLnN0eWxlKCdmaWxsJywgY29sb3JfYmFzZSkub24oJ21vdXNlb3ZlcicsIGZ1bmN0aW9uIChkLCBqLCBuKSB7CiAgICAgIHZhciBlbGVtID0gbltqXTsKICAgICAgZWxlbS5zdHlsZS5maWxsID0gY29sb3JfaG92ZXI7CiAgICB9KS5vbignbW91c2VvdXQnLCBmdW5jdGlvbiAoZCwgaiwgbikgewogICAgICB2YXIgZWxlbSA9IG5bal07CiAgICAgIGVsZW0uc3R5bGUuZmlsbCA9IGNvbG9yX2Jhc2U7CiAgICB9KTsKICAgIHJlY3QuYXBwZW5kKCd0aXRsZScpLnRleHQodGltZXN0YW1wLmZvcm1hdCgpICsgJ1xuJyArICdEdXJhdGlvbjogJyArIHRpbWUuc2Vjb25kc190b19kdXJhdGlvbihlLmR1cmF0aW9uKSArICdcbicgKyBKU09OLnN0cmluZ2lmeShlLmRhdGEpKTsKCiAgICBpZiAoZS5kdXJhdGlvbiA+IDAuMDUgKiB0b3RhbF9kdXJhdGlvbikgewogICAgICBlZy5hcHBlbmQoJ3RleHQnKS5hdHRyKCdmb250LXNpemUnLCAyKS5hdHRyKCd4JywgMSkuYXR0cigneScsIDIuNSkuYXR0cigncG9pbnRlci1ldmVudHMnLCAnbm9uZScpLnRleHQoZ2V0VGl0bGVBdHRyKHsKICAgICAgICB0eXBlOiBldmVudF90eXBlCiAgICAgIH0sIGUpKTsKICAgIH0KICB9KTsKCiAgcmV0dXJuIHN2Z19lbDsKfQoKZXhwb3J0IGRlZmF1bHQgewogIGNyZWF0ZTogY3JlYXRlLAogIHVwZGF0ZTogdXBkYXRlCn07"},{"version":3,"sources":["/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/src/visualizations/timeline-simple.js"],"names":["d3","require","Color","_","moment","getTitleAttr","getColorFromString","time","create","svg_el","innerHTML","select","attr","set_status","text","timeline","selectAll","remove","append","update","events","event_type","length","clone","reverse","e_first","first","e_last","last","m_first","timestamp","m_last","total_duration","duration","console","log","format","each","e","i","id","color_base","type","color_hover","darken","hex","x","width","eg","rect","style","on","d","j","n","elem","fill","seconds_to_duration","JSON","stringify","data"],"mappings":"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","sourcesContent":["'use strict';\n\nconst d3 = require('d3');\nconst Color = require('color');\nconst _ = require('lodash');\nconst moment = require('moment');\n\nimport { getTitleAttr, getColorFromString } from '../util/color';\n\nconst time = require('../util/time.js');\n\nfunction create(svg_el) {\n  // Clear element\n  svg_el.innerHTML = '';\n\n  // svg for the colored timeline\n  d3.select(svg_el).attr('viewBox', '0 0 100 4').attr('width', '100%');\n}\n\nfunction set_status(svg_el, text) {\n  const timeline = d3.select(svg_el);\n  timeline.selectAll('*').remove();\n\n  timeline\n    .append('text')\n    .attr('x', '0')\n    .attr('y', '3')\n    .text(text)\n    .attr('font-family', 'sans-serif')\n    .attr('font-size', '2')\n    .attr('fill', 'black');\n}\n\nfunction update(svg_el, events, event_type) {\n  const timeline = d3.select(svg_el);\n  timeline.selectAll('*').remove();\n\n  if (events.length <= 0) {\n    set_status(svg_el, 'No data');\n    return;\n  }\n\n  events = _.clone(events);\n  _.reverse(events);\n  const e_first = _.first(events);\n  const e_last = _.last(events);\n  const m_first = moment(e_first.timestamp);\n  const m_last = moment(e_last.timestamp);\n  const total_duration = (m_last - m_first) / 1000 + e_last.duration;\n  console.log('First: ' + m_first.format());\n  console.log('Last: ' + m_last.format());\n  console.log('Duration: ' + total_duration);\n\n  // Iterate over each event and create interval boxes\n  _.each(events, function (e, i) {\n    const id = 'timeline_event_' + i;\n    const timestamp = moment(e.timestamp);\n\n    const color_base = getColorFromString(getTitleAttr({ type: event_type }, e));\n    const color_hover = Color(color_base).darken(0.4).hex();\n\n    const x = (timestamp - m_first) / 1000 / total_duration;\n    const width = (100 * e.duration) / total_duration;\n\n    const eg = timeline\n      .append('g')\n      .attr('id', id)\n      .attr('transform', 'translate(' + 100 * x + ',' + 0 + ')');\n\n    const rect = eg\n      .append('rect')\n      .attr('width', width)\n      .attr('height', 4)\n      .style('fill', color_base)\n      .on('mouseover', function (d, j, n) {\n        const elem = n[j];\n        elem.style.fill = color_hover;\n      })\n      .on('mouseout', function (d, j, n) {\n        const elem = n[j];\n        elem.style.fill = color_base;\n      });\n\n    rect\n      .append('title')\n      .text(\n        timestamp.format() +\n          '\\n' +\n          'Duration: ' +\n          time.seconds_to_duration(e.duration) +\n          '\\n' +\n          JSON.stringify(e.data)\n      );\n\n    if (e.duration > 0.05 * total_duration) {\n      eg.append('text')\n        .attr('font-size', 2)\n        .attr('x', 1)\n        .attr('y', 2.5)\n        .attr('pointer-events', 'none')\n        .text(getTitleAttr({ type: event_type }, e));\n    }\n  });\n\n  return svg_el;\n}\n\nexport default {\n  create: create,\n  update: update,\n};\n"]}]}