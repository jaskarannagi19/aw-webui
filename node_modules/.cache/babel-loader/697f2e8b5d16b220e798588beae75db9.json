{"remainingRequest":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/thread-loader/dist/cjs.js!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/babel-loader/lib/index.js!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/src/views/Stopwatch.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/src/views/Stopwatch.vue","mtime":1622212604097},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC1pbmRleCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmRhdGUudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLnRpbWVycyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9ob21lL2phc2thcmFuL2NvZGUvamFza2FyYW4vYWN0aXZpdHl3YXRjaC9hdy1zZXJ2ZXIvYXctd2VidWkvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgX2dyb3VwQnkgZnJvbSAibG9kYXNoL2dyb3VwQnkiOwppbXBvcnQgX2ZpbHRlciBmcm9tICJsb2Rhc2gvZmlsdGVyIjsKaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnOwppbXBvcnQgU3RvcHdhdGNoRW50cnkgZnJvbSAnLi4vY29tcG9uZW50cy9TdG9wd2F0Y2hFbnRyeS52dWUnOwppbXBvcnQgJ3Z1ZS1hd2Vzb21lL2ljb25zL3BsYXknOwppbXBvcnQgJ3Z1ZS1hd2Vzb21lL2ljb25zL3RyYXNoJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdTdG9wd2F0Y2gnLAogIGNvbXBvbmVudHM6IHsKICAgICdzdG9wd2F0Y2gtZW50cnknOiBTdG9wd2F0Y2hFbnRyeQogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGJ1Y2tldF9pZDogJ2F3LXN0b3B3YXRjaCcsCiAgICAgIGV2ZW50czogW10sCiAgICAgIGxhYmVsOiAnJywKICAgICAgbm93OiBtb21lbnQoKQogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBydW5uaW5nVGltZXJzOiBmdW5jdGlvbiBydW5uaW5nVGltZXJzKCkgewogICAgICByZXR1cm4gX2ZpbHRlcih0aGlzLmV2ZW50cywgZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gZS5kYXRhLnJ1bm5pbmc7CiAgICAgIH0pOwogICAgfSwKICAgIHN0b3BwZWRUaW1lcnM6IGZ1bmN0aW9uIHN0b3BwZWRUaW1lcnMoKSB7CiAgICAgIHJldHVybiBfZmlsdGVyKHRoaXMuZXZlbnRzLCBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiAhZS5kYXRhLnJ1bm5pbmc7CiAgICAgIH0pOwogICAgfSwKICAgIHRpbWVyc0J5RGF0ZTogZnVuY3Rpb24gdGltZXJzQnlEYXRlKCkgewogICAgICByZXR1cm4gX2dyb3VwQnkodGhpcy5zdG9wcGVkVGltZXJzLCBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBtb21lbnQoZS50aW1lc3RhbXApLmZvcm1hdCgnWVlZWS1NTS1ERCcpOwogICAgICB9KTsKICAgIH0KICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIHRoaXMuJGF3LmVuc3VyZUJ1Y2tldCh0aGlzLmJ1Y2tldF9pZCwgJ2dlbmVyYWwuc3RvcHdhdGNoJywgJ3Vua25vd24nKTsKICAgIHRoaXMuZ2V0RXZlbnRzKCk7CiAgICBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBfdGhpcy5ub3cgPSBtb21lbnQoKTsKICAgIH0sIDEwMDApOwogIH0sCiAgbWV0aG9kczogewogICAgc3RhcnRUaW1lcjogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3N0YXJ0VGltZXIgPSBfYXN5bmNUb0dlbmVyYXRvcihyZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKGxhYmVsKSB7CiAgICAgICAgdmFyIGV2ZW50OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGF3Lmluc2VydEV2ZW50KHRoaXMuYnVja2V0X2lkLCB7CiAgICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSwKICAgICAgICAgICAgICAgICAgZGF0YTogewogICAgICAgICAgICAgICAgICAgIHJ1bm5pbmc6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgbGFiZWw6IGxhYmVsCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICBldmVudCA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgICB0aGlzLmV2ZW50cy51bnNoaWZ0KGV2ZW50KTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIHN0YXJ0VGltZXIoX3gpIHsKICAgICAgICByZXR1cm4gX3N0YXJ0VGltZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHN0YXJ0VGltZXI7CiAgICB9KCksCiAgICB1cGRhdGVUaW1lcjogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3VwZGF0ZVRpbWVyID0gX2FzeW5jVG9HZW5lcmF0b3IocmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIobmV3X2V2ZW50KSB7CiAgICAgICAgdmFyIGk7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGkgPSB0aGlzLmV2ZW50cy5maW5kSW5kZXgoZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGUuaWQgPT0gbmV3X2V2ZW50LmlkOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgaWYgKGkgIT0gLTEpIHsKICAgICAgICAgICAgICAgICAgdGhpcy4kc2V0KHRoaXMuZXZlbnRzLCBpLCBuZXdfZXZlbnQpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignOignKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gdXBkYXRlVGltZXIoX3gyKSB7CiAgICAgICAgcmV0dXJuIF91cGRhdGVUaW1lci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gdXBkYXRlVGltZXI7CiAgICB9KCksCiAgICByZW1vdmVUaW1lcjogZnVuY3Rpb24gcmVtb3ZlVGltZXIoZXZlbnQpIHsKICAgICAgdGhpcy5ldmVudHMgPSBfZmlsdGVyKHRoaXMuZXZlbnRzLCBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBlLmlkICE9IGV2ZW50LmlkOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRFdmVudHM6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9nZXRFdmVudHMgPSBfYXN5bmNUb0dlbmVyYXRvcihyZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMygpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGF3LmdldEV2ZW50cyh0aGlzLmJ1Y2tldF9pZCwgewogICAgICAgICAgICAgICAgICBsaW1pdDogMTAwCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgdGhpcy5ldmVudHMgPSBfY29udGV4dDMuc2VudDsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUzLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gZ2V0RXZlbnRzKCkgewogICAgICAgIHJldHVybiBfZ2V0RXZlbnRzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBnZXRFdmVudHM7CiAgICB9KCkKICB9Cn07"},{"version":3,"sources":["Stopwatch.vue"],"names":[],"mappings":"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","sourcesContent":["<template lang=\"pug\">\ndiv\n  h2 Stopwatch\n  p\n    | Using bucket: {{bucket_id}}\n\n  b-alert(show)\n    | This is an early experiment, an important missing feature is the ability to set start/end times manually.\n\n  b-input-group(size=\"lg\")\n    b-input(v-model=\"label\" placeholder=\"What are you working on?\")\n    b-input-group-append\n      b-button(@click=\"startTimer(label)\", variant=\"success\")\n        icon(name=\"play\")\n        | Start\n\n  hr\n\n  div.row\n    div.col-md-12\n      div(v-if=\"runningTimers.length > 0\")\n        h3 Running\n        div(v-for=\"e in runningTimers\" :key=\"e.id\")\n          stopwatch-entry(:event=\"e\", :bucket_id=\"bucket_id\", :now=\"now\",\n            @delete=\"removeTimer\", @update=\"updateTimer\")\n          hr(style=\"margin: 0\")\n      div(v-else)\n        span(style=\"color: #555\") No stopwatch running\n        hr\n\n      div(v-if=\"stoppedTimers.length > 0\")\n        h3.mt-4.mb-4 History\n        div(v-for=\"k in Object.keys(timersByDate).sort().reverse()\")\n          h5.mt-2.mb-1 {{ k }}\n          div(v-for=\"e in timersByDate[k]\" :key=\"e.id\")\n            stopwatch-entry(:event=\"e\", :bucket_id=\"bucket_id\", :now=\"now\",\n              @delete=\"removeTimer\", @update=\"updateTimer\", @new=\"startTimer(e.data.label)\")\n            hr(style=\"margin: 0\")\n      div(v-else)\n        span(style=\"color: #555\") No history to show\n        hr\n</template>\n\n<style scoped lang=\"scss\">\n.btn {\n  margin-right: 0.5em;\n\n  .fa-icon {\n    margin-left: 0;\n    margin-right: 0.5em;\n  }\n}\n</style>\n\n<script>\nimport _ from 'lodash';\nimport moment from 'moment';\n\nimport StopwatchEntry from '../components/StopwatchEntry.vue';\nimport 'vue-awesome/icons/play';\nimport 'vue-awesome/icons/trash';\n\nexport default {\n  name: 'Stopwatch',\n  components: {\n    'stopwatch-entry': StopwatchEntry,\n  },\n  data: () => {\n    return {\n      bucket_id: 'aw-stopwatch',\n      events: [],\n      label: '',\n      now: moment(),\n    };\n  },\n  computed: {\n    runningTimers() {\n      return _.filter(this.events, e => e.data.running);\n    },\n    stoppedTimers() {\n      return _.filter(this.events, e => !e.data.running);\n    },\n    timersByDate() {\n      return _.groupBy(this.stoppedTimers, e => moment(e.timestamp).format('YYYY-MM-DD'));\n    },\n  },\n  mounted: function () {\n    // TODO: List all possible timer buckets\n    //this.getBuckets();\n\n    // Create default timer bucket\n    this.$aw.ensureBucket(this.bucket_id, 'general.stopwatch', 'unknown');\n\n    // TODO: Get all timer events\n    this.getEvents();\n\n    setInterval(() => (this.now = moment()), 1000);\n  },\n  methods: {\n    startTimer: async function (label) {\n      const event = await this.$aw.insertEvent(this.bucket_id, {\n        timestamp: new Date(),\n        data: {\n          running: true,\n          label: label,\n        },\n      });\n      this.events.unshift(event);\n    },\n\n    updateTimer: async function (new_event) {\n      const i = this.events.findIndex(e => e.id == new_event.id);\n      if (i != -1) {\n        // This is needed instead of this.events[i] because insides of arrays\n        // are not reactive in Vue\n        this.$set(this.events, i, new_event);\n      } else {\n        console.error(':(');\n      }\n    },\n\n    removeTimer: function (event) {\n      this.events = _.filter(this.events, e => e.id != event.id);\n    },\n\n    getEvents: async function () {\n      this.events = await this.$aw.getEvents(this.bucket_id, { limit: 100 });\n    },\n  },\n};\n</script>\n"],"sourceRoot":"src/views"}]}