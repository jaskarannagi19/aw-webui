{"remainingRequest":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/src/components/UserSatisfactionPoll.vue?vue&type=style&index=0&id=6e9d9f1c&scoped=true&lang=css&","dependencies":[{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/src/components/UserSatisfactionPoll.vue","mtime":1622830085274},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoucmFkaW8tb3B0aW9ucyB7CiAgZGlzcGxheTogZmxleDsKICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWFyb3VuZDsKfQoKLm9wdGlvbi1ncm91cCB7CiAgdGV4dC1hbGlnbjogY2VudGVyOwp9Cgp1bCB7CiAgbWFyZ2luOiAwOwp9Cg=="},{"version":3,"sources":["UserSatisfactionPoll.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkDA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA","file":"UserSatisfactionPoll.vue","sourceRoot":"src/components","sourcesContent":["<template lang=\"pug\">\n  div\n    b-alert(v-if=\"isPollVisible\", variant=\"info\", show)\n      button(type=\"button\", class=\"close\", @click=\"isPollVisible=false\") &times;\n      form\n        p\n          | Hey there! You've been using ActivityWatch for a while. How likely are you to recommend it to a friend/colleague on a scale 1-10? (with 10 being the most likely)\n        div(class=\"radio-options\")\n          div(v-for=\"i in options\", class=\"option-group\")\n            input(type=\"radio\", :id=\"'option' + i\", name=\"rating\", :value=\"i\", v-model=\"rating\")\n            br\n            label(:for=\"'option' + i\", style=\"display: block\")\n              | {{ i }}\n      div(style=\"display: flex; justify-content: space-between\")\n        a(@click=\"dontShowAgain\" href=\"#\")\n          | Don't show again\n        input(type=\"submit\" value=\"Submit\" @click=\"submit\")\n\n    b-alert(v-if=\"isPosFollowUpVisible\", variant=\"info\" show)\n      button(type=\"button\", class=\"close\", @click=\"isPosFollowUpVisible=false\") &times;\n      | We're really happy to hear you are enjoying ActivityWatch, but we think we can do even better! To help us help you, here are a few things you can do:\n      ul\n        li\n          | Support us on #[a(href=\"https://www.patreon.com/erikbjare\") Patreon] or #[a(href=\"https://opencollective.com/activitywatch\") Open Collective] (or by #[a(href=\"https://activitywatch.net/donate/\") other donation methods]).\n        li\n          | Using ActivityWatch at work? Consider asking your employer to support us!\n        li\n          | Post about it on social media and tell your friends and colleagues! We are on #[a(href=\"https://twitter.com/ActivityWatchIt\") Twitter] and #[a(href=\"https://www.facebook.com/ActivityWatch\") Facebook].\n        //li\n          | Sign up for the newsletter.\n        li\n          | Vote for new features on the #[a(href=\"https://forum.activitywatch.net/c/features\") forum].\n        //li\n          | Fill out the #[a(href=\"https://forms.gle/q2N9K5RoERBV8kqPA\") feedback form].\n        li\n          | Rate us on #[a(href=\"https://alternativeto.net/software/activitywatch/\") AlternativeTo] and #[a(href=\"https://play.google.com/store/apps/details?id=net.activitywatch.android\") Google Play Store].\n        li\n          | Join our #[a(href=\"https://discord.gg/vDskV9q\") Discord server].\n\n    b-alert(v-if=\"isNegFollowUpVisible\", variant=\"info\" show)\n      button(type=\"button\", class=\"close\", @click=\"isNegFollowUpVisible=false\") &times;\n      | We are sorry to hear that you did not like ActivityWatch, but we want to improve! We would be very thankful if you helped us by:\n      ul\n        li\n          | Fill out the #[a(href=\"https://forms.gle/q2N9K5RoERBV8kqPA\") feedback form].\n        li\n          | Vote for new features on the #[a(href=\"https://forum.activitywatch.net/c/features\") forum].\n</template>\n\n<style scoped>\n.radio-options {\n  display: flex;\n  justify-content: space-around;\n}\n\n.option-group {\n  text-align: center;\n}\n\nul {\n  margin: 0;\n}\n</style>\n\n<script>\nimport { range } from 'lodash/fp';\nimport moment from 'moment';\n\nconst NUM_OPTIONS = 10;\n// INITIAL_WAIT_PERIOD is how long to wait from initialTimestamp to the first time that the poll shows up\nconst INITIAL_WAIT_PERIOD = 7 * 24 * 60 * 60;\n// BACKOFF_PERIOD is how many seconds to wait to show the poll again if the user closed it\nconst BACKOFF_PERIOD = 7 * 24 * 60 * 60;\n// The following may be used for testing\n// const INITIAL_WAIT_PERIOD = 1;\n// const BACKOFF_PERIOD = 1;\n\nexport default {\n  name: 'user-satisfaction-poll',\n  data() {\n    return {\n      isPollVisible: false,\n      isPosFollowUpVisible: false,\n      isNegFollowUpVisible: false,\n      // options is an array of [1, ..., NUM_OPTIONS]\n      options: range(1, NUM_OPTIONS + 1),\n      rating: null,\n      data: null,\n    };\n  },\n  mounted() {\n    // Check if initialTimestamp (first time that the user runs the web app) exists\n    let initialTimestamp = moment();\n    if (localStorage.initialTimestamp) {\n      initialTimestamp = moment(localStorage.initialTimestamp);\n    } else {\n      localStorage.initialTimestamp = initialTimestamp;\n    }\n\n    // Get the rest of the data\n    this.retrieveData();\n    if (!this.data) {\n      this.data = {\n        isEnabled: true,\n        nextPollTime: initialTimestamp.add(INITIAL_WAIT_PERIOD, 'seconds'),\n        timesPollIsShown: 0,\n      };\n      this.saveData();\n    }\n\n    if (!this.data.isEnabled) {\n      return;\n    }\n\n    // Show poll if enough time has passed\n    if (moment() >= moment(this.data.nextPollTime)) {\n      this.data.timesPollIsShown = this.data.timesPollIsShown + 1;\n      this.isPollVisible = true;\n      this.data.nextPollTime = moment().add(BACKOFF_PERIOD, 'seconds');\n    }\n\n    // Show the poll a maximum of 3 times\n    if (this.data.timesPollIsShown > 2) {\n      this.data.isEnabled = false;\n    }\n\n    this.saveData();\n  },\n  methods: {\n    retrieveData() {\n      if (localStorage.getItem('userSatisfactionPollData')) {\n        try {\n          this.data = JSON.parse(localStorage.getItem('userSatisfactionPollData'));\n        } catch (err) {\n          console.error('userSatisfactionPollData not found in localStorage: ', err);\n          localStorage.removeItem('userSatisfactionPollData');\n        }\n      }\n    },\n    saveData() {\n      const parsed = JSON.stringify(this.data);\n      localStorage.setItem('userSatisfactionPollData', parsed);\n    },\n    submit() {\n      this.isPollVisible = false;\n      this.data.isEnabled = false;\n      this.saveData();\n      if (parseInt(this.rating) >= 6) {\n        this.isPosFollowUpVisible = true;\n      } else {\n        this.isNegFollowUpVisible = true;\n      }\n    },\n    dontShowAgain() {\n      this.isPollVisible = false;\n      this.data.isEnabled = false;\n      this.saveData();\n    },\n  },\n};\n</script>\n"]}]}