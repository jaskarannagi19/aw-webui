{"remainingRequest":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/src/views/Stopwatch.vue?vue&type=style&index=0&id=0e7ed8b4&scoped=true&lang=scss&","dependencies":[{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/src/views/Stopwatch.vue","mtime":1622830085274},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouYnRuIHsKICBtYXJnaW4tcmlnaHQ6IDAuNWVtOwoKICAuZmEtaWNvbiB7CiAgICBtYXJnaW4tbGVmdDogMDsKICAgIG1hcmdpbi1yaWdodDogMC41ZW07CiAgfQp9Cg=="},{"version":3,"sources":["Stopwatch.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4CA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"Stopwatch.vue","sourceRoot":"src/views","sourcesContent":["<template lang=\"pug\">\ndiv\n  h2 Stopwatch\n  p\n    | Using bucket: {{bucket_id}}\n\n  b-alert(show)\n    | This is an early experiment, an important missing feature is the ability to set start/end times manually.\n\n  b-input-group(size=\"lg\")\n    b-input(v-model=\"label\" placeholder=\"What are you working on?\")\n    b-input-group-append\n      b-button(@click=\"startTimer(label)\", variant=\"success\")\n        icon(name=\"play\")\n        | Start\n\n  hr\n\n  div.row\n    div.col-md-12\n      div(v-if=\"runningTimers.length > 0\")\n        h3 Running\n        div(v-for=\"e in runningTimers\" :key=\"e.id\")\n          stopwatch-entry(:event=\"e\", :bucket_id=\"bucket_id\", :now=\"now\",\n            @delete=\"removeTimer\", @update=\"updateTimer\")\n          hr(style=\"margin: 0\")\n      div(v-else)\n        span(style=\"color: #555\") No stopwatch running\n        hr\n\n      div(v-if=\"stoppedTimers.length > 0\")\n        h3.mt-4.mb-4 History\n        div(v-for=\"k in Object.keys(timersByDate).sort().reverse()\")\n          h5.mt-2.mb-1 {{ k }}\n          div(v-for=\"e in timersByDate[k]\" :key=\"e.id\")\n            stopwatch-entry(:event=\"e\", :bucket_id=\"bucket_id\", :now=\"now\",\n              @delete=\"removeTimer\", @update=\"updateTimer\", @new=\"startTimer(e.data.label)\")\n            hr(style=\"margin: 0\")\n      div(v-else)\n        span(style=\"color: #555\") No history to show\n        hr\n</template>\n\n<style scoped lang=\"scss\">\n.btn {\n  margin-right: 0.5em;\n\n  .fa-icon {\n    margin-left: 0;\n    margin-right: 0.5em;\n  }\n}\n</style>\n\n<script>\nimport _ from 'lodash';\nimport moment from 'moment';\n\nimport StopwatchEntry from '../components/StopwatchEntry.vue';\nimport 'vue-awesome/icons/play';\nimport 'vue-awesome/icons/trash';\n\nexport default {\n  name: 'Stopwatch',\n  components: {\n    'stopwatch-entry': StopwatchEntry,\n  },\n  data: () => {\n    return {\n      bucket_id: 'aw-stopwatch',\n      events: [],\n      label: '',\n      now: moment(),\n    };\n  },\n  computed: {\n    runningTimers() {\n      return _.filter(this.events, e => e.data.running);\n    },\n    stoppedTimers() {\n      return _.filter(this.events, e => !e.data.running);\n    },\n    timersByDate() {\n      return _.groupBy(this.stoppedTimers, e => moment(e.timestamp).format('YYYY-MM-DD'));\n    },\n  },\n  mounted: function () {\n    // TODO: List all possible timer buckets\n    //this.getBuckets();\n\n    // Create default timer bucket\n    this.$aw.ensureBucket(this.bucket_id, 'general.stopwatch', 'unknown');\n\n    // TODO: Get all timer events\n    this.getEvents();\n\n    setInterval(() => (this.now = moment()), 1000);\n  },\n  methods: {\n    startTimer: async function (label) {\n      const event = await this.$aw.insertEvent(this.bucket_id, {\n        timestamp: new Date(),\n        data: {\n          running: true,\n          label: label,\n        },\n      });\n      this.events.unshift(event);\n    },\n\n    updateTimer: async function (new_event) {\n      const i = this.events.findIndex(e => e.id == new_event.id);\n      if (i != -1) {\n        // This is needed instead of this.events[i] because insides of arrays\n        // are not reactive in Vue\n        this.$set(this.events, i, new_event);\n      } else {\n        console.error(':(');\n      }\n    },\n\n    removeTimer: function (event) {\n      this.events = _.filter(this.events, e => e.id != event.id);\n    },\n\n    getEvents: async function () {\n      this.events = await this.$aw.getEvents(this.bucket_id, { limit: 100 });\n    },\n  },\n};\n</script>\n"]}]}