{"remainingRequest":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/src/views/activity/Activity.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/src/views/activity/Activity.vue","mtime":1622212604097},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JzsKaW1wb3J0IHsgZ2V0X2RheV9zdGFydF93aXRoX29mZnNldCwgZ2V0X3RvZGF5IH0gZnJvbSAnfi91dGlsL3RpbWUnOwppbXBvcnQgXyBmcm9tICdsb2Rhc2gnOwoKaW1wb3J0ICd2dWUtYXdlc29tZS9pY29ucy9hcnJvdy1sZWZ0JzsKaW1wb3J0ICd2dWUtYXdlc29tZS9pY29ucy9hcnJvdy1yaWdodCc7CmltcG9ydCAndnVlLWF3ZXNvbWUvaWNvbnMvc3luYyc7CmltcG9ydCAndnVlLWF3ZXNvbWUvaWNvbnMvcGx1cyc7CmltcG9ydCAndnVlLWF3ZXNvbWUvaWNvbnMvZWRpdCc7CmltcG9ydCAndnVlLWF3ZXNvbWUvaWNvbnMvdGltZXMnOwppbXBvcnQgJ3Z1ZS1hd2Vzb21lL2ljb25zL3NhdmUnOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdBY3Rpdml0eScsCiAgcHJvcHM6IHsKICAgIGhvc3Q6IFN0cmluZywKICAgIGRhdGU6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICAvLyBOT1RFOiBUaGlzIGRvZXMgbm90IHdvcmsgYXMgeW91J2QgbWlnaHQgZXhwZWN0IHNpbmNlIHRoZSBkZWZhdWx0IGlzIHNldCBvbgogICAgICAvLyBpbml0aWFsaXphdGlvbiwgd2hpY2ggd291bGQgbGVhZCB0byB0aGUgc2FtZSBkYXRlIGFsd2F5cyBiZWluZyByZXR1cm5lZCwKICAgICAgLy8gZXZlbiBpZiB0aGUgZGF5IGhhcyBjaGFuZ2VkLgogICAgICAvLyBJbnN0ZWFkLCB1c2UgdGhlIGNvbXB1dGVkIF9kYXRlLgogICAgICAvL2RlZmF1bHQ6IGdldF90b2RheSgpLAogICAgfSwKICAgIHBlcmlvZExlbmd0aDogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICdkYXknLAogICAgfSwKICB9LAogIGRhdGE6IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB7CiAgICAgIHRvZGF5OiBnZXRfdG9kYXkoKSwKICAgICAgZmlsdGVyQ2F0ZWdvcnk6IG51bGwsCiAgICAgIGluY2x1ZGVBdWRpYmxlOiB0cnVlLAogICAgICBmaWx0ZXJBRks6IHRydWUsCiAgICAgIG5ld192aWV3OiB7fSwKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgdmlld3M6IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLnZpZXdzLnZpZXdzOwogICAgfSwKICAgIGN1cnJlbnRWaWV3OiBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB0aGlzLnZpZXdzLmZpbmQodiA9PiB2LmlkID09IHRoaXMuJHJvdXRlLnBhcmFtcy52aWV3X2lkKSB8fCB0aGlzLnZpZXdzWzBdOwogICAgfSwKICAgIF9kYXRlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB0aGlzLmRhdGUgfHwgZ2V0X3RvZGF5KCk7CiAgICB9LAogICAgc3VidmlldzogZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdGhpcy4kcm91dGUubWV0YS5zdWJ2aWV3OwogICAgfSwKICAgIGNhdGVnb3JpZXM6IGZ1bmN0aW9uICgpIHsKICAgICAgY29uc3QgY2F0cyA9IHRoaXMuJHN0b3JlLmdldHRlcnNbJ2NhdGVnb3JpZXMvYWxsX2NhdGVnb3JpZXMnXTsKICAgICAgY29uc3QgZW50cmllcyA9IGNhdHMKICAgICAgICAubWFwKGMgPT4gewogICAgICAgICAgcmV0dXJuIHsgdGV4dDogYy5qb2luKCcgPiAnKSwgdmFsdWU6IGMgfTsKICAgICAgICB9KQogICAgICAgIC5zb3J0KChhLCBiKSA9PiBhLnRleHQgPiBiLnRleHQpOwogICAgICByZXR1cm4gWwogICAgICAgIHsgdGV4dDogJ0FsbCcsIHZhbHVlOiBudWxsIH0sCiAgICAgICAgeyB0ZXh0OiAnVW5jYXRlZ29yaXplZCcsIHZhbHVlOiBbJ1VuY2F0ZWdvcml6ZWQnXSB9LAogICAgICBdLmNvbmNhdChlbnRyaWVzKTsKICAgIH0sCiAgICBmaWx0ZXJDYXRlZ29yaWVzOiBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICh0aGlzLmZpbHRlckNhdGVnb3J5KSB7CiAgICAgICAgY29uc3QgY2F0cyA9IHRoaXMuJHN0b3JlLmdldHRlcnNbJ2NhdGVnb3JpZXMvYWxsX2NhdGVnb3JpZXMnXTsKICAgICAgICBjb25zdCBpc0NoaWxkID0gcCA9PiBjID0+IGMubGVuZ3RoID4gcC5sZW5ndGggJiYgXy5pc0VxdWFsKHAsIGMuc2xpY2UoMCwgcC5sZW5ndGgpKTsKICAgICAgICBjb25zdCBjaGlsZHJlbiA9IF8uZmlsdGVyKGNhdHMsIGlzQ2hpbGQodGhpcy5maWx0ZXJDYXRlZ29yeSkpOwogICAgICAgIHJldHVybiBbdGhpcy5maWx0ZXJDYXRlZ29yeV0uY29uY2F0KGNoaWxkcmVuKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgfSwKICAgIGxpbmtfcHJlZml4OiBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBgL2FjdGl2aXR5LyR7dGhpcy5ob3N0fS8ke3RoaXMucGVyaW9kTGVuZ3RofWA7CiAgICB9LAogICAgcGVyaW9kdXNhZ2U6IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnNbJ2FjdGl2aXR5L2dldEFjdGl2ZUhpc3RvcnlBcm91bmRUaW1lcGVyaW9kJ10odGhpcy50aW1lcGVyaW9kKTsKICAgIH0sCiAgICB0aW1lcGVyaW9kOiBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB7IHN0YXJ0OiBnZXRfZGF5X3N0YXJ0X3dpdGhfb2Zmc2V0KHRoaXMuX2RhdGUpLCBsZW5ndGg6IFsxLCB0aGlzLnBlcmlvZExlbmd0aF0gfTsKICAgIH0sCiAgICBkYXRlZm9ybWF0OiBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICh0aGlzLnBlcmlvZExlbmd0aCA9PT0gJ2RheScpIHsKICAgICAgICByZXR1cm4gJ1lZWVktTU0tREQnOwogICAgICB9IGVsc2UgaWYgKHRoaXMucGVyaW9kTGVuZ3RoID09PSAnd2VlaycpIHsKICAgICAgICByZXR1cm4gJ1lZWVlbIFddV1cnOwogICAgICB9IGVsc2UgaWYgKHRoaXMucGVyaW9kTGVuZ3RoID09PSAnbW9udGgnKSB7CiAgICAgICAgcmV0dXJuICdZWVlZLU1NJzsKICAgICAgfSBlbHNlIGlmICh0aGlzLnBlcmlvZExlbmd0aCA9PT0gJ3llYXInKSB7CiAgICAgICAgcmV0dXJuICdZWVlZJzsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gJ1lZWVktTU0tREQnOwogICAgICB9CiAgICB9LAogICAgcGVyaW9kUmVhZGFibGU6IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIG1vbWVudCh0aGlzLnRpbWVwZXJpb2Quc3RhcnQpLmZvcm1hdCh0aGlzLmRhdGVmb3JtYXQpOwogICAgfSwKICAgIHBlcmlvZExlbmd0aE1vbWVudDogZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdGhpcy5wZXJpb2RMZW5ndGhDb252ZXJ0TW9tZW50KHRoaXMucGVyaW9kTGVuZ3RoKTsKICAgIH0sCiAgfSwKICB3YXRjaDogewogICAgaG9zdDogZnVuY3Rpb24gKCkgewogICAgICB0aGlzLnJlZnJlc2goKTsKICAgIH0sCiAgICB0aW1lcGVyaW9kOiBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMucmVmcmVzaCgpOwogICAgfSwKICAgIGZpbHRlckNhdGVnb3J5OiBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMucmVmcmVzaCgpOwogICAgfSwKICAgIGZpbHRlckFGSzogZnVuY3Rpb24gKCkgewogICAgICB0aGlzLnJlZnJlc2goKTsKICAgIH0sCiAgICBpbmNsdWRlQXVkaWJsZTogZnVuY3Rpb24gKCkgewogICAgICB0aGlzLnJlZnJlc2goKTsKICAgIH0sCiAgfSwKCiAgbW91bnRlZDogYXN5bmMgZnVuY3Rpb24gKCkgewogICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3ZpZXdzL2xvYWQnKTsKICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdjYXRlZ29yaWVzL2xvYWQnKTsKICAgIGF3YWl0IHRoaXMucmVmcmVzaCgpOwogIH0sCgogIG1ldGhvZHM6IHsKICAgIHByZXZpb3VzUGVyaW9kOiBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBtb21lbnQodGhpcy5fZGF0ZSkuc3VidHJhY3QoMSwgYCR7dGhpcy5wZXJpb2RMZW5ndGh9c2ApLmZvcm1hdCgnWVlZWS1NTS1ERCcpOwogICAgfSwKICAgIG5leHRQZXJpb2Q6IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIG1vbWVudCh0aGlzLl9kYXRlKS5hZGQoMSwgYCR7dGhpcy5wZXJpb2RMZW5ndGh9c2ApLmZvcm1hdCgnWVlZWS1NTS1ERCcpOwogICAgfSwKICAgIHBlcmlvZExlbmd0aENvbnZlcnRNb21lbnQocGVyaW9kTGVuZ3RoKSB7CiAgICAgIGlmIChwZXJpb2RMZW5ndGggPT09ICdkYXknKSB7CiAgICAgICAgcmV0dXJuICdkYXknOwogICAgICB9IGVsc2UgaWYgKHBlcmlvZExlbmd0aCA9PT0gJ3dlZWsnKSB7CiAgICAgICAgLyogVGhpcyBpcyBuZWNlc3Nhcnkgc28gdGhlIHdlZWsgc3RhcnRzIG9uIE1vbmRheSBpbnN0ZWFkIG9mIFN1bmRheSAqLwogICAgICAgIHJldHVybiAnaXNvV2Vlayc7CiAgICAgIH0gZWxzZSBpZiAocGVyaW9kTGVuZ3RoID09PSAnbW9udGgnKSB7CiAgICAgICAgcmV0dXJuICdtb250aCc7CiAgICAgIH0gZWxzZSBpZiAocGVyaW9kTGVuZ3RoID09PSAneWVhcicpIHsKICAgICAgICByZXR1cm4gJ3llYXInOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ludmFsaWQgcGVyaW9kTGVuZ3RoICR7cGVyaW9kTGVuZ3RofSwgZGVmYXVsdGluZyB0byAiZGF5IicpOwogICAgICAgIHJldHVybiAnZGF5JzsKICAgICAgfQogICAgfSwKCiAgICBzZXREYXRlOiBmdW5jdGlvbiAoZGF0ZSwgcGVyaW9kTGVuZ3RoKSB7CiAgICAgIC8vIHBlcmlvZExlbmd0aCBpcyBhbiBvcHRpb25hbCBhcmd1bWVudCwgZGVmYXVsdCB0byB0aGlzLnBlcmlvZExlbmd0aAogICAgICBpZiAoIXBlcmlvZExlbmd0aCkgewogICAgICAgIHBlcmlvZExlbmd0aCA9IHRoaXMucGVyaW9kTGVuZ3RoOwogICAgICB9CiAgICAgIGNvbnN0IG5ld19wZXJpb2RfbGVuZ3RoX21vbWVudCA9IHRoaXMucGVyaW9kTGVuZ3RoQ29udmVydE1vbWVudChwZXJpb2RMZW5ndGgpOwogICAgICBjb25zdCBuZXdfZGF0ZSA9IG1vbWVudChkYXRlKS5zdGFydE9mKG5ld19wZXJpb2RfbGVuZ3RoX21vbWVudCkuZm9ybWF0KCdZWVlZLU1NLUREJyk7CiAgICAgIGNvbnNvbGUubG9nKG5ld19kYXRlLCBwZXJpb2RMZW5ndGgpOwogICAgICB0aGlzLiRyb3V0ZXIucHVzaChgL2FjdGl2aXR5LyR7dGhpcy5ob3N0fS8ke3BlcmlvZExlbmd0aH0vJHtuZXdfZGF0ZX0vJHt0aGlzLnN1YnZpZXd9YCk7CiAgICB9LAoKICAgIHJlZnJlc2g6IGFzeW5jIGZ1bmN0aW9uIChmb3JjZSkgewogICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnYWN0aXZpdHkvZW5zdXJlX2xvYWRlZCcsIHsKICAgICAgICB0aW1lcGVyaW9kOiB0aGlzLnRpbWVwZXJpb2QsCiAgICAgICAgaG9zdDogdGhpcy5ob3N0LAogICAgICAgIGZvcmNlOiBmb3JjZSwKICAgICAgICBmaWx0ZXJBRks6IHRoaXMuZmlsdGVyQUZLLAogICAgICAgIGluY2x1ZGVBdWRpYmxlOiB0aGlzLmluY2x1ZGVBdWRpYmxlLAogICAgICAgIGZpbHRlckNhdGVnb3JpZXM6IHRoaXMuZmlsdGVyQ2F0ZWdvcmllcywKICAgICAgfSk7CiAgICB9LAoKICAgIGxvYWRfZGVtbzogYXN5bmMgZnVuY3Rpb24gKCkgewogICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnYWN0aXZpdHkvbG9hZF9kZW1vJyk7CiAgICB9LAoKICAgIGNoZWNrRm9ybVZhbGlkaXR5KCkgewogICAgICAvLyBBbGwgY2hlY2tzIG11c3QgYmUgZmFsc2UgZm9yIGNoZWNrIHRvIHBhc3MKICAgICAgY29uc3QgY2hlY2tzID0gewogICAgICAgIC8vIENoZWNrIGlmIHZpZXcgaWQgaXMgdW5pcXVlCiAgICAgICAgJ0lEIGlzIG5vdCB1bmlxdWUnOiB0aGlzLiRzdG9yZS5zdGF0ZS52aWV3cy52aWV3cy5tYXAodiA9PiB2LmlkKS5pbmNsdWRlcyh0aGlzLm5ld192aWV3LmlkKSwKICAgICAgICAnTWlzc2luZyBuYW1lJzogdGhpcy5uZXdfdmlldy5uYW1lID09PSAnJywKICAgICAgfTsKICAgICAgY29uc3QgZXJyb3JzID0gT2JqZWN0LmVudHJpZXMoY2hlY2tzKQogICAgICAgIC5maWx0ZXIoKFtfaywgdl0pID0+IHYpCiAgICAgICAgLm1hcCgoW2ssIF92XSkgPT4gayk7CiAgICAgIGNvbnN0IHZhbGlkID0gZXJyb3JzLmxlbmd0aCA9PSAwOwogICAgICBpZiAoIXZhbGlkKSB7CiAgICAgICAgYWxlcnQoYEludmFsaWQgZm9ybSBpbnB1dDogJHtlcnJvcnN9YCk7CiAgICAgIH0KICAgICAgcmV0dXJuIHZhbGlkOwogICAgfSwKCiAgICBoYW5kbGVPayhldmVudCkgewogICAgICAvLyBQcmV2ZW50IG1vZGFsIGZyb20gY2xvc2luZwogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAvLyBUcmlnZ2VyIHN1Ym1pdCBoYW5kbGVyCiAgICAgIHRoaXMuaGFuZGxlU3VibWl0KCk7CiAgICB9LAoKICAgIGhhbmRsZVN1Ym1pdCgpIHsKICAgICAgLy8gRXhpdCB3aGVuIHRoZSBmb3JtIGlzbid0IHZhbGlkCiAgICAgIGNvbnN0IHZhbGlkID0gdGhpcy5jaGVja0Zvcm1WYWxpZGl0eSgpOwogICAgICBpZiAoIXZhbGlkKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3ZpZXdzL2FkZFZpZXcnLCB7IGlkOiB0aGlzLm5ld192aWV3LmlkLCBuYW1lOiB0aGlzLm5ld192aWV3Lm5hbWUgfSk7CgogICAgICAvLyBIaWRlIHRoZSBtb2RhbCBtYW51YWxseQogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgdGhpcy4kcmVmcy5uZXdfdmlldy5oaWRlKCk7CiAgICAgIH0pOwogICAgfSwKCiAgICByZXNldE1vZGFsKCkgewogICAgICB0aGlzLm5ld192aWV3ID0gewogICAgICAgIGlkOiAnJywKICAgICAgICBuYW1lOiAnJywKICAgICAgfTsKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["Activity.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsHA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Activity.vue","sourceRoot":"src/views/activity","sourcesContent":["<template lang=\"pug\">\ndiv\n  h3.mb-0 Activity for {{ periodReadable }}\n\n  div.mb-2\n    ul.list-group.list-group-horizontal-md.mb-3(style=\"font-size: 0.9em; opacity: 0.7\")\n      li.list-group-item.pl-0.pr-3.py-0(style=\"border: 0\")\n        | #[b Host:] {{ host }}\n      li.list-group-item.pl-0.pr-3.py-0(style=\"border: 0\")\n        | #[b Time active:] {{ $store.state.activity.active.duration | friendlyduration }}\n\n  div.mb-2.d-flex\n    div\n      b-input-group\n        b-input-group-prepend\n          b-button.px-2(:to=\"link_prefix + '/' + previousPeriod() + '/' + subview\",\n                   variant=\"outline-dark\")\n            icon(name=\"arrow-left\")\n        b-select.px-2(:value=\"periodLength\", :options=\"['day', 'week', 'month']\",\n                 @change=\"(periodLength) => setDate(_date, periodLength)\")\n        b-input-group-append\n          b-button.px-2(:to=\"link_prefix + '/' + nextPeriod() + '/' + subview\",\n                   :disabled=\"nextPeriod() > today\", variant=\"outline-dark\")\n            icon(name=\"arrow-right\")\n\n    div.mx-2(v-if=\"periodLength === 'day'\")\n      input.form-control.px-2(id=\"date\" type=\"date\" :value=\"_date\" :max=\"today\"\n                         @change=\"setDate($event.target.value, periodLength)\")\n\n    div.ml-auto\n      b-button-group\n        b-button.px-2(@click=\"refresh(true)\", variant=\"outline-dark\")\n          icon(name=\"sync\")\n          span.d-none.d-md-inline\n            |  Refresh\n\n  aw-periodusage(:periodusage_arr=\"periodusage\", @update=\"setDate\")\n\n  ul.row.nav.nav-tabs.mt-3.px-3\n    li.nav-item(v-for=\"view in views\")\n      router-link.nav-link(:to=\"{ name: 'activity-view', params: {...$route.params, view_id: view.id}}\" :class=\"{'router-link-exact-active': currentView.id == view.id}\")\n        h6 {{view.name}}\n\n    li.nav-item(style=\"margin-left: auto\")\n      a.nav-link(@click=\"$refs.new_view.show()\")\n        h6\n          icon(name=\"plus\")\n          span.d-none.d-md-inline\n            | New view\n\n  b-modal(id=\"new_view\" ref=\"new_view\" title=\"New view\" @show=\"resetModal\" @hidden=\"resetModal\" @ok=\"handleOk\")\n    div.my-1\n      b-input-group.my-1(prepend=\"ID\")\n        b-form-input(v-model=\"new_view.id\")\n      b-input-group.my-1(prepend=\"Name\")\n        b-form-input(v-model=\"new_view.name\")\n\n  div\n    router-view\n\n  div\n    hr\n    h5 Options\n\n    div.row\n      div.col-lg-6\n        b-form-checkbox(v-model=\"filterAFK\")\n          | Filter AFK\n        b-form-checkbox(v-model=\"includeAudible\")\n          | Count audible browser tab as active\n\n      div.col-lg-6\n        b-form-group(label=\"Show/filter category\" label-cols=\"5\" label-cols-lg=\"4\")\n          b-form-select(v-model=\"filterCategory\", :options=\"categories\")\n\n    aw-devonly\n      b-btn(id=\"load-demo\", @click=\"load_demo\")\n        | Load demo data\n</template>\n\n<style lang=\"scss\" scoped>\n$buttoncolor: #ddd;\n$bordercolor: #ddd;\n\n.nav {\n  border-bottom: 2px solid $bordercolor;\n\n  .nav-item {\n    margin-bottom: -2px;\n\n    .nav-link {\n      background-color: $buttoncolor;\n      margin: 0 0.2em 0 0.2em;\n      padding: 0.4em 0.5em 0.1em 0.5em;\n      border: 2px solid $bordercolor;\n      border-bottom: none;\n      border-radius: 0.5rem 0.5rem 0 0;\n      color: #111 !important;\n      cursor: pointer;\n\n      &:hover {\n        background-color: #f8f8f8;\n      }\n\n      &.router-link-exact-active {\n        background-color: #fff;\n        color: #333 !important;\n\n        &:hover {\n          background-color: #fff;\n        }\n      }\n    }\n  }\n}\n</style>\n\n<script>\nimport moment from 'moment';\nimport { get_day_start_with_offset, get_today } from '~/util/time';\nimport _ from 'lodash';\n\nimport 'vue-awesome/icons/arrow-left';\nimport 'vue-awesome/icons/arrow-right';\nimport 'vue-awesome/icons/sync';\nimport 'vue-awesome/icons/plus';\nimport 'vue-awesome/icons/edit';\nimport 'vue-awesome/icons/times';\nimport 'vue-awesome/icons/save';\n\nexport default {\n  name: 'Activity',\n  props: {\n    host: String,\n    date: {\n      type: String,\n      // NOTE: This does not work as you'd might expect since the default is set on\n      // initialization, which would lead to the same date always being returned,\n      // even if the day has changed.\n      // Instead, use the computed _date.\n      //default: get_today(),\n    },\n    periodLength: {\n      type: String,\n      default: 'day',\n    },\n  },\n  data: function () {\n    return {\n      today: get_today(),\n      filterCategory: null,\n      includeAudible: true,\n      filterAFK: true,\n      new_view: {},\n    };\n  },\n  computed: {\n    views: function () {\n      return this.$store.state.views.views;\n    },\n    currentView: function () {\n      return this.views.find(v => v.id == this.$route.params.view_id) || this.views[0];\n    },\n    _date: function () {\n      return this.date || get_today();\n    },\n    subview: function () {\n      return this.$route.meta.subview;\n    },\n    categories: function () {\n      const cats = this.$store.getters['categories/all_categories'];\n      const entries = cats\n        .map(c => {\n          return { text: c.join(' > '), value: c };\n        })\n        .sort((a, b) => a.text > b.text);\n      return [\n        { text: 'All', value: null },\n        { text: 'Uncategorized', value: ['Uncategorized'] },\n      ].concat(entries);\n    },\n    filterCategories: function () {\n      if (this.filterCategory) {\n        const cats = this.$store.getters['categories/all_categories'];\n        const isChild = p => c => c.length > p.length && _.isEqual(p, c.slice(0, p.length));\n        const children = _.filter(cats, isChild(this.filterCategory));\n        return [this.filterCategory].concat(children);\n      } else {\n        return null;\n      }\n    },\n    link_prefix: function () {\n      return `/activity/${this.host}/${this.periodLength}`;\n    },\n    periodusage: function () {\n      return this.$store.getters['activity/getActiveHistoryAroundTimeperiod'](this.timeperiod);\n    },\n    timeperiod: function () {\n      return { start: get_day_start_with_offset(this._date), length: [1, this.periodLength] };\n    },\n    dateformat: function () {\n      if (this.periodLength === 'day') {\n        return 'YYYY-MM-DD';\n      } else if (this.periodLength === 'week') {\n        return 'YYYY[ W]WW';\n      } else if (this.periodLength === 'month') {\n        return 'YYYY-MM';\n      } else if (this.periodLength === 'year') {\n        return 'YYYY';\n      } else {\n        return 'YYYY-MM-DD';\n      }\n    },\n    periodReadable: function () {\n      return moment(this.timeperiod.start).format(this.dateformat);\n    },\n    periodLengthMoment: function () {\n      return this.periodLengthConvertMoment(this.periodLength);\n    },\n  },\n  watch: {\n    host: function () {\n      this.refresh();\n    },\n    timeperiod: function () {\n      this.refresh();\n    },\n    filterCategory: function () {\n      this.refresh();\n    },\n    filterAFK: function () {\n      this.refresh();\n    },\n    includeAudible: function () {\n      this.refresh();\n    },\n  },\n\n  mounted: async function () {\n    this.$store.dispatch('views/load');\n    this.$store.dispatch('categories/load');\n    await this.refresh();\n  },\n\n  methods: {\n    previousPeriod: function () {\n      return moment(this._date).subtract(1, `${this.periodLength}s`).format('YYYY-MM-DD');\n    },\n    nextPeriod: function () {\n      return moment(this._date).add(1, `${this.periodLength}s`).format('YYYY-MM-DD');\n    },\n    periodLengthConvertMoment(periodLength) {\n      if (periodLength === 'day') {\n        return 'day';\n      } else if (periodLength === 'week') {\n        /* This is necessary so the week starts on Monday instead of Sunday */\n        return 'isoWeek';\n      } else if (periodLength === 'month') {\n        return 'month';\n      } else if (periodLength === 'year') {\n        return 'year';\n      } else {\n        console.error('Invalid periodLength ${periodLength}, defaulting to \"day\"');\n        return 'day';\n      }\n    },\n\n    setDate: function (date, periodLength) {\n      // periodLength is an optional argument, default to this.periodLength\n      if (!periodLength) {\n        periodLength = this.periodLength;\n      }\n      const new_period_length_moment = this.periodLengthConvertMoment(periodLength);\n      const new_date = moment(date).startOf(new_period_length_moment).format('YYYY-MM-DD');\n      console.log(new_date, periodLength);\n      this.$router.push(`/activity/${this.host}/${periodLength}/${new_date}/${this.subview}`);\n    },\n\n    refresh: async function (force) {\n      await this.$store.dispatch('activity/ensure_loaded', {\n        timeperiod: this.timeperiod,\n        host: this.host,\n        force: force,\n        filterAFK: this.filterAFK,\n        includeAudible: this.includeAudible,\n        filterCategories: this.filterCategories,\n      });\n    },\n\n    load_demo: async function () {\n      await this.$store.dispatch('activity/load_demo');\n    },\n\n    checkFormValidity() {\n      // All checks must be false for check to pass\n      const checks = {\n        // Check if view id is unique\n        'ID is not unique': this.$store.state.views.views.map(v => v.id).includes(this.new_view.id),\n        'Missing name': this.new_view.name === '',\n      };\n      const errors = Object.entries(checks)\n        .filter(([_k, v]) => v)\n        .map(([k, _v]) => k);\n      const valid = errors.length == 0;\n      if (!valid) {\n        alert(`Invalid form input: ${errors}`);\n      }\n      return valid;\n    },\n\n    handleOk(event) {\n      // Prevent modal from closing\n      event.preventDefault();\n      // Trigger submit handler\n      this.handleSubmit();\n    },\n\n    handleSubmit() {\n      // Exit when the form isn't valid\n      const valid = this.checkFormValidity();\n      if (!valid) {\n        return;\n      }\n\n      this.$store.commit('views/addView', { id: this.new_view.id, name: this.new_view.name });\n\n      // Hide the modal manually\n      this.$nextTick(() => {\n        this.$refs.new_view.hide();\n      });\n    },\n\n    resetModal() {\n      this.new_view = {\n        id: '',\n        name: '',\n      };\n    },\n  },\n};\n</script>\n"]}]}