{"remainingRequest":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/src/components/CategoryEditTree.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/src/components/CategoryEditTree.vue","mtime":1622212604093},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server/aw-webui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCAndnVlLWF3ZXNvbWUvaWNvbnMvcmVndWxhci9wbHVzLXNxdWFyZSc7CmltcG9ydCAndnVlLWF3ZXNvbWUvaWNvbnMvcmVndWxhci9taW51cy1zcXVhcmUnOwppbXBvcnQgJ3Z1ZS1hd2Vzb21lL2ljb25zL2NpcmNsZSc7CmltcG9ydCAndnVlLWF3ZXNvbWUvaWNvbnMvY2FyZXQtcmlnaHQnOwppbXBvcnQgJ3Z1ZS1hd2Vzb21lL2ljb25zL3RyYXNoJzsKaW1wb3J0ICd2dWUtYXdlc29tZS9pY29ucy9wbHVzJzsKaW1wb3J0ICd2dWUtYXdlc29tZS9pY29ucy9lZGl0JzsKCmltcG9ydCBDb2xvclBpY2tlciBmcm9tICd+L2NvbXBvbmVudHMvQ29sb3JQaWNrZXInOwoKaW1wb3J0IF8gZnJvbSAnbG9kYXNoJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQ2F0ZWdvcnlFZGl0VHJlZScsCiAgY29tcG9uZW50czogewogICAgJ2NvbG9yLXBpY2tlcic6IENvbG9yUGlja2VyLAogIH0sCiAgcHJvcHM6IHsKICAgIF9jbGFzczogT2JqZWN0LAogICAgZGVwdGg6IHsKICAgICAgdHlwZTogTnVtYmVyLAogICAgICBkZWZhdWx0OiAwLAogICAgfSwKICB9LAogIGRhdGE6IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB7CiAgICAgIGV4cGFuZGVkOiB0aGlzLmRlcHRoIDwgMSwKICAgICAgY29sb3JfZm9jdXNlZDogZmFsc2UsCiAgICAgIGVkaXRpbmc6IHsKICAgICAgICBpZDogMCwgLy8gRklYTUU6IFVzZSBJRCBhc3NpZ25lZCB0byBjYXRlZ29yeSBpbiB2dWV4IHN0b3JlLCBpbiBvcmRlciBmb3Igc2F2ZXMgdG8gYmUgdW5pcXVlbHkgdGFyZ2V0ZWQKICAgICAgICBuYW1lOiBudWxsLAogICAgICAgIHJ1bGU6IHt9LAogICAgICAgIHBhcmVudDogW10sCiAgICAgICAgaW5oZXJpdF9jb2xvcjogdHJ1ZSwKICAgICAgICBjb2xvcjogbnVsbCwKICAgICAgfSwKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgYWxsQ2F0ZWdvcmllczogZnVuY3Rpb24gKCkgewogICAgICBjb25zdCBjYXRlZ29yaWVzID0gdGhpcy4kc3RvcmUuZ2V0dGVyc1snY2F0ZWdvcmllcy9hbGxfY2F0ZWdvcmllcyddOwogICAgICBjb25zdCBlbnRyaWVzID0gY2F0ZWdvcmllcy5tYXAoYyA9PiB7CiAgICAgICAgcmV0dXJuIHsgdGV4dDogYy5qb2luKCctPicpLCB2YWx1ZTogYyB9OwogICAgICB9KTsKICAgICAgcmV0dXJuIFt7IHZhbHVlOiBbXSwgdGV4dDogJ05vbmUnIH1dLmNvbmNhdChlbnRyaWVzKTsKICAgIH0sCiAgICBhbGxSdWxlVHlwZXM6IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIFsKICAgICAgICB7IHZhbHVlOiBudWxsLCB0ZXh0OiAnTm9uZScgfSwKICAgICAgICB7IHZhbHVlOiAncmVnZXgnLCB0ZXh0OiAnUmVndWxhciBFeHByZXNzaW9uJyB9LAogICAgICAgIC8veyB2YWx1ZTogJ2dsb2InLCB0ZXh0OiAnR2xvYiBwYXR0ZXJuJyB9LAogICAgICBdOwogICAgfSwKICAgIHRvdGFsQ2hpbGRyZW46IGZ1bmN0aW9uICgpIHsKICAgICAgZnVuY3Rpb24gY291bnRDaGlsZHJlbihub2RlKSB7CiAgICAgICAgcmV0dXJuIG5vZGUuY2hpbGRyZW4ubGVuZ3RoICsgXy5zdW0oXy5tYXAobm9kZS5jaGlsZHJlbiwgY291bnRDaGlsZHJlbikpOwogICAgICB9CiAgICAgIHJldHVybiBjb3VudENoaWxkcmVuKHRoaXMuX2NsYXNzKTsKICAgIH0sCiAgfSwKICBtZXRob2RzOiB7CiAgICBhZGRTdWJjbGFzczogZnVuY3Rpb24gKHBhcmVudCkgewogICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2NhdGVnb3JpZXMvYWRkQ2xhc3MnLCB7CiAgICAgICAgbmFtZTogcGFyZW50Lm5hbWUuY29uY2F0KFsnTmV3IGNsYXNzJ10pLAogICAgICAgIHJ1bGU6IHsgdHlwZTogJ3JlZ2V4JywgcmVnZXg6ICdGSUxMIE1FJyB9LAogICAgICB9KTsKICAgIH0sCiAgICByZW1vdmVDbGFzczogZnVuY3Rpb24gKF9jbGFzcykgewogICAgICAvLyBUT0RPOiBTaG93IGEgY29uZmlybWF0aW9uIGRpYWxvZwogICAgICAvLyBUT0RPOiBSZW1vdmUgY2hpbGRyZW4gYXMgd2VsbD8KICAgICAgLy8gVE9ETzogTW92ZSBidXR0b24gdG8gZWRpdCBtb2RhbD8KICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdjYXRlZ29yaWVzL3JlbW92ZUNsYXNzJywgX2NsYXNzKTsKICAgIH0sCiAgICBzaG93RWRpdE1vZGFsKCkgewogICAgICB0aGlzLiRyZWZzLmVkaXQuc2hvdygpOwogICAgfSwKICAgIGNoZWNrRm9ybVZhbGlkaXR5KCkgewogICAgICAvLyBGSVhNRQogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0sCiAgICBoYW5kbGVPayhldmVudCkgewogICAgICAvLyBQcmV2ZW50IG1vZGFsIGZyb20gY2xvc2luZwogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAvLyBUcmlnZ2VyIHN1Ym1pdCBoYW5kbGVyCiAgICAgIHRoaXMuaGFuZGxlU3VibWl0KCk7CiAgICB9LAogICAgaGFuZGxlU3VibWl0KCkgewogICAgICAvLyBFeGl0IHdoZW4gdGhlIGZvcm0gaXNuJ3QgdmFsaWQKICAgICAgaWYgKCF0aGlzLmNoZWNrRm9ybVZhbGlkaXR5KCkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIC8vIFNhdmUgdGhlIGNhdGVnb3J5CiAgICAgIGNvbnN0IG5ld19jbGFzcyA9IHsKICAgICAgICBpZDogdGhpcy5lZGl0aW5nLmlkLAogICAgICAgIG5hbWU6IHRoaXMuZWRpdGluZy5wYXJlbnQuY29uY2F0KHRoaXMuZWRpdGluZy5uYW1lKSwKICAgICAgICBydWxlOiB0aGlzLmVkaXRpbmcucnVsZS50eXBlICE9PSBudWxsID8gdGhpcy5lZGl0aW5nLnJ1bGUgOiB7IHR5cGU6IG51bGwgfSwKICAgICAgICBkYXRhOiB7IGNvbG9yOiB0aGlzLmVkaXRpbmcuaW5oZXJpdF9jb2xvciA9PT0gdHJ1ZSA/IHVuZGVmaW5lZCA6IHRoaXMuZWRpdGluZy5jb2xvciB9LAogICAgICB9OwogICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2NhdGVnb3JpZXMvdXBkYXRlQ2xhc3MnLCBuZXdfY2xhc3MpOwoKICAgICAgLy8gSGlkZSB0aGUgbW9kYWwgbWFudWFsbHkKICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgIHRoaXMuJHJlZnMuZWRpdC5oaWRlKCk7CiAgICAgIH0pOwogICAgfSwKICAgIHJlc2V0TW9kYWwoKSB7CiAgICAgIGNvbnN0IGNvbG9yID0gdGhpcy5fY2xhc3MuZGF0YSA/IHRoaXMuX2NsYXNzLmRhdGEuY29sb3IgOiB1bmRlZmluZWQ7CiAgICAgIGNvbnN0IGluaGVyaXRfY29sb3IgPSAhY29sb3I7CiAgICAgIHRoaXMuZWRpdGluZyA9IHsKICAgICAgICBpZDogdGhpcy5fY2xhc3MuaWQsCiAgICAgICAgbmFtZTogdGhpcy5fY2xhc3Muc3VibmFtZSwKICAgICAgICBydWxlOiBfLmNsb25lRGVlcCh0aGlzLl9jbGFzcy5ydWxlKSwKICAgICAgICBjb2xvciwKICAgICAgICBpbmhlcml0X2NvbG9yLAogICAgICAgIHBhcmVudDogdGhpcy5fY2xhc3MucGFyZW50ID8gdGhpcy5fY2xhc3MucGFyZW50IDogW10sCiAgICAgIH07CiAgICAgIC8vY29uc29sZS5sb2codGhpcy5lZGl0aW5nKTsKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["CategoryEditTree.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CategoryEditTree.vue","sourceRoot":"src/components","sourcesContent":["<template lang=\"pug\">\ndiv\n  div.row.py-2.class\n    div.col-8.col-md-4\n      span(:style=\"{ marginLeft: (1.5 * depth) + 'em', cursor: _class.children.length > 0 ? 'pointer' : null}\" @click=\"expanded = !expanded\")\n        span(v-if=\"_class.children.length > 0\" style=\"opacity: 0.8\")\n          icon(:name=\"expanded ? 'regular/minus-square' : 'regular/plus-square'\" scale=\"0.8\")\n        span(v-else style=\"opacity: 0.6\")\n          icon(name=\"circle\" scale=\"0.4\" style=\"margin-left: 1em; margin-right: 1.22em;\")\n        | {{ _class.name.slice(depth).join(\" âž¤ \")}}\n        icon.ml-1(v-if=\"_class.data && _class.data.color\" name=\"circle\" :style=\"'color: ' + _class.data.color\")\n        span.ml-1(v-if=\"_class.children.length > 0\" style=\"opacity: 0.5\") ({{totalChildren}})\n\n    div.col-4.col-md-8\n      span.d-none.d-md-inline\n        span(v-if=\"_class.rule.type === 'regex'\") Rule ({{_class.rule.type}}): #[code {{_class.rule.regex}}]\n        span(v-else, style=\"color: #888\") No rule\n      span.float-right\n        b-btn.ml-1(size=\"sm\", variant=\"outline-secondary\", @click=\"showEditModal()\" style=\"border: 0;\" pill)\n          icon(name=\"edit\")\n        b-btn.ml-1(size=\"sm\", variant=\"outline-success\", @click=\"addSubclass(_class); expanded = true\" style=\"border: 0;\" pill)\n          icon(name=\"plus\")\n  div\n    div.pa-2(v-for=\"child in _class.children\", style=\"background: rgba(0, 0, 0, 0);\", v-show=\"expanded\")\n      CategoryEditTree(:_class=\"child\", :depth=\"depth+1\")\n\n  b-modal(id=\"edit\" ref=\"edit\" title=\"Edit category\" @show=\"resetModal\" @hidden=\"resetModal\" @ok=\"handleOk\")\n    div.my-1\n      b-input-group.my-1(prepend=\"Name\")\n        b-form-input(v-model=\"editing.name\")\n      b-input-group(prepend=\"Parent\")\n        b-select(v-model=\"editing.parent\", :options=\"allCategories\")\n\n    hr\n\n    div.my-1\n      b Rule\n      b-input-group.my-1(prepend=\"Type\")\n        b-select(v-model=\"editing.rule.type\", :options=\"allRuleTypes\")\n      div(v-if=\"editing.rule.type === 'regex'\")\n        b-input-group.my-1(prepend=\"Pattern\")\n          b-form-input(v-model=\"editing.rule.regex\")\n        b-form-checkbox(v-model=\"editing.rule.ignore_case\" switch)\n          | Ignore case\n\n    hr\n\n    div.my-1\n      b Color\n\n      b-form-checkbox(v-model=\"editing.inherit_color\" switch)\n        | Inherit parent color\n      div.mt-1(v-show=\"!editing.inherit_color\")\n        color-picker(v-model=\"editing.color\")\n\n    //\n      div.my-1\n        b Productivity score\n        b-input-group.my-1(prepend=\"Points\")\n          b-form-input(v-model=\"editing.productivity\")\n\n    hr\n\n    div.my-1\n      b-btn(variant=\"danger\", @click=\"removeClass(_class); $refs.edit.hide()\")\n        icon(name=\"trash\")\n        | Remove category\n</template>\n\n<script>\nimport 'vue-awesome/icons/regular/plus-square';\nimport 'vue-awesome/icons/regular/minus-square';\nimport 'vue-awesome/icons/circle';\nimport 'vue-awesome/icons/caret-right';\nimport 'vue-awesome/icons/trash';\nimport 'vue-awesome/icons/plus';\nimport 'vue-awesome/icons/edit';\n\nimport ColorPicker from '~/components/ColorPicker';\n\nimport _ from 'lodash';\n\nexport default {\n  name: 'CategoryEditTree',\n  components: {\n    'color-picker': ColorPicker,\n  },\n  props: {\n    _class: Object,\n    depth: {\n      type: Number,\n      default: 0,\n    },\n  },\n  data: function () {\n    return {\n      expanded: this.depth < 1,\n      color_focused: false,\n      editing: {\n        id: 0, // FIXME: Use ID assigned to category in vuex store, in order for saves to be uniquely targeted\n        name: null,\n        rule: {},\n        parent: [],\n        inherit_color: true,\n        color: null,\n      },\n    };\n  },\n  computed: {\n    allCategories: function () {\n      const categories = this.$store.getters['categories/all_categories'];\n      const entries = categories.map(c => {\n        return { text: c.join('->'), value: c };\n      });\n      return [{ value: [], text: 'None' }].concat(entries);\n    },\n    allRuleTypes: function () {\n      return [\n        { value: null, text: 'None' },\n        { value: 'regex', text: 'Regular Expression' },\n        //{ value: 'glob', text: 'Glob pattern' },\n      ];\n    },\n    totalChildren: function () {\n      function countChildren(node) {\n        return node.children.length + _.sum(_.map(node.children, countChildren));\n      }\n      return countChildren(this._class);\n    },\n  },\n  methods: {\n    addSubclass: function (parent) {\n      this.$store.commit('categories/addClass', {\n        name: parent.name.concat(['New class']),\n        rule: { type: 'regex', regex: 'FILL ME' },\n      });\n    },\n    removeClass: function (_class) {\n      // TODO: Show a confirmation dialog\n      // TODO: Remove children as well?\n      // TODO: Move button to edit modal?\n      this.$store.commit('categories/removeClass', _class);\n    },\n    showEditModal() {\n      this.$refs.edit.show();\n    },\n    checkFormValidity() {\n      // FIXME\n      return true;\n    },\n    handleOk(event) {\n      // Prevent modal from closing\n      event.preventDefault();\n      // Trigger submit handler\n      this.handleSubmit();\n    },\n    handleSubmit() {\n      // Exit when the form isn't valid\n      if (!this.checkFormValidity()) {\n        return;\n      }\n\n      // Save the category\n      const new_class = {\n        id: this.editing.id,\n        name: this.editing.parent.concat(this.editing.name),\n        rule: this.editing.rule.type !== null ? this.editing.rule : { type: null },\n        data: { color: this.editing.inherit_color === true ? undefined : this.editing.color },\n      };\n      this.$store.commit('categories/updateClass', new_class);\n\n      // Hide the modal manually\n      this.$nextTick(() => {\n        this.$refs.edit.hide();\n      });\n    },\n    resetModal() {\n      const color = this._class.data ? this._class.data.color : undefined;\n      const inherit_color = !color;\n      this.editing = {\n        id: this._class.id,\n        name: this._class.subname,\n        rule: _.cloneDeep(this._class.rule),\n        color,\n        inherit_color,\n        parent: this._class.parent ? this._class.parent : [],\n      };\n      //console.log(this.editing);\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.row.class:hover {\n  background-color: #eee;\n  boder-radius: 5px;\n}\n</style>\n"]}]}