{"remainingRequest":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/src/components/EventEditor.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/src/components/EventEditor.vue","mtime":1622830085270},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jaskaran/code/jaskaran/activitywatch/aw-server-rust/aw-webui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JzsKCmltcG9ydCAndnVlLWF3ZXNvbWUvaWNvbnMvdGltZXMnOwppbXBvcnQgJ3Z1ZS1hd2Vzb21lL2ljb25zL3NhdmUnOwppbXBvcnQgJ3Z1ZS1hd2Vzb21lL2ljb25zL3RyYXNoJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnRXZlbnRFZGl0b3InLAogIHByb3BzOiB7CiAgICBldmVudDogT2JqZWN0LAogICAgYnVja2V0X2lkOiBTdHJpbmcsCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZWRpdGVkRXZlbnQ6IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5ldmVudCkpLAogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBzdGFydDogewogICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gbW9tZW50KHRoaXMuZWRpdGVkRXZlbnQudGltZXN0YW1wKS5mb3JtYXQoKTsKICAgICAgfSwKICAgICAgc2V0OiBmdW5jdGlvbiAoZHQpIHsKICAgICAgICAvLyBEdXJhdGlvbiBuZWVkcyB0byBiZSBzZXQgZmlyc3Qgc2luY2Ugb3RoZXJ3aXNlIHRoZSBjb21wdXRlZCBmb3IgZW5kIHdpbGwgdXNlIHRoZSBuZXcgdGltZXN0YW1wCiAgICAgICAgdGhpcy5lZGl0ZWRFdmVudC5kdXJhdGlvbiA9IG1vbWVudCh0aGlzLmVuZCkuZGlmZihkdCwgJ3NlY29uZHMnKTsKICAgICAgICB0aGlzLmVkaXRlZEV2ZW50LnRpbWVzdGFtcCA9IG5ldyBEYXRlKGR0KTsKICAgICAgfSwKICAgIH0sCiAgICBlbmQ6IHsKICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgY29uc3QgZW5kID0gbW9tZW50KHRoaXMuZWRpdGVkRXZlbnQudGltZXN0YW1wKS5hZGQodGhpcy5lZGl0ZWRFdmVudC5kdXJhdGlvbiwgJ3NlY29uZHMnKTsKICAgICAgICByZXR1cm4gZW5kLmZvcm1hdCgpOwogICAgICB9LAogICAgICBzZXQ6IGZ1bmN0aW9uIChkdCkgewogICAgICAgIHRoaXMuZWRpdGVkRXZlbnQuZHVyYXRpb24gPSBtb21lbnQoZHQpLmRpZmYodGhpcy5lZGl0ZWRFdmVudC50aW1lc3RhbXAsICdzZWNvbmRzJyk7CiAgICAgIH0sCiAgICB9LAogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgc2F2ZSgpIHsKICAgICAgLy8gVGhpcyBlbWl0IG5lZWRzIHRvIGJlIGNhbGxlZCBmaXJzdCwgb3RoZXJ3aXNlIGl0IHdvbid0IG9jY3VyIGZvciBzb21lIHJlYXNvbgogICAgICB0aGlzLiRlbWl0KCdzYXZlJywgdGhpcy5lZGl0ZWRFdmVudCk7CiAgICAgIGF3YWl0IHRoaXMuJGF3LnJlcGxhY2VFdmVudCh0aGlzLmJ1Y2tldF9pZCwgdGhpcy5lZGl0ZWRFdmVudCk7CiAgICB9LAogICAgYXN5bmMgZGVsZXRlXygpIHsKICAgICAgLy8gVGhpcyBlbWl0IG5lZWRzIHRvIGJlIGNhbGxlZCBmaXJzdCwgb3RoZXJ3aXNlIGl0IHdvbid0IG9jY3VyIGZvciBzb21lIHJlYXNvbgogICAgICB0aGlzLiRlbWl0KCdkZWxldGUnLCB0aGlzLmV2ZW50KTsKICAgICAgYXdhaXQgdGhpcy4kYXcuZGVsZXRlRXZlbnQodGhpcy5idWNrZXRfaWQsIHRoaXMuZXZlbnQuaWQpOwogICAgfSwKICAgIGNsb3NlKCkgewogICAgICB0aGlzLiRyZWZzLmV2ZW50RWRpdE1vZGFsLmhpZGUoKTsKICAgICAgdGhpcy4kZW1pdCgnY2xvc2UnLCB0aGlzLmV2ZW50KTsKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["EventEditor.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkDA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"EventEditor.vue","sourceRoot":"src/components","sourcesContent":["<template lang=\"pug\">\nb-modal(:id=\"'edit-modal-' + event.id\", ref=\"eventEditModal\", title=\"Edit event\", centered, hide-footer)\n  table(style=\"width: 100%\")\n    tr\n      th Bucket\n      td {{ bucket_id }}\n    tr\n      th ID\n      td {{ event.id }}\n    tr\n      th Start\n      datetime(type=\"datetime\" v-model=\"start\")\n    tr\n      th End\n      datetime(type=\"datetime\" v-model=\"end\")\n    tr\n      th Duration\n      td {{ editedEvent.duration | friendlyduration }}\n\n  hr\n\n  table(style=\"width: 100%\")\n    tr\n      th Key\n      th Value\n    tr(v-for=\"(v, k) in event.data\")\n      td\n        b-input(disabled, :value=\"k\", size=\"sm\")\n      td\n        b-checkbox(v-if=\"typeof event.data[k] === typeof true\", v-model=\"editedEvent.data[k]\", style=\"margin: 0.25em\")\n        b-input(v-if=\"typeof event.data[k] === typeof 'string'\", v-model=\"editedEvent.data[k]\", size=\"sm\")\n\n  hr\n\n  div.float-left\n    b-button.mx-1(@click=\"delete_(); close();\" variant=\"danger\")\n      icon.mx-1(name=\"trash\")\n      | Delete\n  div.float-right\n    b-button.mx-1(@click=\"close\")\n      icon.mx-1(name=\"times\")\n      | Cancel\n    b-button.mx-1(@click=\"save(); close();\", variant=\"primary\")\n      icon.mx-1(name=\"save\")\n      | Save\n</template>\n\n<style lang=\"scss\"></style>\n\n<script>\nimport moment from 'moment';\n\nimport 'vue-awesome/icons/times';\nimport 'vue-awesome/icons/save';\nimport 'vue-awesome/icons/trash';\n\nexport default {\n  name: 'EventEditor',\n  props: {\n    event: Object,\n    bucket_id: String,\n  },\n  data() {\n    return {\n      editedEvent: JSON.parse(JSON.stringify(this.event)),\n    };\n  },\n  computed: {\n    start: {\n      get: function () {\n        return moment(this.editedEvent.timestamp).format();\n      },\n      set: function (dt) {\n        // Duration needs to be set first since otherwise the computed for end will use the new timestamp\n        this.editedEvent.duration = moment(this.end).diff(dt, 'seconds');\n        this.editedEvent.timestamp = new Date(dt);\n      },\n    },\n    end: {\n      get: function () {\n        const end = moment(this.editedEvent.timestamp).add(this.editedEvent.duration, 'seconds');\n        return end.format();\n      },\n      set: function (dt) {\n        this.editedEvent.duration = moment(dt).diff(this.editedEvent.timestamp, 'seconds');\n      },\n    },\n  },\n  methods: {\n    async save() {\n      // This emit needs to be called first, otherwise it won't occur for some reason\n      this.$emit('save', this.editedEvent);\n      await this.$aw.replaceEvent(this.bucket_id, this.editedEvent);\n    },\n    async delete_() {\n      // This emit needs to be called first, otherwise it won't occur for some reason\n      this.$emit('delete', this.event);\n      await this.$aw.deleteEvent(this.bucket_id, this.event.id);\n    },\n    close() {\n      this.$refs.eventEditModal.hide();\n      this.$emit('close', this.event);\n    },\n  },\n};\n</script>\n"]}]}